{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.runCLI = void 0;\n\nfunction _console() {\n  const data = require('@jest/console');\n\n  _console = function _console() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestUtil() {\n  const data = require('jest-util');\n\n  _jestUtil = function _jestUtil() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestConfig() {\n  const data = require('jest-config');\n\n  _jestConfig = function _jestConfig() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestRuntime() {\n  const data = _interopRequireDefault(require('jest-runtime'));\n\n  _jestRuntime = function _jestRuntime() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _chalk() {\n  const data = _interopRequireDefault(require('chalk'));\n\n  _chalk = function _chalk() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _rimraf() {\n  const data = _interopRequireDefault(require('rimraf'));\n\n  _rimraf = function _rimraf() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _exit() {\n  const data = _interopRequireDefault(require('exit'));\n\n  _exit = function _exit() {\n    return data;\n  };\n\n  return data;\n}\n\nvar _create_context = _interopRequireDefault(require('../lib/create_context'));\n\nvar _getChangedFilesPromise = _interopRequireDefault(require('../getChangedFilesPromise'));\n\nvar _collectHandles = require('../collectHandles');\n\nvar _handle_deprecation_warnings = _interopRequireDefault(require('../lib/handle_deprecation_warnings'));\n\nvar _runJest = _interopRequireDefault(require('../runJest'));\n\nvar _TestWatcher = _interopRequireDefault(require('../TestWatcher'));\n\nvar _watch = _interopRequireDefault(require('../watch'));\n\nvar _pluralize = _interopRequireDefault(require('../pluralize'));\n\nvar _log_debug_messages = _interopRequireDefault(require('../lib/log_debug_messages'));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nconst preRunMessagePrint = _jestUtil().preRunMessage.print;\n\nconst runCLI = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (argv, projects) {\n    const realFs = require('fs');\n\n    const fs = require('graceful-fs');\n\n    fs.gracefulify(realFs);\n    let results; // If we output a JSON object, we can't write anything to stdout, since\n    // it'll break the JSON structure and it won't be valid.\n\n    const outputStream = argv.json || argv.useStderr ? process.stderr : process.stdout;\n\n    const _readConfigs = (0, _jestConfig().readConfigs)(argv, projects),\n          globalConfig = _readConfigs.globalConfig,\n          configs = _readConfigs.configs,\n          hasDeprecationWarnings = _readConfigs.hasDeprecationWarnings;\n\n    if (argv.debug) {\n      (0, _log_debug_messages.default)(globalConfig, configs, outputStream);\n    }\n\n    if (argv.showConfig) {\n      (0, _log_debug_messages.default)(globalConfig, configs, process.stdout);\n      (0, _exit().default)(0);\n    }\n\n    if (argv.clearCache) {\n      configs.forEach(config => {\n        _rimraf().default.sync(config.cacheDirectory);\n\n        process.stdout.write(`Cleared ${config.cacheDirectory}\\n`);\n      });\n      (0, _exit().default)(0);\n    }\n\n    yield _run(globalConfig, configs, hasDeprecationWarnings, outputStream, r => results = r);\n\n    if (argv.watch || argv.watchAll) {\n      // If in watch mode, return the promise that will never resolve.\n      // If the watch mode is interrupted, watch should handle the process\n      // shutdown.\n      return new Promise(() => {});\n    }\n\n    if (!results) {\n      throw new Error('AggregatedResult must be present after test run is complete');\n    }\n\n    const _results = results,\n          openHandles = _results.openHandles;\n\n    if (openHandles && openHandles.length) {\n      const formatted = (0, _collectHandles.formatHandleErrors)(openHandles, configs[0]);\n      const openHandlesString = (0, _pluralize.default)('open handle', formatted.length, 's');\n      const message = _chalk().default.red(`\\nJest has detected the following ${openHandlesString} potentially keeping Jest from exiting:\\n\\n`) + formatted.join('\\n\\n');\n      console.error(message);\n    }\n\n    return {\n      globalConfig,\n      results\n    };\n  });\n\n  return function runCLI(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexports.runCLI = runCLI;\n\nconst buildContextsAndHasteMaps = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(function* (configs, globalConfig, outputStream) {\n    const hasteMapInstances = Array(configs.length);\n    const contexts = yield Promise.all(configs.map( /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(function* (config, index) {\n        (0, _jestUtil().createDirectory)(config.cacheDirectory);\n\n        const hasteMapInstance = _jestRuntime().default.createHasteMap(config, {\n          console: new (_console().CustomConsole)(outputStream, outputStream),\n          maxWorkers: globalConfig.maxWorkers,\n          resetCache: !config.cache,\n          watch: globalConfig.watch || globalConfig.watchAll,\n          watchman: globalConfig.watchman\n        });\n\n        hasteMapInstances[index] = hasteMapInstance;\n        return (0, _create_context.default)(config, yield hasteMapInstance.build());\n      });\n\n      return function (_x6, _x7) {\n        return _ref3.apply(this, arguments);\n      };\n    }()));\n    return {\n      contexts,\n      hasteMapInstances\n    };\n  });\n\n  return function buildContextsAndHasteMaps(_x3, _x4, _x5) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nconst _run = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator(function* (globalConfig, configs, hasDeprecationWarnings, outputStream, onComplete) {\n    // Queries to hg/git can take a while, so we need to start the process\n    // as soon as possible, so by the time we need the result it's already there.\n    const changedFilesPromise = (0, _getChangedFilesPromise.default)(globalConfig, configs); // Filter may need to do an HTTP call or something similar to setup.\n    // We will wait on an async response from this before using the filter.\n\n    let filter;\n\n    if (globalConfig.filter && !globalConfig.skipFilter) {\n      const rawFilter = require(globalConfig.filter);\n\n      let filterSetupPromise;\n\n      if (rawFilter.setup) {\n        // Wrap filter setup Promise to avoid \"uncaught Promise\" error.\n        // If an error is returned, we surface it in the return value.\n        filterSetupPromise = _asyncToGenerator(function* () {\n          try {\n            yield rawFilter.setup();\n          } catch (err) {\n            return err;\n          }\n\n          return undefined;\n        })();\n      }\n\n      filter = /*#__PURE__*/function () {\n        var _ref6 = _asyncToGenerator(function* (testPaths) {\n          if (filterSetupPromise) {\n            // Expect an undefined return value unless there was an error.\n            const err = yield filterSetupPromise;\n\n            if (err) {\n              throw err;\n            }\n          }\n\n          return rawFilter(testPaths);\n        });\n\n        return function filter(_x13) {\n          return _ref6.apply(this, arguments);\n        };\n      }();\n    }\n\n    const _ref7 = yield buildContextsAndHasteMaps(configs, globalConfig, outputStream),\n          contexts = _ref7.contexts,\n          hasteMapInstances = _ref7.hasteMapInstances;\n\n    globalConfig.watch || globalConfig.watchAll ? yield runWatch(contexts, configs, hasDeprecationWarnings, globalConfig, outputStream, hasteMapInstances, filter) : yield runWithoutWatch(globalConfig, contexts, outputStream, onComplete, changedFilesPromise, filter);\n  });\n\n  return function _run(_x8, _x9, _x10, _x11, _x12) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nconst runWatch = /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator(function* (contexts, _configs, hasDeprecationWarnings, globalConfig, outputStream, hasteMapInstances, filter) {\n    if (hasDeprecationWarnings) {\n      try {\n        yield (0, _handle_deprecation_warnings.default)(outputStream, process.stdin);\n        return (0, _watch.default)(globalConfig, contexts, outputStream, hasteMapInstances, undefined, undefined, filter);\n      } catch (e) {\n        (0, _exit().default)(0);\n      }\n    }\n\n    return (0, _watch.default)(globalConfig, contexts, outputStream, hasteMapInstances, undefined, undefined, filter);\n  });\n\n  return function runWatch(_x14, _x15, _x16, _x17, _x18, _x19, _x20) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\nconst runWithoutWatch = /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator(function* (globalConfig, contexts, outputStream, onComplete, changedFilesPromise, filter) {\n    const startRun = /*#__PURE__*/function () {\n      var _ref10 = _asyncToGenerator(function* () {\n        if (!globalConfig.listTests) {\n          preRunMessagePrint(outputStream);\n        }\n\n        return (0, _runJest.default)({\n          changedFilesPromise,\n          contexts,\n          failedTestsCache: undefined,\n          filter,\n          globalConfig,\n          onComplete,\n          outputStream,\n          startRun,\n          testWatcher: new _TestWatcher.default({\n            isWatchMode: false\n          })\n        });\n      });\n\n      return function startRun() {\n        return _ref10.apply(this, arguments);\n      };\n    }();\n\n    return startRun();\n  });\n\n  return function runWithoutWatch(_x21, _x22, _x23, _x24, _x25, _x26) {\n    return _ref9.apply(this, arguments);\n  };\n}();","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/@jest/core/build/cli/index.js"],"names":["Object","defineProperty","exports","value","runCLI","_console","data","require","_jestUtil","_jestConfig","_jestRuntime","_interopRequireDefault","_chalk","_rimraf","_exit","_create_context","_getChangedFilesPromise","_collectHandles","_handle_deprecation_warnings","_runJest","_TestWatcher","_watch","_pluralize","_log_debug_messages","obj","__esModule","default","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","preRunMessagePrint","preRunMessage","print","_ref","argv","projects","realFs","fs","gracefulify","results","outputStream","json","useStderr","process","stderr","stdout","_readConfigs","readConfigs","globalConfig","configs","hasDeprecationWarnings","debug","showConfig","clearCache","forEach","config","sync","cacheDirectory","write","_run","r","watch","watchAll","Error","_results","openHandles","length","formatted","formatHandleErrors","openHandlesString","message","red","join","console","_x","_x2","buildContextsAndHasteMaps","_ref2","hasteMapInstances","Array","contexts","all","map","_ref3","index","createDirectory","hasteMapInstance","createHasteMap","CustomConsole","maxWorkers","resetCache","cache","watchman","build","_x6","_x7","_x3","_x4","_x5","_ref4","onComplete","changedFilesPromise","filter","skipFilter","rawFilter","filterSetupPromise","setup","_ref6","testPaths","_x13","_ref7","runWatch","runWithoutWatch","_x8","_x9","_x10","_x11","_x12","_ref8","_configs","stdin","e","_x14","_x15","_x16","_x17","_x18","_x19","_x20","_ref9","startRun","_ref10","listTests","failedTestsCache","testWatcher","isWatchMode","_x21","_x22","_x23","_x24","_x25","_x26"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.runCLI = void 0;\n\nfunction _console() {\n  const data = require('@jest/console');\n\n  _console = function _console() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestUtil() {\n  const data = require('jest-util');\n\n  _jestUtil = function _jestUtil() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestConfig() {\n  const data = require('jest-config');\n\n  _jestConfig = function _jestConfig() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _jestRuntime() {\n  const data = _interopRequireDefault(require('jest-runtime'));\n\n  _jestRuntime = function _jestRuntime() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _chalk() {\n  const data = _interopRequireDefault(require('chalk'));\n\n  _chalk = function _chalk() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _rimraf() {\n  const data = _interopRequireDefault(require('rimraf'));\n\n  _rimraf = function _rimraf() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _exit() {\n  const data = _interopRequireDefault(require('exit'));\n\n  _exit = function _exit() {\n    return data;\n  };\n\n  return data;\n}\n\nvar _create_context = _interopRequireDefault(require('../lib/create_context'));\n\nvar _getChangedFilesPromise = _interopRequireDefault(\n  require('../getChangedFilesPromise')\n);\n\nvar _collectHandles = require('../collectHandles');\n\nvar _handle_deprecation_warnings = _interopRequireDefault(\n  require('../lib/handle_deprecation_warnings')\n);\n\nvar _runJest = _interopRequireDefault(require('../runJest'));\n\nvar _TestWatcher = _interopRequireDefault(require('../TestWatcher'));\n\nvar _watch = _interopRequireDefault(require('../watch'));\n\nvar _pluralize = _interopRequireDefault(require('../pluralize'));\n\nvar _log_debug_messages = _interopRequireDefault(\n  require('../lib/log_debug_messages')\n);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {default: obj};\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function() {\n    var self = this,\n      args = arguments;\n    return new Promise(function(resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n      }\n      _next(undefined);\n    });\n  };\n}\n\nconst preRunMessagePrint = _jestUtil().preRunMessage.print;\n\nconst runCLI =\n  /*#__PURE__*/\n  (function() {\n    var _ref = _asyncToGenerator(function*(argv, projects) {\n      const realFs = require('fs');\n\n      const fs = require('graceful-fs');\n\n      fs.gracefulify(realFs);\n      let results; // If we output a JSON object, we can't write anything to stdout, since\n      // it'll break the JSON structure and it won't be valid.\n\n      const outputStream =\n        argv.json || argv.useStderr ? process.stderr : process.stdout;\n\n      const _readConfigs = (0, _jestConfig().readConfigs)(argv, projects),\n        globalConfig = _readConfigs.globalConfig,\n        configs = _readConfigs.configs,\n        hasDeprecationWarnings = _readConfigs.hasDeprecationWarnings;\n\n      if (argv.debug) {\n        (0, _log_debug_messages.default)(globalConfig, configs, outputStream);\n      }\n\n      if (argv.showConfig) {\n        (0, _log_debug_messages.default)(globalConfig, configs, process.stdout);\n        (0, _exit().default)(0);\n      }\n\n      if (argv.clearCache) {\n        configs.forEach(config => {\n          _rimraf().default.sync(config.cacheDirectory);\n\n          process.stdout.write(`Cleared ${config.cacheDirectory}\\n`);\n        });\n        (0, _exit().default)(0);\n      }\n\n      yield _run(\n        globalConfig,\n        configs,\n        hasDeprecationWarnings,\n        outputStream,\n        r => (results = r)\n      );\n\n      if (argv.watch || argv.watchAll) {\n        // If in watch mode, return the promise that will never resolve.\n        // If the watch mode is interrupted, watch should handle the process\n        // shutdown.\n        return new Promise(() => {});\n      }\n\n      if (!results) {\n        throw new Error(\n          'AggregatedResult must be present after test run is complete'\n        );\n      }\n\n      const _results = results,\n        openHandles = _results.openHandles;\n\n      if (openHandles && openHandles.length) {\n        const formatted = (0, _collectHandles.formatHandleErrors)(\n          openHandles,\n          configs[0]\n        );\n        const openHandlesString = (0, _pluralize.default)(\n          'open handle',\n          formatted.length,\n          's'\n        );\n        const message =\n          _chalk().default.red(\n            `\\nJest has detected the following ${openHandlesString} potentially keeping Jest from exiting:\\n\\n`\n          ) + formatted.join('\\n\\n');\n        console.error(message);\n      }\n\n      return {\n        globalConfig,\n        results\n      };\n    });\n\n    return function runCLI(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  })();\n\nexports.runCLI = runCLI;\n\nconst buildContextsAndHasteMaps =\n  /*#__PURE__*/\n  (function() {\n    var _ref2 = _asyncToGenerator(function*(\n      configs,\n      globalConfig,\n      outputStream\n    ) {\n      const hasteMapInstances = Array(configs.length);\n      const contexts = yield Promise.all(\n        configs.map(\n          /*#__PURE__*/\n          (function() {\n            var _ref3 = _asyncToGenerator(function*(config, index) {\n              (0, _jestUtil().createDirectory)(config.cacheDirectory);\n\n              const hasteMapInstance = _jestRuntime().default.createHasteMap(\n                config,\n                {\n                  console: new (_console()).CustomConsole(\n                    outputStream,\n                    outputStream\n                  ),\n                  maxWorkers: globalConfig.maxWorkers,\n                  resetCache: !config.cache,\n                  watch: globalConfig.watch || globalConfig.watchAll,\n                  watchman: globalConfig.watchman\n                }\n              );\n\n              hasteMapInstances[index] = hasteMapInstance;\n              return (0,\n              _create_context.default)(config, yield hasteMapInstance.build());\n            });\n\n            return function(_x6, _x7) {\n              return _ref3.apply(this, arguments);\n            };\n          })()\n        )\n      );\n      return {\n        contexts,\n        hasteMapInstances\n      };\n    });\n\n    return function buildContextsAndHasteMaps(_x3, _x4, _x5) {\n      return _ref2.apply(this, arguments);\n    };\n  })();\n\nconst _run =\n  /*#__PURE__*/\n  (function() {\n    var _ref4 = _asyncToGenerator(function*(\n      globalConfig,\n      configs,\n      hasDeprecationWarnings,\n      outputStream,\n      onComplete\n    ) {\n      // Queries to hg/git can take a while, so we need to start the process\n      // as soon as possible, so by the time we need the result it's already there.\n      const changedFilesPromise = (0, _getChangedFilesPromise.default)(\n        globalConfig,\n        configs\n      ); // Filter may need to do an HTTP call or something similar to setup.\n      // We will wait on an async response from this before using the filter.\n\n      let filter;\n\n      if (globalConfig.filter && !globalConfig.skipFilter) {\n        const rawFilter = require(globalConfig.filter);\n\n        let filterSetupPromise;\n\n        if (rawFilter.setup) {\n          // Wrap filter setup Promise to avoid \"uncaught Promise\" error.\n          // If an error is returned, we surface it in the return value.\n          filterSetupPromise = _asyncToGenerator(function*() {\n            try {\n              yield rawFilter.setup();\n            } catch (err) {\n              return err;\n            }\n\n            return undefined;\n          })();\n        }\n\n        filter =\n          /*#__PURE__*/\n          (function() {\n            var _ref6 = _asyncToGenerator(function*(testPaths) {\n              if (filterSetupPromise) {\n                // Expect an undefined return value unless there was an error.\n                const err = yield filterSetupPromise;\n\n                if (err) {\n                  throw err;\n                }\n              }\n\n              return rawFilter(testPaths);\n            });\n\n            return function filter(_x13) {\n              return _ref6.apply(this, arguments);\n            };\n          })();\n      }\n\n      const _ref7 = yield buildContextsAndHasteMaps(\n          configs,\n          globalConfig,\n          outputStream\n        ),\n        contexts = _ref7.contexts,\n        hasteMapInstances = _ref7.hasteMapInstances;\n\n      globalConfig.watch || globalConfig.watchAll\n        ? yield runWatch(\n            contexts,\n            configs,\n            hasDeprecationWarnings,\n            globalConfig,\n            outputStream,\n            hasteMapInstances,\n            filter\n          )\n        : yield runWithoutWatch(\n            globalConfig,\n            contexts,\n            outputStream,\n            onComplete,\n            changedFilesPromise,\n            filter\n          );\n    });\n\n    return function _run(_x8, _x9, _x10, _x11, _x12) {\n      return _ref4.apply(this, arguments);\n    };\n  })();\n\nconst runWatch =\n  /*#__PURE__*/\n  (function() {\n    var _ref8 = _asyncToGenerator(function*(\n      contexts,\n      _configs,\n      hasDeprecationWarnings,\n      globalConfig,\n      outputStream,\n      hasteMapInstances,\n      filter\n    ) {\n      if (hasDeprecationWarnings) {\n        try {\n          yield (0, _handle_deprecation_warnings.default)(\n            outputStream,\n            process.stdin\n          );\n          return (0, _watch.default)(\n            globalConfig,\n            contexts,\n            outputStream,\n            hasteMapInstances,\n            undefined,\n            undefined,\n            filter\n          );\n        } catch (e) {\n          (0, _exit().default)(0);\n        }\n      }\n\n      return (0, _watch.default)(\n        globalConfig,\n        contexts,\n        outputStream,\n        hasteMapInstances,\n        undefined,\n        undefined,\n        filter\n      );\n    });\n\n    return function runWatch(_x14, _x15, _x16, _x17, _x18, _x19, _x20) {\n      return _ref8.apply(this, arguments);\n    };\n  })();\n\nconst runWithoutWatch =\n  /*#__PURE__*/\n  (function() {\n    var _ref9 = _asyncToGenerator(function*(\n      globalConfig,\n      contexts,\n      outputStream,\n      onComplete,\n      changedFilesPromise,\n      filter\n    ) {\n      const startRun =\n        /*#__PURE__*/\n        (function() {\n          var _ref10 = _asyncToGenerator(function*() {\n            if (!globalConfig.listTests) {\n              preRunMessagePrint(outputStream);\n            }\n\n            return (0, _runJest.default)({\n              changedFilesPromise,\n              contexts,\n              failedTestsCache: undefined,\n              filter,\n              globalConfig,\n              onComplete,\n              outputStream,\n              startRun,\n              testWatcher: new _TestWatcher.default({\n                isWatchMode: false\n              })\n            });\n          });\n\n          return function startRun() {\n            return _ref10.apply(this, arguments);\n          };\n        })();\n\n      return startRun();\n    });\n\n    return function runWithoutWatch(_x21, _x22, _x23, _x24, _x25, _x26) {\n      return _ref9.apply(this, arguments);\n    };\n  })();\n"]},"metadata":{},"sourceType":"script"}