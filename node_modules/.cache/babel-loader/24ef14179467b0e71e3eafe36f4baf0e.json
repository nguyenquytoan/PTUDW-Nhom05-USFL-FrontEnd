{"ast":null,"code":"var canReorder = require('./reorderable').canReorder;\n\nvar canReorderSingle = require('./reorderable').canReorderSingle;\n\nvar extractProperties = require('./extract-properties');\n\nvar rulesOverlap = require('./rules-overlap');\n\nvar serializeRules = require('../../writer/one-time').rules;\n\nvar OptimizationLevel = require('../../options/optimization-level').OptimizationLevel;\n\nvar Token = require('../../tokenizer/token');\n\nfunction mergeMediaQueries(tokens, context) {\n  var mergeSemantically = context.options.level[OptimizationLevel.Two].mergeSemantically;\n  var specificityCache = context.cache.specificity;\n  var candidates = {};\n  var reduced = [];\n\n  for (var i = tokens.length - 1; i >= 0; i--) {\n    var token = tokens[i];\n\n    if (token[0] != Token.NESTED_BLOCK) {\n      continue;\n    }\n\n    var key = serializeRules(token[1]);\n    var candidate = candidates[key];\n\n    if (!candidate) {\n      candidate = [];\n      candidates[key] = candidate;\n    }\n\n    candidate.push(i);\n  }\n\n  for (var name in candidates) {\n    var positions = candidates[name];\n\n    positionLoop: for (var j = positions.length - 1; j > 0; j--) {\n      var positionOne = positions[j];\n      var tokenOne = tokens[positionOne];\n      var positionTwo = positions[j - 1];\n      var tokenTwo = tokens[positionTwo];\n\n      directionLoop: for (var direction = 1; direction >= -1; direction -= 2) {\n        var topToBottom = direction == 1;\n        var from = topToBottom ? positionOne + 1 : positionTwo - 1;\n        var to = topToBottom ? positionTwo : positionOne;\n        var delta = topToBottom ? 1 : -1;\n        var source = topToBottom ? tokenOne : tokenTwo;\n        var target = topToBottom ? tokenTwo : tokenOne;\n        var movedProperties = extractProperties(source);\n\n        while (from != to) {\n          var traversedProperties = extractProperties(tokens[from]);\n          from += delta;\n\n          if (mergeSemantically && allSameRulePropertiesCanBeReordered(movedProperties, traversedProperties, specificityCache)) {\n            continue;\n          }\n\n          if (!canReorder(movedProperties, traversedProperties, specificityCache)) continue directionLoop;\n        }\n\n        target[2] = topToBottom ? source[2].concat(target[2]) : target[2].concat(source[2]);\n        source[2] = [];\n        reduced.push(target);\n        continue positionLoop;\n      }\n    }\n  }\n\n  return reduced;\n}\n\nfunction allSameRulePropertiesCanBeReordered(movedProperties, traversedProperties, specificityCache) {\n  var movedProperty;\n  var movedRule;\n  var traversedProperty;\n  var traversedRule;\n  var i, l;\n  var j, m;\n\n  for (i = 0, l = movedProperties.length; i < l; i++) {\n    movedProperty = movedProperties[i];\n    movedRule = movedProperty[5];\n\n    for (j = 0, m = traversedProperties.length; j < m; j++) {\n      traversedProperty = traversedProperties[j];\n      traversedRule = traversedProperty[5];\n\n      if (rulesOverlap(movedRule, traversedRule, true) && !canReorderSingle(movedProperty, traversedProperty, specificityCache)) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nmodule.exports = mergeMediaQueries;","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/clean-css/lib/optimizer/level-2/merge-media-queries.js"],"names":["canReorder","require","canReorderSingle","extractProperties","rulesOverlap","serializeRules","rules","OptimizationLevel","Token","mergeMediaQueries","tokens","context","mergeSemantically","options","level","Two","specificityCache","cache","specificity","candidates","reduced","i","length","token","NESTED_BLOCK","key","candidate","push","name","positions","positionLoop","j","positionOne","tokenOne","positionTwo","tokenTwo","directionLoop","direction","topToBottom","from","to","delta","source","target","movedProperties","traversedProperties","allSameRulePropertiesCanBeReordered","concat","movedProperty","movedRule","traversedProperty","traversedRule","l","m","module","exports"],"mappings":"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","sourcesContent":["var canReorder = require('./reorderable').canReorder;\nvar canReorderSingle = require('./reorderable').canReorderSingle;\nvar extractProperties = require('./extract-properties');\nvar rulesOverlap = require('./rules-overlap');\n\nvar serializeRules = require('../../writer/one-time').rules;\nvar OptimizationLevel = require('../../options/optimization-level').OptimizationLevel;\nvar Token = require('../../tokenizer/token');\n\nfunction mergeMediaQueries(tokens, context) {\n  var mergeSemantically = context.options.level[OptimizationLevel.Two].mergeSemantically;\n  var specificityCache = context.cache.specificity;\n  var candidates = {};\n  var reduced = [];\n\n  for (var i = tokens.length - 1; i >= 0; i--) {\n    var token = tokens[i];\n    if (token[0] != Token.NESTED_BLOCK) {\n      continue;\n    }\n\n    var key = serializeRules(token[1]);\n    var candidate = candidates[key];\n    if (!candidate) {\n      candidate = [];\n      candidates[key] = candidate;\n    }\n\n    candidate.push(i);\n  }\n\n  for (var name in candidates) {\n    var positions = candidates[name];\n\n    positionLoop:\n    for (var j = positions.length - 1; j > 0; j--) {\n      var positionOne = positions[j];\n      var tokenOne = tokens[positionOne];\n      var positionTwo = positions[j - 1];\n      var tokenTwo = tokens[positionTwo];\n\n      directionLoop:\n      for (var direction = 1; direction >= -1; direction -= 2) {\n        var topToBottom = direction == 1;\n        var from = topToBottom ? positionOne + 1 : positionTwo - 1;\n        var to = topToBottom ? positionTwo : positionOne;\n        var delta = topToBottom ? 1 : -1;\n        var source = topToBottom ? tokenOne : tokenTwo;\n        var target = topToBottom ? tokenTwo : tokenOne;\n        var movedProperties = extractProperties(source);\n\n        while (from != to) {\n          var traversedProperties = extractProperties(tokens[from]);\n          from += delta;\n\n          if (mergeSemantically && allSameRulePropertiesCanBeReordered(movedProperties, traversedProperties, specificityCache)) {\n            continue;\n          }\n\n          if (!canReorder(movedProperties, traversedProperties, specificityCache))\n            continue directionLoop;\n        }\n\n        target[2] = topToBottom ?\n          source[2].concat(target[2]) :\n          target[2].concat(source[2]);\n        source[2] = [];\n\n        reduced.push(target);\n        continue positionLoop;\n      }\n    }\n  }\n\n  return reduced;\n}\n\nfunction allSameRulePropertiesCanBeReordered(movedProperties, traversedProperties, specificityCache) {\n  var movedProperty;\n  var movedRule;\n  var traversedProperty;\n  var traversedRule;\n  var i, l;\n  var j, m;\n\n  for (i = 0, l = movedProperties.length; i < l; i++) {\n    movedProperty = movedProperties[i];\n    movedRule = movedProperty[5];\n\n    for (j = 0, m = traversedProperties.length; j < m; j++) {\n      traversedProperty = traversedProperties[j];\n      traversedRule = traversedProperty[5];\n\n      if (rulesOverlap(movedRule, traversedRule, true) && !canReorderSingle(movedProperty, traversedProperty, specificityCache)) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nmodule.exports = mergeMediaQueries;\n"]},"metadata":{},"sourceType":"script"}