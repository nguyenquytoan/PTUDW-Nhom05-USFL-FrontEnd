{"ast":null,"code":"'use strict';\n\nexports.type = 'full';\nexports.active = true;\nexports.description = 'minifies styles and removes unused styles based on usage data';\nexports.params = {\n  // ... CSSO options goes here\n  // additional \n  usage: {\n    force: false,\n    // force to use usage data even if it unsafe (document contains <script> or on* attributes)\n    ids: true,\n    classes: true,\n    tags: true\n  }\n};\n\nvar csso = require('csso');\n/**\n * Minifies styles (<style> element + style attribute) using CSSO\n *\n * @author strarsis <strarsis@gmail.com>\n */\n\n\nexports.fn = function (ast, options) {\n  options = options || {};\n  var minifyOptionsForStylesheet = cloneObject(options);\n  var minifyOptionsForAttribute = cloneObject(options);\n  var elems = findStyleElems(ast);\n  minifyOptionsForStylesheet.usage = collectUsageData(ast, options);\n  minifyOptionsForAttribute.usage = null;\n  elems.forEach(function (elem) {\n    if (elem.isElem('style')) {\n      // <style> element\n      var styleCss = elem.content[0].text || elem.content[0].cdata || [];\n      var DATA = styleCss.indexOf('>') >= 0 || styleCss.indexOf('<') >= 0 ? 'cdata' : 'text';\n      elem.content[0][DATA] = csso.minify(styleCss, minifyOptionsForStylesheet).css;\n    } else {\n      // style attribute\n      var elemStyle = elem.attr('style').value;\n      elem.attr('style').value = csso.minifyBlock(elemStyle, minifyOptionsForAttribute).css;\n    }\n  });\n  return ast;\n};\n\nfunction cloneObject(obj) {\n  var result = {};\n\n  for (var key in obj) {\n    result[key] = obj[key];\n  }\n\n  return result;\n}\n\nfunction findStyleElems(ast) {\n  function walk(items, styles) {\n    for (var i = 0; i < items.content.length; i++) {\n      var item = items.content[i]; // go deeper\n\n      if (item.content) {\n        walk(item, styles);\n      }\n\n      if (item.isElem('style') && !item.isEmpty()) {\n        styles.push(item);\n      } else if (item.isElem() && item.hasAttr('style')) {\n        styles.push(item);\n      }\n    }\n\n    return styles;\n  }\n\n  return walk(ast, []);\n}\n\nfunction shouldFilter(options, name) {\n  if ('usage' in options === false) {\n    return true;\n  }\n\n  if (options.usage && name in options.usage === false) {\n    return true;\n  }\n\n  return Boolean(options.usage && options.usage[name]);\n}\n\nfunction collectUsageData(ast, options) {\n  function walk(items, usageData) {\n    for (var i = 0; i < items.content.length; i++) {\n      var item = items.content[i]; // go deeper\n\n      if (item.content) {\n        walk(item, usageData);\n      }\n\n      if (item.isElem('script')) {\n        safe = false;\n      }\n\n      if (item.isElem()) {\n        usageData.tags[item.elem] = true;\n\n        if (item.hasAttr('id')) {\n          usageData.ids[item.attr('id').value] = true;\n        }\n\n        if (item.hasAttr('class')) {\n          item.attr('class').value.replace(/^\\s+|\\s+$/g, '').split(/\\s+/).forEach(function (className) {\n            usageData.classes[className] = true;\n          });\n        }\n\n        if (item.attrs && Object.keys(item.attrs).some(function (name) {\n          return /^on/i.test(name);\n        })) {\n          safe = false;\n        }\n      }\n    }\n\n    return usageData;\n  }\n\n  var safe = true;\n  var usageData = {};\n  var hasData = false;\n  var rawData = walk(ast, {\n    ids: Object.create(null),\n    classes: Object.create(null),\n    tags: Object.create(null)\n  });\n\n  if (!safe && options.usage && options.usage.force) {\n    safe = true;\n  }\n\n  for (var key in rawData) {\n    if (shouldFilter(options, key)) {\n      usageData[key] = Object.keys(rawData[key]);\n      hasData = true;\n    }\n  }\n\n  return safe && hasData ? usageData : null;\n}","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/svgo/plugins/minifyStyles.js"],"names":["exports","type","active","description","params","usage","force","ids","classes","tags","csso","require","fn","ast","options","minifyOptionsForStylesheet","cloneObject","minifyOptionsForAttribute","elems","findStyleElems","collectUsageData","forEach","elem","isElem","styleCss","content","text","cdata","DATA","indexOf","minify","css","elemStyle","attr","value","minifyBlock","obj","result","key","walk","items","styles","i","length","item","isEmpty","push","hasAttr","shouldFilter","name","Boolean","usageData","safe","replace","split","className","attrs","Object","keys","some","test","hasData","rawData","create"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.type = 'full';\n\nexports.active = true;\n\nexports.description = 'minifies styles and removes unused styles based on usage data';\n\nexports.params = {\n    // ... CSSO options goes here\n\n    // additional \n    usage: {\n        force: false,  // force to use usage data even if it unsafe (document contains <script> or on* attributes)\n        ids: true,\n        classes: true,\n        tags: true\n    }\n};\n\nvar csso = require('csso');\n\n/**\n * Minifies styles (<style> element + style attribute) using CSSO\n *\n * @author strarsis <strarsis@gmail.com>\n */\nexports.fn = function(ast, options) {\n    options = options || {};\n\n    var minifyOptionsForStylesheet = cloneObject(options);\n    var minifyOptionsForAttribute = cloneObject(options);\n    var elems = findStyleElems(ast);\n\n    minifyOptionsForStylesheet.usage = collectUsageData(ast, options);\n    minifyOptionsForAttribute.usage = null;\n\n    elems.forEach(function(elem) {\n        if (elem.isElem('style')) {\n            // <style> element\n            var styleCss = elem.content[0].text || elem.content[0].cdata || [];\n            var DATA = styleCss.indexOf('>') >= 0 || styleCss.indexOf('<') >= 0 ? 'cdata' : 'text';\n\n            elem.content[0][DATA] = csso.minify(styleCss, minifyOptionsForStylesheet).css;\n        } else {\n            // style attribute\n            var elemStyle = elem.attr('style').value;\n\n            elem.attr('style').value = csso.minifyBlock(elemStyle, minifyOptionsForAttribute).css;\n        }\n    });\n\n    return ast;\n};\n\nfunction cloneObject(obj) {\n    var result = {};\n\n    for (var key in obj) {\n        result[key] = obj[key];\n    }\n\n    return result;\n}\n\nfunction findStyleElems(ast) {\n\n    function walk(items, styles) {\n        for (var i = 0; i < items.content.length; i++) {\n            var item = items.content[i];\n\n            // go deeper\n            if (item.content) {\n                walk(item, styles);\n            }\n\n            if (item.isElem('style') && !item.isEmpty()) {\n                styles.push(item);\n            } else if (item.isElem() && item.hasAttr('style')) {\n                styles.push(item);\n            }\n        }\n\n        return styles;\n    }\n\n    return walk(ast, []);\n}\n\nfunction shouldFilter(options, name) {\n    if ('usage' in options === false) {\n        return true;\n    }\n\n    if (options.usage && name in options.usage === false) {\n        return true;\n    }\n\n    return Boolean(options.usage && options.usage[name]);\n}\n\nfunction collectUsageData(ast, options) {\n\n    function walk(items, usageData) {\n        for (var i = 0; i < items.content.length; i++) {\n            var item = items.content[i];\n\n            // go deeper\n            if (item.content) {\n                walk(item, usageData);\n            }\n\n            if (item.isElem('script')) {\n                safe = false;\n            }\n\n            if (item.isElem()) {\n                usageData.tags[item.elem] = true;\n\n                if (item.hasAttr('id')) {\n                    usageData.ids[item.attr('id').value] = true;\n                }\n\n                if (item.hasAttr('class')) {\n                    item.attr('class').value.replace(/^\\s+|\\s+$/g, '').split(/\\s+/).forEach(function(className) {\n                        usageData.classes[className] = true;\n                    });\n                }\n\n                if (item.attrs && Object.keys(item.attrs).some(function(name) { return /^on/i.test(name); })) {\n                    safe = false;\n                }\n            }\n        }\n\n        return usageData;\n    }\n\n    var safe = true;\n    var usageData = {};\n    var hasData = false;\n    var rawData = walk(ast, {\n        ids: Object.create(null),\n        classes: Object.create(null),\n        tags: Object.create(null)\n    });\n\n    if (!safe && options.usage && options.usage.force) {\n        safe = true;\n    }\n\n    for (var key in rawData) {\n        if (shouldFilter(options, key)) {\n            usageData[key] = Object.keys(rawData[key]);\n            hasData = true;\n        }\n    }\n\n    return safe && hasData ? usageData : null;\n}\n"]},"metadata":{},"sourceType":"script"}