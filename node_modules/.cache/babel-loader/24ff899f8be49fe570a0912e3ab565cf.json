{"ast":null,"code":"'use strict';\n\nvar CleanCSS = require('clean-css');\n\nvar decode = require('he').decode;\n\nvar HTMLParser = require('./htmlparser').HTMLParser;\n\nvar RelateUrl = require('relateurl');\n\nvar TokenChain = require('./tokenchain');\n\nvar Terser = require('terser');\n\nvar utils = require('./utils');\n\nfunction trimWhitespace(str) {\n  return str && str.replace(/^[ \\n\\r\\t\\f]+/, '').replace(/[ \\n\\r\\t\\f]+$/, '');\n}\n\nfunction collapseWhitespaceAll(str) {\n  // Non-breaking space is specifically handled inside the replacer function here:\n  return str && str.replace(/[ \\n\\r\\t\\f\\xA0]+/g, function (spaces) {\n    return spaces === '\\t' ? '\\t' : spaces.replace(/(^|\\xA0+)[^\\xA0]+/g, '$1 ');\n  });\n}\n\nfunction collapseWhitespace(str, options, trimLeft, trimRight, collapseAll) {\n  var lineBreakBefore = '',\n      lineBreakAfter = '';\n\n  if (options.preserveLineBreaks) {\n    str = str.replace(/^[ \\n\\r\\t\\f]*?[\\n\\r][ \\n\\r\\t\\f]*/, function () {\n      lineBreakBefore = '\\n';\n      return '';\n    }).replace(/[ \\n\\r\\t\\f]*?[\\n\\r][ \\n\\r\\t\\f]*$/, function () {\n      lineBreakAfter = '\\n';\n      return '';\n    });\n  }\n\n  if (trimLeft) {\n    // Non-breaking space is specifically handled inside the replacer function here:\n    str = str.replace(/^[ \\n\\r\\t\\f\\xA0]+/, function (spaces) {\n      var conservative = !lineBreakBefore && options.conservativeCollapse;\n\n      if (conservative && spaces === '\\t') {\n        return '\\t';\n      }\n\n      return spaces.replace(/^[^\\xA0]+/, '').replace(/(\\xA0+)[^\\xA0]+/g, '$1 ') || (conservative ? ' ' : '');\n    });\n  }\n\n  if (trimRight) {\n    // Non-breaking space is specifically handled inside the replacer function here:\n    str = str.replace(/[ \\n\\r\\t\\f\\xA0]+$/, function (spaces) {\n      var conservative = !lineBreakAfter && options.conservativeCollapse;\n\n      if (conservative && spaces === '\\t') {\n        return '\\t';\n      }\n\n      return spaces.replace(/[^\\xA0]+(\\xA0+)/g, ' $1').replace(/[^\\xA0]+$/, '') || (conservative ? ' ' : '');\n    });\n  }\n\n  if (collapseAll) {\n    // strip non space whitespace then compress spaces to one\n    str = collapseWhitespaceAll(str);\n  }\n\n  return lineBreakBefore + str + lineBreakAfter;\n}\n\nvar createMapFromString = utils.createMapFromString; // non-empty tags that will maintain whitespace around them\n\nvar inlineTags = createMapFromString('a,abbr,acronym,b,bdi,bdo,big,button,cite,code,del,dfn,em,font,i,ins,kbd,label,mark,math,nobr,object,q,rp,rt,rtc,ruby,s,samp,select,small,span,strike,strong,sub,sup,svg,textarea,time,tt,u,var'); // non-empty tags that will maintain whitespace within them\n\nvar inlineTextTags = createMapFromString('a,abbr,acronym,b,big,del,em,font,i,ins,kbd,mark,nobr,rp,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var'); // self-closing tags that will maintain whitespace around them\n\nvar selfClosingInlineTags = createMapFromString('comment,img,input,wbr');\n\nfunction collapseWhitespaceSmart(str, prevTag, nextTag, options) {\n  var trimLeft = prevTag && !selfClosingInlineTags(prevTag);\n\n  if (trimLeft && !options.collapseInlineTagWhitespace) {\n    trimLeft = prevTag.charAt(0) === '/' ? !inlineTags(prevTag.slice(1)) : !inlineTextTags(prevTag);\n  }\n\n  var trimRight = nextTag && !selfClosingInlineTags(nextTag);\n\n  if (trimRight && !options.collapseInlineTagWhitespace) {\n    trimRight = nextTag.charAt(0) === '/' ? !inlineTextTags(nextTag.slice(1)) : !inlineTags(nextTag);\n  }\n\n  return collapseWhitespace(str, options, trimLeft, trimRight, prevTag && nextTag);\n}\n\nfunction isConditionalComment(text) {\n  return /^\\[if\\s[^\\]]+]|\\[endif]$/.test(text);\n}\n\nfunction isIgnoredComment(text, options) {\n  for (var i = 0, len = options.ignoreCustomComments.length; i < len; i++) {\n    if (options.ignoreCustomComments[i].test(text)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction isEventAttribute(attrName, options) {\n  var patterns = options.customEventAttributes;\n\n  if (patterns) {\n    for (var i = patterns.length; i--;) {\n      if (patterns[i].test(attrName)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  return /^on[a-z]{3,}$/.test(attrName);\n}\n\nfunction canRemoveAttributeQuotes(value) {\n  // https://mathiasbynens.be/notes/unquoted-attribute-values\n  return /^[^ \\t\\n\\f\\r\"'`=<>]+$/.test(value);\n}\n\nfunction attributesInclude(attributes, attribute) {\n  for (var i = attributes.length; i--;) {\n    if (attributes[i].name.toLowerCase() === attribute) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction isAttributeRedundant(tag, attrName, attrValue, attrs) {\n  attrValue = attrValue ? trimWhitespace(attrValue.toLowerCase()) : '';\n  return tag === 'script' && attrName === 'language' && attrValue === 'javascript' || tag === 'form' && attrName === 'method' && attrValue === 'get' || tag === 'input' && attrName === 'type' && attrValue === 'text' || tag === 'script' && attrName === 'charset' && !attributesInclude(attrs, 'src') || tag === 'a' && attrName === 'name' && attributesInclude(attrs, 'id') || tag === 'area' && attrName === 'shape' && attrValue === 'rect';\n} // https://mathiasbynens.be/demo/javascript-mime-type\n// https://developer.mozilla.org/en/docs/Web/HTML/Element/script#attr-type\n\n\nvar executableScriptsMimetypes = utils.createMap(['text/javascript', 'text/ecmascript', 'text/jscript', 'application/javascript', 'application/x-javascript', 'application/ecmascript', 'module']);\nvar keepScriptsMimetypes = utils.createMap(['module']);\n\nfunction isScriptTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase();\n  return attrValue === '' || executableScriptsMimetypes(attrValue);\n}\n\nfunction keepScriptTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase();\n  return keepScriptsMimetypes(attrValue);\n}\n\nfunction isExecutableScript(tag, attrs) {\n  if (tag !== 'script') {\n    return false;\n  }\n\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    var attrName = attrs[i].name.toLowerCase();\n\n    if (attrName === 'type') {\n      return isScriptTypeAttribute(attrs[i].value);\n    }\n  }\n\n  return true;\n}\n\nfunction isStyleLinkTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue).toLowerCase();\n  return attrValue === '' || attrValue === 'text/css';\n}\n\nfunction isStyleSheet(tag, attrs) {\n  if (tag !== 'style') {\n    return false;\n  }\n\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    var attrName = attrs[i].name.toLowerCase();\n\n    if (attrName === 'type') {\n      return isStyleLinkTypeAttribute(attrs[i].value);\n    }\n  }\n\n  return true;\n}\n\nvar isSimpleBoolean = createMapFromString('allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible');\nvar isBooleanValue = createMapFromString('true,false');\n\nfunction isBooleanAttribute(attrName, attrValue) {\n  return isSimpleBoolean(attrName) || attrName === 'draggable' && !isBooleanValue(attrValue);\n}\n\nfunction isUriTypeAttribute(attrName, tag) {\n  return /^(?:a|area|link|base)$/.test(tag) && attrName === 'href' || tag === 'img' && /^(?:src|longdesc|usemap)$/.test(attrName) || tag === 'object' && /^(?:classid|codebase|data|usemap)$/.test(attrName) || tag === 'q' && attrName === 'cite' || tag === 'blockquote' && attrName === 'cite' || (tag === 'ins' || tag === 'del') && attrName === 'cite' || tag === 'form' && attrName === 'action' || tag === 'input' && (attrName === 'src' || attrName === 'usemap') || tag === 'head' && attrName === 'profile' || tag === 'script' && (attrName === 'src' || attrName === 'for');\n}\n\nfunction isNumberTypeAttribute(attrName, tag) {\n  return /^(?:a|area|object|button)$/.test(tag) && attrName === 'tabindex' || tag === 'input' && (attrName === 'maxlength' || attrName === 'tabindex') || tag === 'select' && (attrName === 'size' || attrName === 'tabindex') || tag === 'textarea' && /^(?:rows|cols|tabindex)$/.test(attrName) || tag === 'colgroup' && attrName === 'span' || tag === 'col' && attrName === 'span' || (tag === 'th' || tag === 'td') && (attrName === 'rowspan' || attrName === 'colspan');\n}\n\nfunction isLinkType(tag, attrs, value) {\n  if (tag !== 'link') {\n    return false;\n  }\n\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name === 'rel' && attrs[i].value === value) {\n      return true;\n    }\n  }\n}\n\nfunction isMediaQuery(tag, attrs, attrName) {\n  return attrName === 'media' && (isLinkType(tag, attrs, 'stylesheet') || isStyleSheet(tag, attrs));\n}\n\nvar srcsetTags = createMapFromString('img,source');\n\nfunction isSrcset(attrName, tag) {\n  return attrName === 'srcset' && srcsetTags(tag);\n}\n\nfunction cleanAttributeValue(tag, attrName, attrValue, options, attrs) {\n  if (isEventAttribute(attrName, options)) {\n    attrValue = trimWhitespace(attrValue).replace(/^javascript:\\s*/i, '');\n    return options.minifyJS(attrValue, true);\n  } else if (attrName === 'class') {\n    attrValue = trimWhitespace(attrValue);\n\n    if (options.sortClassName) {\n      attrValue = options.sortClassName(attrValue);\n    } else {\n      attrValue = collapseWhitespaceAll(attrValue);\n    }\n\n    return attrValue;\n  } else if (isUriTypeAttribute(attrName, tag)) {\n    attrValue = trimWhitespace(attrValue);\n    return isLinkType(tag, attrs, 'canonical') ? attrValue : options.minifyURLs(attrValue);\n  } else if (isNumberTypeAttribute(attrName, tag)) {\n    return trimWhitespace(attrValue);\n  } else if (attrName === 'style') {\n    attrValue = trimWhitespace(attrValue);\n\n    if (attrValue) {\n      if (/;$/.test(attrValue) && !/&#?[0-9a-zA-Z]+;$/.test(attrValue)) {\n        attrValue = attrValue.replace(/\\s*;$/, ';');\n      }\n\n      attrValue = options.minifyCSS(attrValue, 'inline');\n    }\n\n    return attrValue;\n  } else if (isSrcset(attrName, tag)) {\n    // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-srcset\n    attrValue = trimWhitespace(attrValue).split(/\\s+,\\s*|\\s*,\\s+/).map(function (candidate) {\n      var url = candidate;\n      var descriptor = '';\n      var match = candidate.match(/\\s+([1-9][0-9]*w|[0-9]+(?:\\.[0-9]+)?x)$/);\n\n      if (match) {\n        url = url.slice(0, -match[0].length);\n        var num = +match[1].slice(0, -1);\n        var suffix = match[1].slice(-1);\n\n        if (num !== 1 || suffix !== 'x') {\n          descriptor = ' ' + num + suffix;\n        }\n      }\n\n      return options.minifyURLs(url) + descriptor;\n    }).join(', ');\n  } else if (isMetaViewport(tag, attrs) && attrName === 'content') {\n    attrValue = attrValue.replace(/\\s+/g, '').replace(/[0-9]+\\.[0-9]+/g, function (numString) {\n      // \"0.90000\" -> \"0.9\"\n      // \"1.0\" -> \"1\"\n      // \"1.0001\" -> \"1.0001\" (unchanged)\n      return (+numString).toString();\n    });\n  } else if (isContentSecurityPolicy(tag, attrs) && attrName.toLowerCase() === 'content') {\n    return collapseWhitespaceAll(attrValue);\n  } else if (options.customAttrCollapse && options.customAttrCollapse.test(attrName)) {\n    attrValue = attrValue.replace(/\\n+|\\r+|\\s{2,}/g, '');\n  } else if (tag === 'script' && attrName === 'type') {\n    attrValue = trimWhitespace(attrValue.replace(/\\s*;\\s*/g, ';'));\n  } else if (isMediaQuery(tag, attrs, attrName)) {\n    attrValue = trimWhitespace(attrValue);\n    return options.minifyCSS(attrValue, 'media');\n  }\n\n  return attrValue;\n}\n\nfunction isMetaViewport(tag, attrs) {\n  if (tag !== 'meta') {\n    return false;\n  }\n\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name === 'name' && attrs[i].value === 'viewport') {\n      return true;\n    }\n  }\n}\n\nfunction isContentSecurityPolicy(tag, attrs) {\n  if (tag !== 'meta') {\n    return false;\n  }\n\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name.toLowerCase() === 'http-equiv' && attrs[i].value.toLowerCase() === 'content-security-policy') {\n      return true;\n    }\n  }\n}\n\nfunction ignoreCSS(id) {\n  return '/* clean-css ignore:start */' + id + '/* clean-css ignore:end */';\n} // Wrap CSS declarations for CleanCSS > 3.x\n// See https://github.com/jakubpawlowicz/clean-css/issues/418\n\n\nfunction wrapCSS(text, type) {\n  switch (type) {\n    case 'inline':\n      return '*{' + text + '}';\n\n    case 'media':\n      return '@media ' + text + '{a{top:0}}';\n\n    default:\n      return text;\n  }\n}\n\nfunction unwrapCSS(text, type) {\n  var matches;\n\n  switch (type) {\n    case 'inline':\n      matches = text.match(/^\\*\\{([\\s\\S]*)\\}$/);\n      break;\n\n    case 'media':\n      matches = text.match(/^@media ([\\s\\S]*?)\\s*{[\\s\\S]*}$/);\n      break;\n  }\n\n  return matches ? matches[1] : text;\n}\n\nfunction cleanConditionalComment(comment, options) {\n  return options.processConditionalComments ? comment.replace(/^(\\[if\\s[^\\]]+]>)([\\s\\S]*?)(<!\\[endif])$/, function (match, prefix, text, suffix) {\n    return prefix + minify(text, options, true) + suffix;\n  }) : comment;\n}\n\nfunction processScript(text, options, currentAttrs) {\n  for (var i = 0, len = currentAttrs.length; i < len; i++) {\n    if (currentAttrs[i].name.toLowerCase() === 'type' && options.processScripts.indexOf(currentAttrs[i].value) > -1) {\n      return minify(text, options);\n    }\n  }\n\n  return text;\n} // Tag omission rules from https://html.spec.whatwg.org/multipage/syntax.html#optional-tags\n// with the following deviations:\n// - retain <body> if followed by <noscript>\n// - </rb>, </rt>, </rtc>, </rp> & </tfoot> follow https://www.w3.org/TR/html5/syntax.html#optional-tags\n// - retain all tags which are adjacent to non-standard HTML tags\n\n\nvar optionalStartTags = createMapFromString('html,head,body,colgroup,tbody');\nvar optionalEndTags = createMapFromString('html,head,body,li,dt,dd,p,rb,rt,rtc,rp,optgroup,option,colgroup,caption,thead,tbody,tfoot,tr,td,th');\nvar headerTags = createMapFromString('meta,link,script,style,template,noscript');\nvar descriptionTags = createMapFromString('dt,dd');\nvar pBlockTags = createMapFromString('address,article,aside,blockquote,details,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,main,menu,nav,ol,p,pre,section,table,ul');\nvar pInlineTags = createMapFromString('a,audio,del,ins,map,noscript,video');\nvar rubyTags = createMapFromString('rb,rt,rtc,rp');\nvar rtcTag = createMapFromString('rb,rtc,rp');\nvar optionTag = createMapFromString('option,optgroup');\nvar tableContentTags = createMapFromString('tbody,tfoot');\nvar tableSectionTags = createMapFromString('thead,tbody,tfoot');\nvar cellTags = createMapFromString('td,th');\nvar topLevelTags = createMapFromString('html,head,body');\nvar compactTags = createMapFromString('html,body');\nvar looseTags = createMapFromString('head,colgroup,caption');\nvar trailingTags = createMapFromString('dt,thead');\nvar htmlTags = createMapFromString('a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,command,content,data,datalist,dd,del,details,dfn,dialog,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,image,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,multicol,nav,nobr,noembed,noframes,noscript,object,ol,optgroup,option,output,p,param,picture,plaintext,pre,progress,q,rb,rp,rt,rtc,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp');\n\nfunction canRemoveParentTag(optionalStartTag, tag) {\n  switch (optionalStartTag) {\n    case 'html':\n    case 'head':\n      return true;\n\n    case 'body':\n      return !headerTags(tag);\n\n    case 'colgroup':\n      return tag === 'col';\n\n    case 'tbody':\n      return tag === 'tr';\n  }\n\n  return false;\n}\n\nfunction isStartTagMandatory(optionalEndTag, tag) {\n  switch (tag) {\n    case 'colgroup':\n      return optionalEndTag === 'colgroup';\n\n    case 'tbody':\n      return tableSectionTags(optionalEndTag);\n  }\n\n  return false;\n}\n\nfunction canRemovePrecedingTag(optionalEndTag, tag) {\n  switch (optionalEndTag) {\n    case 'html':\n    case 'head':\n    case 'body':\n    case 'colgroup':\n    case 'caption':\n      return true;\n\n    case 'li':\n    case 'optgroup':\n    case 'tr':\n      return tag === optionalEndTag;\n\n    case 'dt':\n    case 'dd':\n      return descriptionTags(tag);\n\n    case 'p':\n      return pBlockTags(tag);\n\n    case 'rb':\n    case 'rt':\n    case 'rp':\n      return rubyTags(tag);\n\n    case 'rtc':\n      return rtcTag(tag);\n\n    case 'option':\n      return optionTag(tag);\n\n    case 'thead':\n    case 'tbody':\n      return tableContentTags(tag);\n\n    case 'tfoot':\n      return tag === 'tbody';\n\n    case 'td':\n    case 'th':\n      return cellTags(tag);\n  }\n\n  return false;\n}\n\nvar reEmptyAttribute = new RegExp('^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(' + '?:down|up|over|move|out)|key(?:press|down|up)))$');\n\nfunction canDeleteEmptyAttribute(tag, attrName, attrValue, options) {\n  var isValueEmpty = !attrValue || /^\\s*$/.test(attrValue);\n\n  if (!isValueEmpty) {\n    return false;\n  }\n\n  if (typeof options.removeEmptyAttributes === 'function') {\n    return options.removeEmptyAttributes(attrName, tag);\n  }\n\n  return tag === 'input' && attrName === 'value' || reEmptyAttribute.test(attrName);\n}\n\nfunction hasAttrName(name, attrs) {\n  for (var i = attrs.length - 1; i >= 0; i--) {\n    if (attrs[i].name === name) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction canRemoveElement(tag, attrs) {\n  switch (tag) {\n    case 'textarea':\n      return false;\n\n    case 'audio':\n    case 'script':\n    case 'video':\n      if (hasAttrName('src', attrs)) {\n        return false;\n      }\n\n      break;\n\n    case 'iframe':\n      if (hasAttrName('src', attrs) || hasAttrName('srcdoc', attrs)) {\n        return false;\n      }\n\n      break;\n\n    case 'object':\n      if (hasAttrName('data', attrs)) {\n        return false;\n      }\n\n      break;\n\n    case 'applet':\n      if (hasAttrName('code', attrs)) {\n        return false;\n      }\n\n      break;\n  }\n\n  return true;\n}\n\nfunction canCollapseWhitespace(tag) {\n  return !/^(?:script|style|pre|textarea)$/.test(tag);\n}\n\nfunction canTrimWhitespace(tag) {\n  return !/^(?:pre|textarea)$/.test(tag);\n}\n\nfunction normalizeAttr(attr, attrs, tag, options) {\n  var attrName = options.name(attr.name),\n      attrValue = attr.value;\n\n  if (options.decodeEntities && attrValue) {\n    attrValue = decode(attrValue, {\n      isAttributeValue: true\n    });\n  }\n\n  if (options.removeRedundantAttributes && isAttributeRedundant(tag, attrName, attrValue, attrs) || options.removeScriptTypeAttributes && tag === 'script' && attrName === 'type' && isScriptTypeAttribute(attrValue) && !keepScriptTypeAttribute(attrValue) || options.removeStyleLinkTypeAttributes && (tag === 'style' || tag === 'link') && attrName === 'type' && isStyleLinkTypeAttribute(attrValue)) {\n    return;\n  }\n\n  if (attrValue) {\n    attrValue = cleanAttributeValue(tag, attrName, attrValue, options, attrs);\n  }\n\n  if (options.removeEmptyAttributes && canDeleteEmptyAttribute(tag, attrName, attrValue, options)) {\n    return;\n  }\n\n  if (options.decodeEntities && attrValue) {\n    attrValue = attrValue.replace(/&(#?[0-9a-zA-Z]+;)/g, '&amp;$1');\n  }\n\n  return {\n    attr: attr,\n    name: attrName,\n    value: attrValue\n  };\n}\n\nfunction buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr) {\n  var attrName = normalized.name,\n      attrValue = normalized.value,\n      attr = normalized.attr,\n      attrQuote = attr.quote,\n      attrFragment,\n      emittedAttrValue;\n\n  if (typeof attrValue !== 'undefined' && (!options.removeAttributeQuotes || ~attrValue.indexOf(uidAttr) || !canRemoveAttributeQuotes(attrValue))) {\n    if (!options.preventAttributesEscaping) {\n      if (typeof options.quoteCharacter === 'undefined') {\n        var apos = (attrValue.match(/'/g) || []).length;\n        var quot = (attrValue.match(/\"/g) || []).length;\n        attrQuote = apos < quot ? '\\'' : '\"';\n      } else {\n        attrQuote = options.quoteCharacter === '\\'' ? '\\'' : '\"';\n      }\n\n      if (attrQuote === '\"') {\n        attrValue = attrValue.replace(/\"/g, '&#34;');\n      } else {\n        attrValue = attrValue.replace(/'/g, '&#39;');\n      }\n    }\n\n    emittedAttrValue = attrQuote + attrValue + attrQuote;\n\n    if (!isLast && !options.removeTagWhitespace) {\n      emittedAttrValue += ' ';\n    }\n  } // make sure trailing slash is not interpreted as HTML self-closing tag\n  else if (isLast && !hasUnarySlash && !/\\/$/.test(attrValue)) {\n      emittedAttrValue = attrValue;\n    } else {\n      emittedAttrValue = attrValue + ' ';\n    }\n\n  if (typeof attrValue === 'undefined' || options.collapseBooleanAttributes && isBooleanAttribute(attrName.toLowerCase(), attrValue.toLowerCase())) {\n    attrFragment = attrName;\n\n    if (!isLast) {\n      attrFragment += ' ';\n    }\n  } else {\n    attrFragment = attrName + attr.customAssign + emittedAttrValue;\n  }\n\n  return attr.customOpen + attrFragment + attr.customClose;\n}\n\nfunction identity(value) {\n  return value;\n}\n\nfunction processOptions(values) {\n  var options = {\n    name: function (name) {\n      return name.toLowerCase();\n    },\n    canCollapseWhitespace: canCollapseWhitespace,\n    canTrimWhitespace: canTrimWhitespace,\n    html5: true,\n    ignoreCustomComments: [/^!/, /^\\s*#/],\n    ignoreCustomFragments: [/<%[\\s\\S]*?%>/, /<\\?[\\s\\S]*?\\?>/],\n    includeAutoGeneratedTags: true,\n    log: identity,\n    minifyCSS: identity,\n    minifyJS: identity,\n    minifyURLs: identity\n  };\n  Object.keys(values).forEach(function (key) {\n    var value = values[key];\n\n    if (key === 'caseSensitive') {\n      if (value) {\n        options.name = identity;\n      }\n    } else if (key === 'log') {\n      if (typeof value === 'function') {\n        options.log = value;\n      }\n    } else if (key === 'minifyCSS' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n\n      if (typeof value !== 'object') {\n        value = {};\n      }\n\n      options.minifyCSS = function (text, type) {\n        text = text.replace(/(url\\s*\\(\\s*)(\"|'|)(.*?)\\2(\\s*\\))/ig, function (match, prefix, quote, url, suffix) {\n          return prefix + quote + options.minifyURLs(url) + quote + suffix;\n        });\n        var cleanCssOutput = new CleanCSS(value).minify(wrapCSS(text, type));\n\n        if (cleanCssOutput.errors.length > 0) {\n          cleanCssOutput.errors.forEach(options.log);\n          return text;\n        }\n\n        return unwrapCSS(cleanCssOutput.styles, type);\n      };\n    } else if (key === 'minifyJS' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n\n      if (typeof value !== 'object') {\n        value = {};\n      }\n\n      (value.parse || (value.parse = {})).bare_returns = false;\n\n      options.minifyJS = function (text, inline) {\n        var start = text.match(/^\\s*<!--.*/);\n        var code = start ? text.slice(start[0].length).replace(/\\n\\s*-->\\s*$/, '') : text;\n        value.parse.bare_returns = inline;\n        var result = Terser.minify(code, value);\n\n        if (result.error) {\n          options.log(result.error);\n          return text;\n        }\n\n        return result.code.replace(/;$/, '');\n      };\n    } else if (key === 'minifyURLs' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n\n      if (typeof value === 'string') {\n        value = {\n          site: value\n        };\n      } else if (typeof value !== 'object') {\n        value = {};\n      }\n\n      options.minifyURLs = function (text) {\n        try {\n          return RelateUrl.relate(text, value);\n        } catch (err) {\n          options.log(err);\n          return text;\n        }\n      };\n    } else {\n      options[key] = value;\n    }\n  });\n  return options;\n}\n\nfunction uniqueId(value) {\n  var id;\n\n  do {\n    id = Math.random().toString(36).replace(/^0\\.[0-9]*/, '');\n  } while (~value.indexOf(id));\n\n  return id;\n}\n\nvar specialContentTags = createMapFromString('script,style');\n\nfunction createSortFns(value, options, uidIgnore, uidAttr) {\n  var attrChains = options.sortAttributes && Object.create(null);\n  var classChain = options.sortClassName && new TokenChain();\n\n  function attrNames(attrs) {\n    return attrs.map(function (attr) {\n      return options.name(attr.name);\n    });\n  }\n\n  function shouldSkipUID(token, uid) {\n    return !uid || token.indexOf(uid) === -1;\n  }\n\n  function shouldSkipUIDs(token) {\n    return shouldSkipUID(token, uidIgnore) && shouldSkipUID(token, uidAttr);\n  }\n\n  function scan(input) {\n    var currentTag, currentType;\n    new HTMLParser(input, {\n      start: function (tag, attrs) {\n        if (attrChains) {\n          if (!attrChains[tag]) {\n            attrChains[tag] = new TokenChain();\n          }\n\n          attrChains[tag].add(attrNames(attrs).filter(shouldSkipUIDs));\n        }\n\n        for (var i = 0, len = attrs.length; i < len; i++) {\n          var attr = attrs[i];\n\n          if (classChain && attr.value && options.name(attr.name) === 'class') {\n            classChain.add(trimWhitespace(attr.value).split(/[ \\t\\n\\f\\r]+/).filter(shouldSkipUIDs));\n          } else if (options.processScripts && attr.name.toLowerCase() === 'type') {\n            currentTag = tag;\n            currentType = attr.value;\n          }\n        }\n      },\n      end: function () {\n        currentTag = '';\n      },\n      chars: function (text) {\n        if (options.processScripts && specialContentTags(currentTag) && options.processScripts.indexOf(currentType) > -1) {\n          scan(text);\n        }\n      }\n    });\n  }\n\n  var log = options.log;\n  options.log = identity;\n  options.sortAttributes = false;\n  options.sortClassName = false;\n  scan(minify(value, options));\n  options.log = log;\n\n  if (attrChains) {\n    var attrSorters = Object.create(null);\n\n    for (var tag in attrChains) {\n      attrSorters[tag] = attrChains[tag].createSorter();\n    }\n\n    options.sortAttributes = function (tag, attrs) {\n      var sorter = attrSorters[tag];\n\n      if (sorter) {\n        var attrMap = Object.create(null);\n        var names = attrNames(attrs);\n        names.forEach(function (name, index) {\n          (attrMap[name] || (attrMap[name] = [])).push(attrs[index]);\n        });\n        sorter.sort(names).forEach(function (name, index) {\n          attrs[index] = attrMap[name].shift();\n        });\n      }\n    };\n  }\n\n  if (classChain) {\n    var sorter = classChain.createSorter();\n\n    options.sortClassName = function (value) {\n      return sorter.sort(value.split(/[ \\n\\f\\r]+/)).join(' ');\n    };\n  }\n}\n\nfunction minify(value, options, partialMarkup) {\n  if (options.collapseWhitespace) {\n    value = collapseWhitespace(value, options, true, true);\n  }\n\n  var buffer = [],\n      charsPrevTag,\n      currentChars = '',\n      hasChars,\n      currentTag = '',\n      currentAttrs = [],\n      stackNoTrimWhitespace = [],\n      stackNoCollapseWhitespace = [],\n      optionalStartTag = '',\n      optionalEndTag = '',\n      ignoredMarkupChunks = [],\n      ignoredCustomMarkupChunks = [],\n      uidIgnore,\n      uidAttr,\n      uidPattern; // temporarily replace ignored chunks with comments,\n  // so that we don't have to worry what's there.\n  // for all we care there might be\n  // completely-horribly-broken-alien-non-html-emoj-cthulhu-filled content\n\n  value = value.replace(/<!-- htmlmin:ignore -->([\\s\\S]*?)<!-- htmlmin:ignore -->/g, function (match, group1) {\n    if (!uidIgnore) {\n      uidIgnore = uniqueId(value);\n      var pattern = new RegExp('^' + uidIgnore + '([0-9]+)$');\n\n      if (options.ignoreCustomComments) {\n        options.ignoreCustomComments = options.ignoreCustomComments.slice();\n      } else {\n        options.ignoreCustomComments = [];\n      }\n\n      options.ignoreCustomComments.push(pattern);\n    }\n\n    var token = '<!--' + uidIgnore + ignoredMarkupChunks.length + '-->';\n    ignoredMarkupChunks.push(group1);\n    return token;\n  });\n  var customFragments = options.ignoreCustomFragments.map(function (re) {\n    return re.source;\n  });\n\n  if (customFragments.length) {\n    var reCustomIgnore = new RegExp('\\\\s*(?:' + customFragments.join('|') + ')+\\\\s*', 'g'); // temporarily replace custom ignored fragments with unique attributes\n\n    value = value.replace(reCustomIgnore, function (match) {\n      if (!uidAttr) {\n        uidAttr = uniqueId(value);\n        uidPattern = new RegExp('(\\\\s*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\\\s*)', 'g');\n\n        if (options.minifyCSS) {\n          options.minifyCSS = function (fn) {\n            return function (text, type) {\n              text = text.replace(uidPattern, function (match, prefix, index) {\n                var chunks = ignoredCustomMarkupChunks[+index];\n                return chunks[1] + uidAttr + index + uidAttr + chunks[2];\n              });\n              var ids = [];\n              new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function (warning) {\n                var match = uidPattern.exec(warning);\n\n                if (match) {\n                  var id = uidAttr + match[2] + uidAttr;\n                  text = text.replace(id, ignoreCSS(id));\n                  ids.push(id);\n                }\n              });\n              text = fn(text, type);\n              ids.forEach(function (id) {\n                text = text.replace(ignoreCSS(id), id);\n              });\n              return text;\n            };\n          }(options.minifyCSS);\n        }\n\n        if (options.minifyJS) {\n          options.minifyJS = function (fn) {\n            return function (text, type) {\n              return fn(text.replace(uidPattern, function (match, prefix, index) {\n                var chunks = ignoredCustomMarkupChunks[+index];\n                return chunks[1] + uidAttr + index + uidAttr + chunks[2];\n              }), type);\n            };\n          }(options.minifyJS);\n        }\n      }\n\n      var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr;\n      ignoredCustomMarkupChunks.push(/^(\\s*)[\\s\\S]*?(\\s*)$/.exec(match));\n      return '\\t' + token + '\\t';\n    });\n  }\n\n  if (options.sortAttributes && typeof options.sortAttributes !== 'function' || options.sortClassName && typeof options.sortClassName !== 'function') {\n    createSortFns(value, options, uidIgnore, uidAttr);\n  }\n\n  function _canCollapseWhitespace(tag, attrs) {\n    return options.canCollapseWhitespace(tag, attrs, canCollapseWhitespace);\n  }\n\n  function _canTrimWhitespace(tag, attrs) {\n    return options.canTrimWhitespace(tag, attrs, canTrimWhitespace);\n  }\n\n  function removeStartTag() {\n    var index = buffer.length - 1;\n\n    while (index > 0 && !/^<[^/!]/.test(buffer[index])) {\n      index--;\n    }\n\n    buffer.length = Math.max(0, index);\n  }\n\n  function removeEndTag() {\n    var index = buffer.length - 1;\n\n    while (index > 0 && !/^<\\//.test(buffer[index])) {\n      index--;\n    }\n\n    buffer.length = Math.max(0, index);\n  } // look for trailing whitespaces, bypass any inline tags\n\n\n  function trimTrailingWhitespace(index, nextTag) {\n    for (var endTag = null; index >= 0 && _canTrimWhitespace(endTag); index--) {\n      var str = buffer[index];\n      var match = str.match(/^<\\/([\\w:-]+)>$/);\n\n      if (match) {\n        endTag = match[1];\n      } else if (/>$/.test(str) || (buffer[index] = collapseWhitespaceSmart(str, null, nextTag, options))) {\n        break;\n      }\n    }\n  } // look for trailing whitespaces from previously processed text\n  // which may not be trimmed due to a following comment or an empty\n  // element which has now been removed\n\n\n  function squashTrailingWhitespace(nextTag) {\n    var charsIndex = buffer.length - 1;\n\n    if (buffer.length > 1) {\n      var item = buffer[buffer.length - 1];\n\n      if (/^(?:<!|$)/.test(item) && item.indexOf(uidIgnore) === -1) {\n        charsIndex--;\n      }\n    }\n\n    trimTrailingWhitespace(charsIndex, nextTag);\n  }\n\n  new HTMLParser(value, {\n    partialMarkup: partialMarkup,\n    continueOnParseError: options.continueOnParseError,\n    customAttrAssign: options.customAttrAssign,\n    customAttrSurround: options.customAttrSurround,\n    html5: options.html5,\n    start: function (tag, attrs, unary, unarySlash, autoGenerated) {\n      if (tag.toLowerCase() === 'svg') {\n        options = Object.create(options);\n        options.caseSensitive = true;\n        options.keepClosingSlash = true;\n        options.name = identity;\n      }\n\n      tag = options.name(tag);\n      currentTag = tag;\n      charsPrevTag = tag;\n\n      if (!inlineTextTags(tag)) {\n        currentChars = '';\n      }\n\n      hasChars = false;\n      currentAttrs = attrs;\n      var optional = options.removeOptionalTags;\n\n      if (optional) {\n        var htmlTag = htmlTags(tag); // <html> may be omitted if first thing inside is not comment\n        // <head> may be omitted if first thing inside is an element\n        // <body> may be omitted if first thing inside is not space, comment, <meta>, <link>, <script>, <style> or <template>\n        // <colgroup> may be omitted if first thing inside is <col>\n        // <tbody> may be omitted if first thing inside is <tr>\n\n        if (htmlTag && canRemoveParentTag(optionalStartTag, tag)) {\n          removeStartTag();\n        }\n\n        optionalStartTag = ''; // end-tag-followed-by-start-tag omission rules\n\n        if (htmlTag && canRemovePrecedingTag(optionalEndTag, tag)) {\n          removeEndTag(); // <colgroup> cannot be omitted if preceding </colgroup> is omitted\n          // <tbody> cannot be omitted if preceding </tbody>, </thead> or </tfoot> is omitted\n\n          optional = !isStartTagMandatory(optionalEndTag, tag);\n        }\n\n        optionalEndTag = '';\n      } // set whitespace flags for nested tags (eg. <code> within a <pre>)\n\n\n      if (options.collapseWhitespace) {\n        if (!stackNoTrimWhitespace.length) {\n          squashTrailingWhitespace(tag);\n        }\n\n        if (!unary) {\n          if (!_canTrimWhitespace(tag, attrs) || stackNoTrimWhitespace.length) {\n            stackNoTrimWhitespace.push(tag);\n          }\n\n          if (!_canCollapseWhitespace(tag, attrs) || stackNoCollapseWhitespace.length) {\n            stackNoCollapseWhitespace.push(tag);\n          }\n        }\n      }\n\n      var openTag = '<' + tag;\n      var hasUnarySlash = unarySlash && options.keepClosingSlash;\n      buffer.push(openTag);\n\n      if (options.sortAttributes) {\n        options.sortAttributes(tag, attrs);\n      }\n\n      var parts = [];\n\n      for (var i = attrs.length, isLast = true; --i >= 0;) {\n        var normalized = normalizeAttr(attrs[i], attrs, tag, options);\n\n        if (normalized) {\n          parts.unshift(buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr));\n          isLast = false;\n        }\n      }\n\n      if (parts.length > 0) {\n        buffer.push(' ');\n        buffer.push.apply(buffer, parts);\n      } // start tag must never be omitted if it has any attributes\n      else if (optional && optionalStartTags(tag)) {\n          optionalStartTag = tag;\n        }\n\n      buffer.push(buffer.pop() + (hasUnarySlash ? '/' : '') + '>');\n\n      if (autoGenerated && !options.includeAutoGeneratedTags) {\n        removeStartTag();\n        optionalStartTag = '';\n      }\n    },\n    end: function (tag, attrs, autoGenerated) {\n      if (tag.toLowerCase() === 'svg') {\n        options = Object.getPrototypeOf(options);\n      }\n\n      tag = options.name(tag); // check if current tag is in a whitespace stack\n\n      if (options.collapseWhitespace) {\n        if (stackNoTrimWhitespace.length) {\n          if (tag === stackNoTrimWhitespace[stackNoTrimWhitespace.length - 1]) {\n            stackNoTrimWhitespace.pop();\n          }\n        } else {\n          squashTrailingWhitespace('/' + tag);\n        }\n\n        if (stackNoCollapseWhitespace.length && tag === stackNoCollapseWhitespace[stackNoCollapseWhitespace.length - 1]) {\n          stackNoCollapseWhitespace.pop();\n        }\n      }\n\n      var isElementEmpty = false;\n\n      if (tag === currentTag) {\n        currentTag = '';\n        isElementEmpty = !hasChars;\n      }\n\n      if (options.removeOptionalTags) {\n        // <html>, <head> or <body> may be omitted if the element is empty\n        if (isElementEmpty && topLevelTags(optionalStartTag)) {\n          removeStartTag();\n        }\n\n        optionalStartTag = ''; // </html> or </body> may be omitted if not followed by comment\n        // </head> may be omitted if not followed by space or comment\n        // </p> may be omitted if no more content in non-</a> parent\n        // except for </dt> or </thead>, end tags may be omitted if no more content in parent element\n\n        if (htmlTags(tag) && optionalEndTag && !trailingTags(optionalEndTag) && (optionalEndTag !== 'p' || !pInlineTags(tag))) {\n          removeEndTag();\n        }\n\n        optionalEndTag = optionalEndTags(tag) ? tag : '';\n      }\n\n      if (options.removeEmptyElements && isElementEmpty && canRemoveElement(tag, attrs)) {\n        // remove last \"element\" from buffer\n        removeStartTag();\n        optionalStartTag = '';\n        optionalEndTag = '';\n      } else {\n        if (autoGenerated && !options.includeAutoGeneratedTags) {\n          optionalEndTag = '';\n        } else {\n          buffer.push('</' + tag + '>');\n        }\n\n        charsPrevTag = '/' + tag;\n\n        if (!inlineTags(tag)) {\n          currentChars = '';\n        } else if (isElementEmpty) {\n          currentChars += '|';\n        }\n      }\n    },\n    chars: function (text, prevTag, nextTag) {\n      prevTag = prevTag === '' ? 'comment' : prevTag;\n      nextTag = nextTag === '' ? 'comment' : nextTag;\n\n      if (options.decodeEntities && text && !specialContentTags(currentTag)) {\n        text = decode(text);\n      }\n\n      if (options.collapseWhitespace) {\n        if (!stackNoTrimWhitespace.length) {\n          if (prevTag === 'comment') {\n            var prevComment = buffer[buffer.length - 1];\n\n            if (prevComment.indexOf(uidIgnore) === -1) {\n              if (!prevComment) {\n                prevTag = charsPrevTag;\n              }\n\n              if (buffer.length > 1 && (!prevComment || !options.conservativeCollapse && / $/.test(currentChars))) {\n                var charsIndex = buffer.length - 2;\n                buffer[charsIndex] = buffer[charsIndex].replace(/\\s+$/, function (trailingSpaces) {\n                  text = trailingSpaces + text;\n                  return '';\n                });\n              }\n            }\n          }\n\n          if (prevTag) {\n            if (prevTag === '/nobr' || prevTag === 'wbr') {\n              if (/^\\s/.test(text)) {\n                var tagIndex = buffer.length - 1;\n\n                while (tagIndex > 0 && buffer[tagIndex].lastIndexOf('<' + prevTag) !== 0) {\n                  tagIndex--;\n                }\n\n                trimTrailingWhitespace(tagIndex - 1, 'br');\n              }\n            } else if (inlineTextTags(prevTag.charAt(0) === '/' ? prevTag.slice(1) : prevTag)) {\n              text = collapseWhitespace(text, options, /(?:^|\\s)$/.test(currentChars));\n            }\n          }\n\n          if (prevTag || nextTag) {\n            text = collapseWhitespaceSmart(text, prevTag, nextTag, options);\n          } else {\n            text = collapseWhitespace(text, options, true, true);\n          }\n\n          if (!text && /\\s$/.test(currentChars) && prevTag && prevTag.charAt(0) === '/') {\n            trimTrailingWhitespace(buffer.length - 1, nextTag);\n          }\n        }\n\n        if (!stackNoCollapseWhitespace.length && nextTag !== 'html' && !(prevTag && nextTag)) {\n          text = collapseWhitespace(text, options, false, false, true);\n        }\n      }\n\n      if (options.processScripts && specialContentTags(currentTag)) {\n        text = processScript(text, options, currentAttrs);\n      }\n\n      if (isExecutableScript(currentTag, currentAttrs)) {\n        text = options.minifyJS(text);\n      }\n\n      if (isStyleSheet(currentTag, currentAttrs)) {\n        text = options.minifyCSS(text);\n      }\n\n      if (options.removeOptionalTags && text) {\n        // <html> may be omitted if first thing inside is not comment\n        // <body> may be omitted if first thing inside is not space, comment, <meta>, <link>, <script>, <style> or <template>\n        if (optionalStartTag === 'html' || optionalStartTag === 'body' && !/^\\s/.test(text)) {\n          removeStartTag();\n        }\n\n        optionalStartTag = ''; // </html> or </body> may be omitted if not followed by comment\n        // </head>, </colgroup> or </caption> may be omitted if not followed by space or comment\n\n        if (compactTags(optionalEndTag) || looseTags(optionalEndTag) && !/^\\s/.test(text)) {\n          removeEndTag();\n        }\n\n        optionalEndTag = '';\n      }\n\n      charsPrevTag = /^\\s*$/.test(text) ? prevTag : 'comment';\n\n      if (options.decodeEntities && text && !specialContentTags(currentTag)) {\n        // Escape any `&` symbols that start either:\n        // 1) a legacy named character reference (i.e. one that doesn't end with `;`)\n        // 2) or any other character reference (i.e. one that does end with `;`)\n        // Note that `&` can be escaped as `&amp`, without the semi-colon.\n        // https://mathiasbynens.be/notes/ambiguous-ampersands\n        text = text.replace(/&((?:Iacute|aacute|uacute|plusmn|Otilde|otilde|agrave|Agrave|Yacute|yacute|Oslash|oslash|atilde|Atilde|brvbar|ccedil|Ccedil|Ograve|curren|divide|eacute|Eacute|ograve|Oacute|egrave|Egrave|Ugrave|frac12|frac14|frac34|ugrave|oacute|iacute|Ntilde|ntilde|Uacute|middot|igrave|Igrave|iquest|Aacute|cedil|laquo|micro|iexcl|Icirc|icirc|acirc|Ucirc|Ecirc|ocirc|Ocirc|ecirc|ucirc|Aring|aring|AElig|aelig|acute|pound|raquo|Acirc|times|THORN|szlig|thorn|COPY|auml|ordf|ordm|Uuml|macr|uuml|Auml|ouml|Ouml|para|nbsp|euml|quot|QUOT|Euml|yuml|cent|sect|copy|sup1|sup2|sup3|iuml|Iuml|ETH|shy|reg|not|yen|amp|AMP|REG|uml|eth|deg|gt|GT|LT|lt)(?!;)|(?:#?[0-9a-zA-Z]+;))/g, '&amp$1').replace(/</g, '&lt;');\n      }\n\n      if (uidPattern && options.collapseWhitespace && stackNoTrimWhitespace.length) {\n        text = text.replace(uidPattern, function (match, prefix, index) {\n          return ignoredCustomMarkupChunks[+index][0];\n        });\n      }\n\n      currentChars += text;\n\n      if (text) {\n        hasChars = true;\n      }\n\n      buffer.push(text);\n    },\n    comment: function (text, nonStandard) {\n      var prefix = nonStandard ? '<!' : '<!--';\n      var suffix = nonStandard ? '>' : '-->';\n\n      if (isConditionalComment(text)) {\n        text = prefix + cleanConditionalComment(text, options) + suffix;\n      } else if (options.removeComments) {\n        if (isIgnoredComment(text, options)) {\n          text = '<!--' + text + '-->';\n        } else {\n          text = '';\n        }\n      } else {\n        text = prefix + text + suffix;\n      }\n\n      if (options.removeOptionalTags && text) {\n        // preceding comments suppress tag omissions\n        optionalStartTag = '';\n        optionalEndTag = '';\n      }\n\n      buffer.push(text);\n    },\n    doctype: function (doctype) {\n      buffer.push(options.useShortDoctype ? '<!doctype' + (options.removeTagWhitespace ? '' : ' ') + 'html>' : collapseWhitespaceAll(doctype));\n    }\n  });\n\n  if (options.removeOptionalTags) {\n    // <html> may be omitted if first thing inside is not comment\n    // <head> or <body> may be omitted if empty\n    if (topLevelTags(optionalStartTag)) {\n      removeStartTag();\n    } // except for </dt> or </thead>, end tags may be omitted if no more content in parent element\n\n\n    if (optionalEndTag && !trailingTags(optionalEndTag)) {\n      removeEndTag();\n    }\n  }\n\n  if (options.collapseWhitespace) {\n    squashTrailingWhitespace('br');\n  }\n\n  return joinResultSegments(buffer, options, uidPattern ? function (str) {\n    return str.replace(uidPattern, function (match, prefix, index, suffix) {\n      var chunk = ignoredCustomMarkupChunks[+index][0];\n\n      if (options.collapseWhitespace) {\n        if (prefix !== '\\t') {\n          chunk = prefix + chunk;\n        }\n\n        if (suffix !== '\\t') {\n          chunk += suffix;\n        }\n\n        return collapseWhitespace(chunk, {\n          preserveLineBreaks: options.preserveLineBreaks,\n          conservativeCollapse: !options.trimCustomFragments\n        }, /^[ \\n\\r\\t\\f]/.test(chunk), /[ \\n\\r\\t\\f]$/.test(chunk));\n      }\n\n      return chunk;\n    });\n  } : identity, uidIgnore ? function (str) {\n    return str.replace(new RegExp('<!--' + uidIgnore + '([0-9]+)-->', 'g'), function (match, index) {\n      return ignoredMarkupChunks[+index];\n    });\n  } : identity);\n}\n\nfunction joinResultSegments(results, options, restoreCustom, restoreIgnore) {\n  var str;\n  var maxLineLength = options.maxLineLength;\n\n  if (maxLineLength) {\n    var line = '',\n        lines = [];\n\n    while (results.length) {\n      var len = line.length;\n      var end = results[0].indexOf('\\n');\n\n      if (end < 0) {\n        line += restoreIgnore(restoreCustom(results.shift()));\n      } else {\n        line += restoreIgnore(restoreCustom(results[0].slice(0, end)));\n        results[0] = results[0].slice(end + 1);\n      }\n\n      if (len > 0 && line.length > maxLineLength) {\n        lines.push(line.slice(0, len));\n        line = line.slice(len);\n      } else if (end >= 0) {\n        lines.push(line);\n        line = '';\n      }\n    }\n\n    if (line) {\n      lines.push(line);\n    }\n\n    str = lines.join('\\n');\n  } else {\n    str = restoreIgnore(restoreCustom(results.join('')));\n  }\n\n  return options.collapseWhitespace ? collapseWhitespace(str, options, true, true) : str;\n}\n\nexports.minify = function (value, options) {\n  var start = Date.now();\n  options = processOptions(options || {});\n  var result = minify(value, options);\n  options.log('minified in: ' + (Date.now() - start) + 'ms');\n  return result;\n};","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/html-minifier-terser/src/htmlminifier.js"],"names":["CleanCSS","require","decode","HTMLParser","RelateUrl","TokenChain","Terser","utils","trimWhitespace","str","replace","collapseWhitespaceAll","spaces","collapseWhitespace","options","trimLeft","trimRight","collapseAll","lineBreakBefore","lineBreakAfter","preserveLineBreaks","conservative","conservativeCollapse","createMapFromString","inlineTags","inlineTextTags","selfClosingInlineTags","collapseWhitespaceSmart","prevTag","nextTag","collapseInlineTagWhitespace","charAt","slice","isConditionalComment","text","test","isIgnoredComment","i","len","ignoreCustomComments","length","isEventAttribute","attrName","patterns","customEventAttributes","canRemoveAttributeQuotes","value","attributesInclude","attributes","attribute","name","toLowerCase","isAttributeRedundant","tag","attrValue","attrs","executableScriptsMimetypes","createMap","keepScriptsMimetypes","isScriptTypeAttribute","split","keepScriptTypeAttribute","isExecutableScript","isStyleLinkTypeAttribute","isStyleSheet","isSimpleBoolean","isBooleanValue","isBooleanAttribute","isUriTypeAttribute","isNumberTypeAttribute","isLinkType","isMediaQuery","srcsetTags","isSrcset","cleanAttributeValue","minifyJS","sortClassName","minifyURLs","minifyCSS","map","candidate","url","descriptor","match","num","suffix","join","isMetaViewport","numString","toString","isContentSecurityPolicy","customAttrCollapse","ignoreCSS","id","wrapCSS","type","unwrapCSS","matches","cleanConditionalComment","comment","processConditionalComments","prefix","minify","processScript","currentAttrs","processScripts","indexOf","optionalStartTags","optionalEndTags","headerTags","descriptionTags","pBlockTags","pInlineTags","rubyTags","rtcTag","optionTag","tableContentTags","tableSectionTags","cellTags","topLevelTags","compactTags","looseTags","trailingTags","htmlTags","canRemoveParentTag","optionalStartTag","isStartTagMandatory","optionalEndTag","canRemovePrecedingTag","reEmptyAttribute","RegExp","canDeleteEmptyAttribute","isValueEmpty","removeEmptyAttributes","hasAttrName","canRemoveElement","canCollapseWhitespace","canTrimWhitespace","normalizeAttr","attr","decodeEntities","isAttributeValue","removeRedundantAttributes","removeScriptTypeAttributes","removeStyleLinkTypeAttributes","buildAttr","normalized","hasUnarySlash","isLast","uidAttr","attrQuote","quote","attrFragment","emittedAttrValue","removeAttributeQuotes","preventAttributesEscaping","quoteCharacter","apos","quot","removeTagWhitespace","collapseBooleanAttributes","customAssign","customOpen","customClose","identity","processOptions","values","html5","ignoreCustomFragments","includeAutoGeneratedTags","log","Object","keys","forEach","key","cleanCssOutput","errors","styles","parse","bare_returns","inline","start","code","result","error","site","relate","err","uniqueId","Math","random","specialContentTags","createSortFns","uidIgnore","attrChains","sortAttributes","create","classChain","attrNames","shouldSkipUID","token","uid","shouldSkipUIDs","scan","input","currentTag","currentType","add","filter","end","chars","attrSorters","createSorter","sorter","attrMap","names","index","push","sort","shift","partialMarkup","buffer","charsPrevTag","currentChars","hasChars","stackNoTrimWhitespace","stackNoCollapseWhitespace","ignoredMarkupChunks","ignoredCustomMarkupChunks","uidPattern","group1","pattern","customFragments","re","source","reCustomIgnore","fn","chunks","ids","warnings","warning","exec","_canCollapseWhitespace","_canTrimWhitespace","removeStartTag","max","removeEndTag","trimTrailingWhitespace","endTag","squashTrailingWhitespace","charsIndex","item","continueOnParseError","customAttrAssign","customAttrSurround","unary","unarySlash","autoGenerated","caseSensitive","keepClosingSlash","optional","removeOptionalTags","htmlTag","openTag","parts","unshift","apply","pop","getPrototypeOf","isElementEmpty","removeEmptyElements","prevComment","trailingSpaces","tagIndex","lastIndexOf","nonStandard","removeComments","doctype","useShortDoctype","joinResultSegments","chunk","trimCustomFragments","results","restoreCustom","restoreIgnore","maxLineLength","line","lines","exports","Date","now"],"mappings":"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","sourcesContent":["'use strict';\n\nvar CleanCSS = require('clean-css');\nvar decode = require('he').decode;\nvar HTMLParser = require('./htmlparser').HTMLParser;\nvar RelateUrl = require('relateurl');\nvar TokenChain = require('./tokenchain');\nvar Terser = require('terser');\nvar utils = require('./utils');\n\nfunction trimWhitespace(str) {\n  return str && str.replace(/^[ \\n\\r\\t\\f]+/, '').replace(/[ \\n\\r\\t\\f]+$/, '');\n}\n\nfunction collapseWhitespaceAll(str) {\n  // Non-breaking space is specifically handled inside the replacer function here:\n  return str && str.replace(/[ \\n\\r\\t\\f\\xA0]+/g, function(spaces) {\n    return spaces === '\\t' ? '\\t' : spaces.replace(/(^|\\xA0+)[^\\xA0]+/g, '$1 ');\n  });\n}\n\nfunction collapseWhitespace(str, options, trimLeft, trimRight, collapseAll) {\n  var lineBreakBefore = '', lineBreakAfter = '';\n\n  if (options.preserveLineBreaks) {\n    str = str.replace(/^[ \\n\\r\\t\\f]*?[\\n\\r][ \\n\\r\\t\\f]*/, function() {\n      lineBreakBefore = '\\n';\n      return '';\n    }).replace(/[ \\n\\r\\t\\f]*?[\\n\\r][ \\n\\r\\t\\f]*$/, function() {\n      lineBreakAfter = '\\n';\n      return '';\n    });\n  }\n\n  if (trimLeft) {\n    // Non-breaking space is specifically handled inside the replacer function here:\n    str = str.replace(/^[ \\n\\r\\t\\f\\xA0]+/, function(spaces) {\n      var conservative = !lineBreakBefore && options.conservativeCollapse;\n      if (conservative && spaces === '\\t') {\n        return '\\t';\n      }\n      return spaces.replace(/^[^\\xA0]+/, '').replace(/(\\xA0+)[^\\xA0]+/g, '$1 ') || (conservative ? ' ' : '');\n    });\n  }\n\n  if (trimRight) {\n    // Non-breaking space is specifically handled inside the replacer function here:\n    str = str.replace(/[ \\n\\r\\t\\f\\xA0]+$/, function(spaces) {\n      var conservative = !lineBreakAfter && options.conservativeCollapse;\n      if (conservative && spaces === '\\t') {\n        return '\\t';\n      }\n      return spaces.replace(/[^\\xA0]+(\\xA0+)/g, ' $1').replace(/[^\\xA0]+$/, '') || (conservative ? ' ' : '');\n    });\n  }\n\n  if (collapseAll) {\n    // strip non space whitespace then compress spaces to one\n    str = collapseWhitespaceAll(str);\n  }\n\n  return lineBreakBefore + str + lineBreakAfter;\n}\n\nvar createMapFromString = utils.createMapFromString;\n// non-empty tags that will maintain whitespace around them\nvar inlineTags = createMapFromString('a,abbr,acronym,b,bdi,bdo,big,button,cite,code,del,dfn,em,font,i,ins,kbd,label,mark,math,nobr,object,q,rp,rt,rtc,ruby,s,samp,select,small,span,strike,strong,sub,sup,svg,textarea,time,tt,u,var');\n// non-empty tags that will maintain whitespace within them\nvar inlineTextTags = createMapFromString('a,abbr,acronym,b,big,del,em,font,i,ins,kbd,mark,nobr,rp,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var');\n// self-closing tags that will maintain whitespace around them\nvar selfClosingInlineTags = createMapFromString('comment,img,input,wbr');\n\nfunction collapseWhitespaceSmart(str, prevTag, nextTag, options) {\n  var trimLeft = prevTag && !selfClosingInlineTags(prevTag);\n  if (trimLeft && !options.collapseInlineTagWhitespace) {\n    trimLeft = prevTag.charAt(0) === '/' ? !inlineTags(prevTag.slice(1)) : !inlineTextTags(prevTag);\n  }\n  var trimRight = nextTag && !selfClosingInlineTags(nextTag);\n  if (trimRight && !options.collapseInlineTagWhitespace) {\n    trimRight = nextTag.charAt(0) === '/' ? !inlineTextTags(nextTag.slice(1)) : !inlineTags(nextTag);\n  }\n  return collapseWhitespace(str, options, trimLeft, trimRight, prevTag && nextTag);\n}\n\nfunction isConditionalComment(text) {\n  return /^\\[if\\s[^\\]]+]|\\[endif]$/.test(text);\n}\n\nfunction isIgnoredComment(text, options) {\n  for (var i = 0, len = options.ignoreCustomComments.length; i < len; i++) {\n    if (options.ignoreCustomComments[i].test(text)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isEventAttribute(attrName, options) {\n  var patterns = options.customEventAttributes;\n  if (patterns) {\n    for (var i = patterns.length; i--;) {\n      if (patterns[i].test(attrName)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  return /^on[a-z]{3,}$/.test(attrName);\n}\n\nfunction canRemoveAttributeQuotes(value) {\n  // https://mathiasbynens.be/notes/unquoted-attribute-values\n  return /^[^ \\t\\n\\f\\r\"'`=<>]+$/.test(value);\n}\n\nfunction attributesInclude(attributes, attribute) {\n  for (var i = attributes.length; i--;) {\n    if (attributes[i].name.toLowerCase() === attribute) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isAttributeRedundant(tag, attrName, attrValue, attrs) {\n  attrValue = attrValue ? trimWhitespace(attrValue.toLowerCase()) : '';\n\n  return (\n    tag === 'script' &&\n    attrName === 'language' &&\n    attrValue === 'javascript' ||\n\n    tag === 'form' &&\n    attrName === 'method' &&\n    attrValue === 'get' ||\n\n    tag === 'input' &&\n    attrName === 'type' &&\n    attrValue === 'text' ||\n\n    tag === 'script' &&\n    attrName === 'charset' &&\n    !attributesInclude(attrs, 'src') ||\n\n    tag === 'a' &&\n    attrName === 'name' &&\n    attributesInclude(attrs, 'id') ||\n\n    tag === 'area' &&\n    attrName === 'shape' &&\n    attrValue === 'rect'\n  );\n}\n\n// https://mathiasbynens.be/demo/javascript-mime-type\n// https://developer.mozilla.org/en/docs/Web/HTML/Element/script#attr-type\nvar executableScriptsMimetypes = utils.createMap([\n  'text/javascript',\n  'text/ecmascript',\n  'text/jscript',\n  'application/javascript',\n  'application/x-javascript',\n  'application/ecmascript',\n  'module'\n]);\n\nvar keepScriptsMimetypes = utils.createMap([\n  'module'\n]);\n\nfunction isScriptTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase();\n  return attrValue === '' || executableScriptsMimetypes(attrValue);\n}\n\nfunction keepScriptTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase();\n  return keepScriptsMimetypes(attrValue);\n}\n\nfunction isExecutableScript(tag, attrs) {\n  if (tag !== 'script') {\n    return false;\n  }\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    var attrName = attrs[i].name.toLowerCase();\n    if (attrName === 'type') {\n      return isScriptTypeAttribute(attrs[i].value);\n    }\n  }\n  return true;\n}\n\nfunction isStyleLinkTypeAttribute(attrValue) {\n  attrValue = trimWhitespace(attrValue).toLowerCase();\n  return attrValue === '' || attrValue === 'text/css';\n}\n\nfunction isStyleSheet(tag, attrs) {\n  if (tag !== 'style') {\n    return false;\n  }\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    var attrName = attrs[i].name.toLowerCase();\n    if (attrName === 'type') {\n      return isStyleLinkTypeAttribute(attrs[i].value);\n    }\n  }\n  return true;\n}\n\nvar isSimpleBoolean = createMapFromString('allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible');\nvar isBooleanValue = createMapFromString('true,false');\n\nfunction isBooleanAttribute(attrName, attrValue) {\n  return isSimpleBoolean(attrName) || attrName === 'draggable' && !isBooleanValue(attrValue);\n}\n\nfunction isUriTypeAttribute(attrName, tag) {\n  return (\n    /^(?:a|area|link|base)$/.test(tag) && attrName === 'href' ||\n    tag === 'img' && /^(?:src|longdesc|usemap)$/.test(attrName) ||\n    tag === 'object' && /^(?:classid|codebase|data|usemap)$/.test(attrName) ||\n    tag === 'q' && attrName === 'cite' ||\n    tag === 'blockquote' && attrName === 'cite' ||\n    (tag === 'ins' || tag === 'del') && attrName === 'cite' ||\n    tag === 'form' && attrName === 'action' ||\n    tag === 'input' && (attrName === 'src' || attrName === 'usemap') ||\n    tag === 'head' && attrName === 'profile' ||\n    tag === 'script' && (attrName === 'src' || attrName === 'for')\n  );\n}\n\nfunction isNumberTypeAttribute(attrName, tag) {\n  return (\n    /^(?:a|area|object|button)$/.test(tag) && attrName === 'tabindex' ||\n    tag === 'input' && (attrName === 'maxlength' || attrName === 'tabindex') ||\n    tag === 'select' && (attrName === 'size' || attrName === 'tabindex') ||\n    tag === 'textarea' && /^(?:rows|cols|tabindex)$/.test(attrName) ||\n    tag === 'colgroup' && attrName === 'span' ||\n    tag === 'col' && attrName === 'span' ||\n    (tag === 'th' || tag === 'td') && (attrName === 'rowspan' || attrName === 'colspan')\n  );\n}\n\nfunction isLinkType(tag, attrs, value) {\n  if (tag !== 'link') {\n    return false;\n  }\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name === 'rel' && attrs[i].value === value) {\n      return true;\n    }\n  }\n}\n\nfunction isMediaQuery(tag, attrs, attrName) {\n  return attrName === 'media' && (isLinkType(tag, attrs, 'stylesheet') || isStyleSheet(tag, attrs));\n}\n\nvar srcsetTags = createMapFromString('img,source');\n\nfunction isSrcset(attrName, tag) {\n  return attrName === 'srcset' && srcsetTags(tag);\n}\n\nfunction cleanAttributeValue(tag, attrName, attrValue, options, attrs) {\n  if (isEventAttribute(attrName, options)) {\n    attrValue = trimWhitespace(attrValue).replace(/^javascript:\\s*/i, '');\n    return options.minifyJS(attrValue, true);\n  }\n  else if (attrName === 'class') {\n    attrValue = trimWhitespace(attrValue);\n    if (options.sortClassName) {\n      attrValue = options.sortClassName(attrValue);\n    }\n    else {\n      attrValue = collapseWhitespaceAll(attrValue);\n    }\n    return attrValue;\n  }\n  else if (isUriTypeAttribute(attrName, tag)) {\n    attrValue = trimWhitespace(attrValue);\n    return isLinkType(tag, attrs, 'canonical') ? attrValue : options.minifyURLs(attrValue);\n  }\n  else if (isNumberTypeAttribute(attrName, tag)) {\n    return trimWhitespace(attrValue);\n  }\n  else if (attrName === 'style') {\n    attrValue = trimWhitespace(attrValue);\n    if (attrValue) {\n      if (/;$/.test(attrValue) && !/&#?[0-9a-zA-Z]+;$/.test(attrValue)) {\n        attrValue = attrValue.replace(/\\s*;$/, ';');\n      }\n      attrValue = options.minifyCSS(attrValue, 'inline');\n    }\n    return attrValue;\n  }\n  else if (isSrcset(attrName, tag)) {\n    // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-srcset\n    attrValue = trimWhitespace(attrValue).split(/\\s+,\\s*|\\s*,\\s+/).map(function(candidate) {\n      var url = candidate;\n      var descriptor = '';\n      var match = candidate.match(/\\s+([1-9][0-9]*w|[0-9]+(?:\\.[0-9]+)?x)$/);\n      if (match) {\n        url = url.slice(0, -match[0].length);\n        var num = +match[1].slice(0, -1);\n        var suffix = match[1].slice(-1);\n        if (num !== 1 || suffix !== 'x') {\n          descriptor = ' ' + num + suffix;\n        }\n      }\n      return options.minifyURLs(url) + descriptor;\n    }).join(', ');\n  }\n  else if (isMetaViewport(tag, attrs) && attrName === 'content') {\n    attrValue = attrValue.replace(/\\s+/g, '').replace(/[0-9]+\\.[0-9]+/g, function(numString) {\n      // \"0.90000\" -> \"0.9\"\n      // \"1.0\" -> \"1\"\n      // \"1.0001\" -> \"1.0001\" (unchanged)\n      return (+numString).toString();\n    });\n  }\n  else if (isContentSecurityPolicy(tag, attrs) && attrName.toLowerCase() === 'content') {\n    return collapseWhitespaceAll(attrValue);\n  }\n  else if (options.customAttrCollapse && options.customAttrCollapse.test(attrName)) {\n    attrValue = attrValue.replace(/\\n+|\\r+|\\s{2,}/g, '');\n  }\n  else if (tag === 'script' && attrName === 'type') {\n    attrValue = trimWhitespace(attrValue.replace(/\\s*;\\s*/g, ';'));\n  }\n  else if (isMediaQuery(tag, attrs, attrName)) {\n    attrValue = trimWhitespace(attrValue);\n    return options.minifyCSS(attrValue, 'media');\n  }\n  return attrValue;\n}\n\nfunction isMetaViewport(tag, attrs) {\n  if (tag !== 'meta') {\n    return false;\n  }\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name === 'name' && attrs[i].value === 'viewport') {\n      return true;\n    }\n  }\n}\n\nfunction isContentSecurityPolicy(tag, attrs) {\n  if (tag !== 'meta') {\n    return false;\n  }\n  for (var i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i].name.toLowerCase() === 'http-equiv' && attrs[i].value.toLowerCase() === 'content-security-policy') {\n      return true;\n    }\n  }\n}\n\nfunction ignoreCSS(id) {\n  return '/* clean-css ignore:start */' + id + '/* clean-css ignore:end */';\n}\n\n// Wrap CSS declarations for CleanCSS > 3.x\n// See https://github.com/jakubpawlowicz/clean-css/issues/418\nfunction wrapCSS(text, type) {\n  switch (type) {\n    case 'inline':\n      return '*{' + text + '}';\n    case 'media':\n      return '@media ' + text + '{a{top:0}}';\n    default:\n      return text;\n  }\n}\n\nfunction unwrapCSS(text, type) {\n  var matches;\n  switch (type) {\n    case 'inline':\n      matches = text.match(/^\\*\\{([\\s\\S]*)\\}$/);\n      break;\n    case 'media':\n      matches = text.match(/^@media ([\\s\\S]*?)\\s*{[\\s\\S]*}$/);\n      break;\n  }\n  return matches ? matches[1] : text;\n}\n\nfunction cleanConditionalComment(comment, options) {\n  return options.processConditionalComments ? comment.replace(/^(\\[if\\s[^\\]]+]>)([\\s\\S]*?)(<!\\[endif])$/, function(match, prefix, text, suffix) {\n    return prefix + minify(text, options, true) + suffix;\n  }) : comment;\n}\n\nfunction processScript(text, options, currentAttrs) {\n  for (var i = 0, len = currentAttrs.length; i < len; i++) {\n    if (currentAttrs[i].name.toLowerCase() === 'type' &&\n        options.processScripts.indexOf(currentAttrs[i].value) > -1) {\n      return minify(text, options);\n    }\n  }\n  return text;\n}\n\n// Tag omission rules from https://html.spec.whatwg.org/multipage/syntax.html#optional-tags\n// with the following deviations:\n// - retain <body> if followed by <noscript>\n// - </rb>, </rt>, </rtc>, </rp> & </tfoot> follow https://www.w3.org/TR/html5/syntax.html#optional-tags\n// - retain all tags which are adjacent to non-standard HTML tags\nvar optionalStartTags = createMapFromString('html,head,body,colgroup,tbody');\nvar optionalEndTags = createMapFromString('html,head,body,li,dt,dd,p,rb,rt,rtc,rp,optgroup,option,colgroup,caption,thead,tbody,tfoot,tr,td,th');\nvar headerTags = createMapFromString('meta,link,script,style,template,noscript');\nvar descriptionTags = createMapFromString('dt,dd');\nvar pBlockTags = createMapFromString('address,article,aside,blockquote,details,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,main,menu,nav,ol,p,pre,section,table,ul');\nvar pInlineTags = createMapFromString('a,audio,del,ins,map,noscript,video');\nvar rubyTags = createMapFromString('rb,rt,rtc,rp');\nvar rtcTag = createMapFromString('rb,rtc,rp');\nvar optionTag = createMapFromString('option,optgroup');\nvar tableContentTags = createMapFromString('tbody,tfoot');\nvar tableSectionTags = createMapFromString('thead,tbody,tfoot');\nvar cellTags = createMapFromString('td,th');\nvar topLevelTags = createMapFromString('html,head,body');\nvar compactTags = createMapFromString('html,body');\nvar looseTags = createMapFromString('head,colgroup,caption');\nvar trailingTags = createMapFromString('dt,thead');\nvar htmlTags = createMapFromString('a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,command,content,data,datalist,dd,del,details,dfn,dialog,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,image,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,multicol,nav,nobr,noembed,noframes,noscript,object,ol,optgroup,option,output,p,param,picture,plaintext,pre,progress,q,rb,rp,rt,rtc,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp');\n\nfunction canRemoveParentTag(optionalStartTag, tag) {\n  switch (optionalStartTag) {\n    case 'html':\n    case 'head':\n      return true;\n    case 'body':\n      return !headerTags(tag);\n    case 'colgroup':\n      return tag === 'col';\n    case 'tbody':\n      return tag === 'tr';\n  }\n  return false;\n}\n\nfunction isStartTagMandatory(optionalEndTag, tag) {\n  switch (tag) {\n    case 'colgroup':\n      return optionalEndTag === 'colgroup';\n    case 'tbody':\n      return tableSectionTags(optionalEndTag);\n  }\n  return false;\n}\n\nfunction canRemovePrecedingTag(optionalEndTag, tag) {\n  switch (optionalEndTag) {\n    case 'html':\n    case 'head':\n    case 'body':\n    case 'colgroup':\n    case 'caption':\n      return true;\n    case 'li':\n    case 'optgroup':\n    case 'tr':\n      return tag === optionalEndTag;\n    case 'dt':\n    case 'dd':\n      return descriptionTags(tag);\n    case 'p':\n      return pBlockTags(tag);\n    case 'rb':\n    case 'rt':\n    case 'rp':\n      return rubyTags(tag);\n    case 'rtc':\n      return rtcTag(tag);\n    case 'option':\n      return optionTag(tag);\n    case 'thead':\n    case 'tbody':\n      return tableContentTags(tag);\n    case 'tfoot':\n      return tag === 'tbody';\n    case 'td':\n    case 'th':\n      return cellTags(tag);\n  }\n  return false;\n}\n\nvar reEmptyAttribute = new RegExp(\n  '^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(' +\n    '?:down|up|over|move|out)|key(?:press|down|up)))$');\n\nfunction canDeleteEmptyAttribute(tag, attrName, attrValue, options) {\n  var isValueEmpty = !attrValue || /^\\s*$/.test(attrValue);\n  if (!isValueEmpty) {\n    return false;\n  }\n  if (typeof options.removeEmptyAttributes === 'function') {\n    return options.removeEmptyAttributes(attrName, tag);\n  }\n  return tag === 'input' && attrName === 'value' || reEmptyAttribute.test(attrName);\n}\n\nfunction hasAttrName(name, attrs) {\n  for (var i = attrs.length - 1; i >= 0; i--) {\n    if (attrs[i].name === name) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction canRemoveElement(tag, attrs) {\n  switch (tag) {\n    case 'textarea':\n      return false;\n    case 'audio':\n    case 'script':\n    case 'video':\n      if (hasAttrName('src', attrs)) {\n        return false;\n      }\n      break;\n    case 'iframe':\n      if (hasAttrName('src', attrs) || hasAttrName('srcdoc', attrs)) {\n        return false;\n      }\n      break;\n    case 'object':\n      if (hasAttrName('data', attrs)) {\n        return false;\n      }\n      break;\n    case 'applet':\n      if (hasAttrName('code', attrs)) {\n        return false;\n      }\n      break;\n  }\n  return true;\n}\n\nfunction canCollapseWhitespace(tag) {\n  return !/^(?:script|style|pre|textarea)$/.test(tag);\n}\n\nfunction canTrimWhitespace(tag) {\n  return !/^(?:pre|textarea)$/.test(tag);\n}\n\nfunction normalizeAttr(attr, attrs, tag, options) {\n  var attrName = options.name(attr.name),\n      attrValue = attr.value;\n\n  if (options.decodeEntities && attrValue) {\n    attrValue = decode(attrValue, { isAttributeValue: true });\n  }\n\n  if (options.removeRedundantAttributes &&\n    isAttributeRedundant(tag, attrName, attrValue, attrs) ||\n    options.removeScriptTypeAttributes && tag === 'script' &&\n    attrName === 'type' && isScriptTypeAttribute(attrValue) && !keepScriptTypeAttribute(attrValue) ||\n    options.removeStyleLinkTypeAttributes && (tag === 'style' || tag === 'link') &&\n    attrName === 'type' && isStyleLinkTypeAttribute(attrValue)) {\n    return;\n  }\n\n  if (attrValue) {\n    attrValue = cleanAttributeValue(tag, attrName, attrValue, options, attrs);\n  }\n\n  if (options.removeEmptyAttributes &&\n      canDeleteEmptyAttribute(tag, attrName, attrValue, options)) {\n    return;\n  }\n\n  if (options.decodeEntities && attrValue) {\n    attrValue = attrValue.replace(/&(#?[0-9a-zA-Z]+;)/g, '&amp;$1');\n  }\n\n  return {\n    attr: attr,\n    name: attrName,\n    value: attrValue\n  };\n}\n\nfunction buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr) {\n  var attrName = normalized.name,\n      attrValue = normalized.value,\n      attr = normalized.attr,\n      attrQuote = attr.quote,\n      attrFragment,\n      emittedAttrValue;\n\n  if (typeof attrValue !== 'undefined' && (!options.removeAttributeQuotes ||\n      ~attrValue.indexOf(uidAttr) || !canRemoveAttributeQuotes(attrValue))) {\n    if (!options.preventAttributesEscaping) {\n      if (typeof options.quoteCharacter === 'undefined') {\n        var apos = (attrValue.match(/'/g) || []).length;\n        var quot = (attrValue.match(/\"/g) || []).length;\n        attrQuote = apos < quot ? '\\'' : '\"';\n      }\n      else {\n        attrQuote = options.quoteCharacter === '\\'' ? '\\'' : '\"';\n      }\n      if (attrQuote === '\"') {\n        attrValue = attrValue.replace(/\"/g, '&#34;');\n      }\n      else {\n        attrValue = attrValue.replace(/'/g, '&#39;');\n      }\n    }\n    emittedAttrValue = attrQuote + attrValue + attrQuote;\n    if (!isLast && !options.removeTagWhitespace) {\n      emittedAttrValue += ' ';\n    }\n  }\n  // make sure trailing slash is not interpreted as HTML self-closing tag\n  else if (isLast && !hasUnarySlash && !/\\/$/.test(attrValue)) {\n    emittedAttrValue = attrValue;\n  }\n  else {\n    emittedAttrValue = attrValue + ' ';\n  }\n\n  if (typeof attrValue === 'undefined' || options.collapseBooleanAttributes &&\n      isBooleanAttribute(attrName.toLowerCase(), attrValue.toLowerCase())) {\n    attrFragment = attrName;\n    if (!isLast) {\n      attrFragment += ' ';\n    }\n  }\n  else {\n    attrFragment = attrName + attr.customAssign + emittedAttrValue;\n  }\n\n  return attr.customOpen + attrFragment + attr.customClose;\n}\n\nfunction identity(value) {\n  return value;\n}\n\nfunction processOptions(values) {\n  var options = {\n    name: function(name) {\n      return name.toLowerCase();\n    },\n    canCollapseWhitespace: canCollapseWhitespace,\n    canTrimWhitespace: canTrimWhitespace,\n    html5: true,\n    ignoreCustomComments: [\n      /^!/,\n      /^\\s*#/\n    ],\n    ignoreCustomFragments: [\n      /<%[\\s\\S]*?%>/,\n      /<\\?[\\s\\S]*?\\?>/\n    ],\n    includeAutoGeneratedTags: true,\n    log: identity,\n    minifyCSS: identity,\n    minifyJS: identity,\n    minifyURLs: identity\n  };\n  Object.keys(values).forEach(function(key) {\n    var value = values[key];\n    if (key === 'caseSensitive') {\n      if (value) {\n        options.name = identity;\n      }\n    }\n    else if (key === 'log') {\n      if (typeof value === 'function') {\n        options.log = value;\n      }\n    }\n    else if (key === 'minifyCSS' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n      if (typeof value !== 'object') {\n        value = {};\n      }\n      options.minifyCSS = function(text, type) {\n        text = text.replace(/(url\\s*\\(\\s*)(\"|'|)(.*?)\\2(\\s*\\))/ig, function(match, prefix, quote, url, suffix) {\n          return prefix + quote + options.minifyURLs(url) + quote + suffix;\n        });\n        var cleanCssOutput = new CleanCSS(value).minify(wrapCSS(text, type));\n        if (cleanCssOutput.errors.length > 0) {\n          cleanCssOutput.errors.forEach(options.log);\n          return text;\n        }\n        return unwrapCSS(cleanCssOutput.styles, type);\n      };\n    }\n    else if (key === 'minifyJS' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n      if (typeof value !== 'object') {\n        value = {};\n      }\n      (value.parse || (value.parse = {})).bare_returns = false;\n      options.minifyJS = function(text, inline) {\n        var start = text.match(/^\\s*<!--.*/);\n        var code = start ? text.slice(start[0].length).replace(/\\n\\s*-->\\s*$/, '') : text;\n        value.parse.bare_returns = inline;\n        var result = Terser.minify(code, value);\n        if (result.error) {\n          options.log(result.error);\n          return text;\n        }\n        return result.code.replace(/;$/, '');\n      };\n    }\n    else if (key === 'minifyURLs' && typeof value !== 'function') {\n      if (!value) {\n        return;\n      }\n      if (typeof value === 'string') {\n        value = { site: value };\n      }\n      else if (typeof value !== 'object') {\n        value = {};\n      }\n      options.minifyURLs = function(text) {\n        try {\n          return RelateUrl.relate(text, value);\n        }\n        catch (err) {\n          options.log(err);\n          return text;\n        }\n      };\n    }\n    else {\n      options[key] = value;\n    }\n  });\n  return options;\n}\n\nfunction uniqueId(value) {\n  var id;\n  do {\n    id = Math.random().toString(36).replace(/^0\\.[0-9]*/, '');\n  } while (~value.indexOf(id));\n  return id;\n}\n\nvar specialContentTags = createMapFromString('script,style');\n\nfunction createSortFns(value, options, uidIgnore, uidAttr) {\n  var attrChains = options.sortAttributes && Object.create(null);\n  var classChain = options.sortClassName && new TokenChain();\n\n  function attrNames(attrs) {\n    return attrs.map(function(attr) {\n      return options.name(attr.name);\n    });\n  }\n\n  function shouldSkipUID(token, uid) {\n    return !uid || token.indexOf(uid) === -1;\n  }\n\n  function shouldSkipUIDs(token) {\n    return shouldSkipUID(token, uidIgnore) && shouldSkipUID(token, uidAttr);\n  }\n\n  function scan(input) {\n    var currentTag, currentType;\n    new HTMLParser(input, {\n      start: function(tag, attrs) {\n        if (attrChains) {\n          if (!attrChains[tag]) {\n            attrChains[tag] = new TokenChain();\n          }\n          attrChains[tag].add(attrNames(attrs).filter(shouldSkipUIDs));\n        }\n        for (var i = 0, len = attrs.length; i < len; i++) {\n          var attr = attrs[i];\n          if (classChain && attr.value && options.name(attr.name) === 'class') {\n            classChain.add(trimWhitespace(attr.value).split(/[ \\t\\n\\f\\r]+/).filter(shouldSkipUIDs));\n          }\n          else if (options.processScripts && attr.name.toLowerCase() === 'type') {\n            currentTag = tag;\n            currentType = attr.value;\n          }\n        }\n      },\n      end: function() {\n        currentTag = '';\n      },\n      chars: function(text) {\n        if (options.processScripts && specialContentTags(currentTag) &&\n            options.processScripts.indexOf(currentType) > -1) {\n          scan(text);\n        }\n      }\n    });\n  }\n\n  var log = options.log;\n  options.log = identity;\n  options.sortAttributes = false;\n  options.sortClassName = false;\n  scan(minify(value, options));\n  options.log = log;\n  if (attrChains) {\n    var attrSorters = Object.create(null);\n    for (var tag in attrChains) {\n      attrSorters[tag] = attrChains[tag].createSorter();\n    }\n    options.sortAttributes = function(tag, attrs) {\n      var sorter = attrSorters[tag];\n      if (sorter) {\n        var attrMap = Object.create(null);\n        var names = attrNames(attrs);\n        names.forEach(function(name, index) {\n          (attrMap[name] || (attrMap[name] = [])).push(attrs[index]);\n        });\n        sorter.sort(names).forEach(function(name, index) {\n          attrs[index] = attrMap[name].shift();\n        });\n      }\n    };\n  }\n  if (classChain) {\n    var sorter = classChain.createSorter();\n    options.sortClassName = function(value) {\n      return sorter.sort(value.split(/[ \\n\\f\\r]+/)).join(' ');\n    };\n  }\n}\n\nfunction minify(value, options, partialMarkup) {\n  if (options.collapseWhitespace) {\n    value = collapseWhitespace(value, options, true, true);\n  }\n\n  var buffer = [],\n      charsPrevTag,\n      currentChars = '',\n      hasChars,\n      currentTag = '',\n      currentAttrs = [],\n      stackNoTrimWhitespace = [],\n      stackNoCollapseWhitespace = [],\n      optionalStartTag = '',\n      optionalEndTag = '',\n      ignoredMarkupChunks = [],\n      ignoredCustomMarkupChunks = [],\n      uidIgnore,\n      uidAttr,\n      uidPattern;\n\n  // temporarily replace ignored chunks with comments,\n  // so that we don't have to worry what's there.\n  // for all we care there might be\n  // completely-horribly-broken-alien-non-html-emoj-cthulhu-filled content\n  value = value.replace(/<!-- htmlmin:ignore -->([\\s\\S]*?)<!-- htmlmin:ignore -->/g, function(match, group1) {\n    if (!uidIgnore) {\n      uidIgnore = uniqueId(value);\n      var pattern = new RegExp('^' + uidIgnore + '([0-9]+)$');\n      if (options.ignoreCustomComments) {\n        options.ignoreCustomComments = options.ignoreCustomComments.slice();\n      }\n      else {\n        options.ignoreCustomComments = [];\n      }\n      options.ignoreCustomComments.push(pattern);\n    }\n    var token = '<!--' + uidIgnore + ignoredMarkupChunks.length + '-->';\n    ignoredMarkupChunks.push(group1);\n    return token;\n  });\n\n  var customFragments = options.ignoreCustomFragments.map(function(re) {\n    return re.source;\n  });\n  if (customFragments.length) {\n    var reCustomIgnore = new RegExp('\\\\s*(?:' + customFragments.join('|') + ')+\\\\s*', 'g');\n    // temporarily replace custom ignored fragments with unique attributes\n    value = value.replace(reCustomIgnore, function(match) {\n      if (!uidAttr) {\n        uidAttr = uniqueId(value);\n        uidPattern = new RegExp('(\\\\s*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\\\s*)', 'g');\n        if (options.minifyCSS) {\n          options.minifyCSS = (function(fn) {\n            return function(text, type) {\n              text = text.replace(uidPattern, function(match, prefix, index) {\n                var chunks = ignoredCustomMarkupChunks[+index];\n                return chunks[1] + uidAttr + index + uidAttr + chunks[2];\n              });\n              var ids = [];\n              new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function(warning) {\n                var match = uidPattern.exec(warning);\n                if (match) {\n                  var id = uidAttr + match[2] + uidAttr;\n                  text = text.replace(id, ignoreCSS(id));\n                  ids.push(id);\n                }\n              });\n              text = fn(text, type);\n              ids.forEach(function(id) {\n                text = text.replace(ignoreCSS(id), id);\n              });\n              return text;\n            };\n          })(options.minifyCSS);\n        }\n        if (options.minifyJS) {\n          options.minifyJS = (function(fn) {\n            return function(text, type) {\n              return fn(text.replace(uidPattern, function(match, prefix, index) {\n                var chunks = ignoredCustomMarkupChunks[+index];\n                return chunks[1] + uidAttr + index + uidAttr + chunks[2];\n              }), type);\n            };\n          })(options.minifyJS);\n        }\n      }\n      var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr;\n      ignoredCustomMarkupChunks.push(/^(\\s*)[\\s\\S]*?(\\s*)$/.exec(match));\n      return '\\t' + token + '\\t';\n    });\n  }\n\n  if (options.sortAttributes && typeof options.sortAttributes !== 'function' ||\n      options.sortClassName && typeof options.sortClassName !== 'function') {\n    createSortFns(value, options, uidIgnore, uidAttr);\n  }\n\n  function _canCollapseWhitespace(tag, attrs) {\n    return options.canCollapseWhitespace(tag, attrs, canCollapseWhitespace);\n  }\n\n  function _canTrimWhitespace(tag, attrs) {\n    return options.canTrimWhitespace(tag, attrs, canTrimWhitespace);\n  }\n\n  function removeStartTag() {\n    var index = buffer.length - 1;\n    while (index > 0 && !/^<[^/!]/.test(buffer[index])) {\n      index--;\n    }\n    buffer.length = Math.max(0, index);\n  }\n\n  function removeEndTag() {\n    var index = buffer.length - 1;\n    while (index > 0 && !/^<\\//.test(buffer[index])) {\n      index--;\n    }\n    buffer.length = Math.max(0, index);\n  }\n\n  // look for trailing whitespaces, bypass any inline tags\n  function trimTrailingWhitespace(index, nextTag) {\n    for (var endTag = null; index >= 0 && _canTrimWhitespace(endTag); index--) {\n      var str = buffer[index];\n      var match = str.match(/^<\\/([\\w:-]+)>$/);\n      if (match) {\n        endTag = match[1];\n      }\n      else if (/>$/.test(str) || (buffer[index] = collapseWhitespaceSmart(str, null, nextTag, options))) {\n        break;\n      }\n    }\n  }\n\n  // look for trailing whitespaces from previously processed text\n  // which may not be trimmed due to a following comment or an empty\n  // element which has now been removed\n  function squashTrailingWhitespace(nextTag) {\n    var charsIndex = buffer.length - 1;\n    if (buffer.length > 1) {\n      var item = buffer[buffer.length - 1];\n      if (/^(?:<!|$)/.test(item) && item.indexOf(uidIgnore) === -1) {\n        charsIndex--;\n      }\n    }\n    trimTrailingWhitespace(charsIndex, nextTag);\n  }\n\n  new HTMLParser(value, {\n    partialMarkup: partialMarkup,\n    continueOnParseError: options.continueOnParseError,\n    customAttrAssign: options.customAttrAssign,\n    customAttrSurround: options.customAttrSurround,\n    html5: options.html5,\n\n    start: function(tag, attrs, unary, unarySlash, autoGenerated) {\n      if (tag.toLowerCase() === 'svg') {\n        options = Object.create(options);\n        options.caseSensitive = true;\n        options.keepClosingSlash = true;\n        options.name = identity;\n      }\n      tag = options.name(tag);\n      currentTag = tag;\n      charsPrevTag = tag;\n      if (!inlineTextTags(tag)) {\n        currentChars = '';\n      }\n      hasChars = false;\n      currentAttrs = attrs;\n\n      var optional = options.removeOptionalTags;\n      if (optional) {\n        var htmlTag = htmlTags(tag);\n        // <html> may be omitted if first thing inside is not comment\n        // <head> may be omitted if first thing inside is an element\n        // <body> may be omitted if first thing inside is not space, comment, <meta>, <link>, <script>, <style> or <template>\n        // <colgroup> may be omitted if first thing inside is <col>\n        // <tbody> may be omitted if first thing inside is <tr>\n        if (htmlTag && canRemoveParentTag(optionalStartTag, tag)) {\n          removeStartTag();\n        }\n        optionalStartTag = '';\n        // end-tag-followed-by-start-tag omission rules\n        if (htmlTag && canRemovePrecedingTag(optionalEndTag, tag)) {\n          removeEndTag();\n          // <colgroup> cannot be omitted if preceding </colgroup> is omitted\n          // <tbody> cannot be omitted if preceding </tbody>, </thead> or </tfoot> is omitted\n          optional = !isStartTagMandatory(optionalEndTag, tag);\n        }\n        optionalEndTag = '';\n      }\n\n      // set whitespace flags for nested tags (eg. <code> within a <pre>)\n      if (options.collapseWhitespace) {\n        if (!stackNoTrimWhitespace.length) {\n          squashTrailingWhitespace(tag);\n        }\n        if (!unary) {\n          if (!_canTrimWhitespace(tag, attrs) || stackNoTrimWhitespace.length) {\n            stackNoTrimWhitespace.push(tag);\n          }\n          if (!_canCollapseWhitespace(tag, attrs) || stackNoCollapseWhitespace.length) {\n            stackNoCollapseWhitespace.push(tag);\n          }\n        }\n      }\n\n      var openTag = '<' + tag;\n      var hasUnarySlash = unarySlash && options.keepClosingSlash;\n\n      buffer.push(openTag);\n\n      if (options.sortAttributes) {\n        options.sortAttributes(tag, attrs);\n      }\n\n      var parts = [];\n      for (var i = attrs.length, isLast = true; --i >= 0;) {\n        var normalized = normalizeAttr(attrs[i], attrs, tag, options);\n        if (normalized) {\n          parts.unshift(buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr));\n          isLast = false;\n        }\n      }\n      if (parts.length > 0) {\n        buffer.push(' ');\n        buffer.push.apply(buffer, parts);\n      }\n      // start tag must never be omitted if it has any attributes\n      else if (optional && optionalStartTags(tag)) {\n        optionalStartTag = tag;\n      }\n\n      buffer.push(buffer.pop() + (hasUnarySlash ? '/' : '') + '>');\n\n      if (autoGenerated && !options.includeAutoGeneratedTags) {\n        removeStartTag();\n        optionalStartTag = '';\n      }\n    },\n    end: function(tag, attrs, autoGenerated) {\n      if (tag.toLowerCase() === 'svg') {\n        options = Object.getPrototypeOf(options);\n      }\n      tag = options.name(tag);\n\n      // check if current tag is in a whitespace stack\n      if (options.collapseWhitespace) {\n        if (stackNoTrimWhitespace.length) {\n          if (tag === stackNoTrimWhitespace[stackNoTrimWhitespace.length - 1]) {\n            stackNoTrimWhitespace.pop();\n          }\n        }\n        else {\n          squashTrailingWhitespace('/' + tag);\n        }\n        if (stackNoCollapseWhitespace.length &&\n          tag === stackNoCollapseWhitespace[stackNoCollapseWhitespace.length - 1]) {\n          stackNoCollapseWhitespace.pop();\n        }\n      }\n\n      var isElementEmpty = false;\n      if (tag === currentTag) {\n        currentTag = '';\n        isElementEmpty = !hasChars;\n      }\n\n      if (options.removeOptionalTags) {\n        // <html>, <head> or <body> may be omitted if the element is empty\n        if (isElementEmpty && topLevelTags(optionalStartTag)) {\n          removeStartTag();\n        }\n        optionalStartTag = '';\n        // </html> or </body> may be omitted if not followed by comment\n        // </head> may be omitted if not followed by space or comment\n        // </p> may be omitted if no more content in non-</a> parent\n        // except for </dt> or </thead>, end tags may be omitted if no more content in parent element\n        if (htmlTags(tag) && optionalEndTag && !trailingTags(optionalEndTag) && (optionalEndTag !== 'p' || !pInlineTags(tag))) {\n          removeEndTag();\n        }\n        optionalEndTag = optionalEndTags(tag) ? tag : '';\n      }\n\n      if (options.removeEmptyElements && isElementEmpty && canRemoveElement(tag, attrs)) {\n        // remove last \"element\" from buffer\n        removeStartTag();\n        optionalStartTag = '';\n        optionalEndTag = '';\n      }\n      else {\n        if (autoGenerated && !options.includeAutoGeneratedTags) {\n          optionalEndTag = '';\n        }\n        else {\n          buffer.push('</' + tag + '>');\n        }\n        charsPrevTag = '/' + tag;\n        if (!inlineTags(tag)) {\n          currentChars = '';\n        }\n        else if (isElementEmpty) {\n          currentChars += '|';\n        }\n      }\n    },\n    chars: function(text, prevTag, nextTag) {\n      prevTag = prevTag === '' ? 'comment' : prevTag;\n      nextTag = nextTag === '' ? 'comment' : nextTag;\n      if (options.decodeEntities && text && !specialContentTags(currentTag)) {\n        text = decode(text);\n      }\n      if (options.collapseWhitespace) {\n        if (!stackNoTrimWhitespace.length) {\n          if (prevTag === 'comment') {\n            var prevComment = buffer[buffer.length - 1];\n            if (prevComment.indexOf(uidIgnore) === -1) {\n              if (!prevComment) {\n                prevTag = charsPrevTag;\n              }\n              if (buffer.length > 1 && (!prevComment || !options.conservativeCollapse && / $/.test(currentChars))) {\n                var charsIndex = buffer.length - 2;\n                buffer[charsIndex] = buffer[charsIndex].replace(/\\s+$/, function(trailingSpaces) {\n                  text = trailingSpaces + text;\n                  return '';\n                });\n              }\n            }\n          }\n          if (prevTag) {\n            if (prevTag === '/nobr' || prevTag === 'wbr') {\n              if (/^\\s/.test(text)) {\n                var tagIndex = buffer.length - 1;\n                while (tagIndex > 0 && buffer[tagIndex].lastIndexOf('<' + prevTag) !== 0) {\n                  tagIndex--;\n                }\n                trimTrailingWhitespace(tagIndex - 1, 'br');\n              }\n            }\n            else if (inlineTextTags(prevTag.charAt(0) === '/' ? prevTag.slice(1) : prevTag)) {\n              text = collapseWhitespace(text, options, /(?:^|\\s)$/.test(currentChars));\n            }\n          }\n          if (prevTag || nextTag) {\n            text = collapseWhitespaceSmart(text, prevTag, nextTag, options);\n          }\n          else {\n            text = collapseWhitespace(text, options, true, true);\n          }\n          if (!text && /\\s$/.test(currentChars) && prevTag && prevTag.charAt(0) === '/') {\n            trimTrailingWhitespace(buffer.length - 1, nextTag);\n          }\n        }\n        if (!stackNoCollapseWhitespace.length && nextTag !== 'html' && !(prevTag && nextTag)) {\n          text = collapseWhitespace(text, options, false, false, true);\n        }\n      }\n      if (options.processScripts && specialContentTags(currentTag)) {\n        text = processScript(text, options, currentAttrs);\n      }\n      if (isExecutableScript(currentTag, currentAttrs)) {\n        text = options.minifyJS(text);\n      }\n      if (isStyleSheet(currentTag, currentAttrs)) {\n        text = options.minifyCSS(text);\n      }\n      if (options.removeOptionalTags && text) {\n        // <html> may be omitted if first thing inside is not comment\n        // <body> may be omitted if first thing inside is not space, comment, <meta>, <link>, <script>, <style> or <template>\n        if (optionalStartTag === 'html' || optionalStartTag === 'body' && !/^\\s/.test(text)) {\n          removeStartTag();\n        }\n        optionalStartTag = '';\n        // </html> or </body> may be omitted if not followed by comment\n        // </head>, </colgroup> or </caption> may be omitted if not followed by space or comment\n        if (compactTags(optionalEndTag) || looseTags(optionalEndTag) && !/^\\s/.test(text)) {\n          removeEndTag();\n        }\n        optionalEndTag = '';\n      }\n      charsPrevTag = /^\\s*$/.test(text) ? prevTag : 'comment';\n      if (options.decodeEntities && text && !specialContentTags(currentTag)) {\n        // Escape any `&` symbols that start either:\n        // 1) a legacy named character reference (i.e. one that doesn't end with `;`)\n        // 2) or any other character reference (i.e. one that does end with `;`)\n        // Note that `&` can be escaped as `&amp`, without the semi-colon.\n        // https://mathiasbynens.be/notes/ambiguous-ampersands\n        text = text.replace(/&((?:Iacute|aacute|uacute|plusmn|Otilde|otilde|agrave|Agrave|Yacute|yacute|Oslash|oslash|atilde|Atilde|brvbar|ccedil|Ccedil|Ograve|curren|divide|eacute|Eacute|ograve|Oacute|egrave|Egrave|Ugrave|frac12|frac14|frac34|ugrave|oacute|iacute|Ntilde|ntilde|Uacute|middot|igrave|Igrave|iquest|Aacute|cedil|laquo|micro|iexcl|Icirc|icirc|acirc|Ucirc|Ecirc|ocirc|Ocirc|ecirc|ucirc|Aring|aring|AElig|aelig|acute|pound|raquo|Acirc|times|THORN|szlig|thorn|COPY|auml|ordf|ordm|Uuml|macr|uuml|Auml|ouml|Ouml|para|nbsp|euml|quot|QUOT|Euml|yuml|cent|sect|copy|sup1|sup2|sup3|iuml|Iuml|ETH|shy|reg|not|yen|amp|AMP|REG|uml|eth|deg|gt|GT|LT|lt)(?!;)|(?:#?[0-9a-zA-Z]+;))/g, '&amp$1').replace(/</g, '&lt;');\n      }\n      if (uidPattern && options.collapseWhitespace && stackNoTrimWhitespace.length) {\n        text = text.replace(uidPattern, function(match, prefix, index) {\n          return ignoredCustomMarkupChunks[+index][0];\n        });\n      }\n      currentChars += text;\n      if (text) {\n        hasChars = true;\n      }\n      buffer.push(text);\n    },\n    comment: function(text, nonStandard) {\n      var prefix = nonStandard ? '<!' : '<!--';\n      var suffix = nonStandard ? '>' : '-->';\n      if (isConditionalComment(text)) {\n        text = prefix + cleanConditionalComment(text, options) + suffix;\n      }\n      else if (options.removeComments) {\n        if (isIgnoredComment(text, options)) {\n          text = '<!--' + text + '-->';\n        }\n        else {\n          text = '';\n        }\n      }\n      else {\n        text = prefix + text + suffix;\n      }\n      if (options.removeOptionalTags && text) {\n        // preceding comments suppress tag omissions\n        optionalStartTag = '';\n        optionalEndTag = '';\n      }\n      buffer.push(text);\n    },\n    doctype: function(doctype) {\n      buffer.push(options.useShortDoctype ? '<!doctype' +\n        (options.removeTagWhitespace ? '' : ' ') + 'html>' :\n        collapseWhitespaceAll(doctype));\n    }\n  });\n\n  if (options.removeOptionalTags) {\n    // <html> may be omitted if first thing inside is not comment\n    // <head> or <body> may be omitted if empty\n    if (topLevelTags(optionalStartTag)) {\n      removeStartTag();\n    }\n    // except for </dt> or </thead>, end tags may be omitted if no more content in parent element\n    if (optionalEndTag && !trailingTags(optionalEndTag)) {\n      removeEndTag();\n    }\n  }\n  if (options.collapseWhitespace) {\n    squashTrailingWhitespace('br');\n  }\n\n  return joinResultSegments(buffer, options, uidPattern ? function(str) {\n    return str.replace(uidPattern, function(match, prefix, index, suffix) {\n      var chunk = ignoredCustomMarkupChunks[+index][0];\n      if (options.collapseWhitespace) {\n        if (prefix !== '\\t') {\n          chunk = prefix + chunk;\n        }\n        if (suffix !== '\\t') {\n          chunk += suffix;\n        }\n        return collapseWhitespace(chunk, {\n          preserveLineBreaks: options.preserveLineBreaks,\n          conservativeCollapse: !options.trimCustomFragments\n        }, /^[ \\n\\r\\t\\f]/.test(chunk), /[ \\n\\r\\t\\f]$/.test(chunk));\n      }\n      return chunk;\n    });\n  } : identity, uidIgnore ? function(str) {\n    return str.replace(new RegExp('<!--' + uidIgnore + '([0-9]+)-->', 'g'), function(match, index) {\n      return ignoredMarkupChunks[+index];\n    });\n  } : identity);\n}\n\nfunction joinResultSegments(results, options, restoreCustom, restoreIgnore) {\n  var str;\n  var maxLineLength = options.maxLineLength;\n  if (maxLineLength) {\n    var line = '', lines = [];\n    while (results.length) {\n      var len = line.length;\n      var end = results[0].indexOf('\\n');\n      if (end < 0) {\n        line += restoreIgnore(restoreCustom(results.shift()));\n      }\n      else {\n        line += restoreIgnore(restoreCustom(results[0].slice(0, end)));\n        results[0] = results[0].slice(end + 1);\n      }\n      if (len > 0 && line.length > maxLineLength) {\n        lines.push(line.slice(0, len));\n        line = line.slice(len);\n      }\n      else if (end >= 0) {\n        lines.push(line);\n        line = '';\n      }\n    }\n    if (line) {\n      lines.push(line);\n    }\n    str = lines.join('\\n');\n  }\n  else {\n    str = restoreIgnore(restoreCustom(results.join('')));\n  }\n  return options.collapseWhitespace ? collapseWhitespace(str, options, true, true) : str;\n}\n\nexports.minify = function(value, options) {\n  var start = Date.now();\n  options = processOptions(options || {});\n  var result = minify(value, options);\n  options.log('minified in: ' + (Date.now() - start) + 'ms');\n  return result;\n};\n"]},"metadata":{},"sourceType":"script"}