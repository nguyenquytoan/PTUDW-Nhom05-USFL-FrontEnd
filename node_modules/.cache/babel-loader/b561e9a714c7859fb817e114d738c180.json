{"ast":null,"code":"var Marker = require('../../tokenizer/marker');\n\nvar split = require('../../utils/split');\n\nvar DEEP_SELECTOR_PATTERN = /\\/deep\\//;\nvar DOUBLE_COLON_PATTERN = /^::/;\nvar NOT_PSEUDO = ':not';\nvar PSEUDO_CLASSES_WITH_ARGUMENTS = [':dir', ':lang', ':not', ':nth-child', ':nth-last-child', ':nth-last-of-type', ':nth-of-type'];\nvar RELATION_PATTERN = /[>\\+~]/;\nvar UNMIXABLE_PSEUDO_CLASSES = [':after', ':before', ':first-letter', ':first-line', ':lang'];\nvar UNMIXABLE_PSEUDO_ELEMENTS = ['::after', '::before', '::first-letter', '::first-line'];\nvar Level = {\n  DOUBLE_QUOTE: 'double-quote',\n  SINGLE_QUOTE: 'single-quote',\n  ROOT: 'root'\n};\n\nfunction isMergeable(selector, mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging) {\n  var singleSelectors = split(selector, Marker.COMMA);\n  var singleSelector;\n  var i, l;\n\n  for (i = 0, l = singleSelectors.length; i < l; i++) {\n    singleSelector = singleSelectors[i];\n\n    if (singleSelector.length === 0 || isDeepSelector(singleSelector) || singleSelector.indexOf(Marker.COLON) > -1 && !areMergeable(singleSelector, extractPseudoFrom(singleSelector), mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isDeepSelector(selector) {\n  return DEEP_SELECTOR_PATTERN.test(selector);\n}\n\nfunction extractPseudoFrom(selector) {\n  var list = [];\n  var character;\n  var buffer = [];\n  var level = Level.ROOT;\n  var roundBracketLevel = 0;\n  var isQuoted;\n  var isEscaped;\n  var isPseudo = false;\n  var isRelation;\n  var wasColon = false;\n  var index;\n  var len;\n\n  for (index = 0, len = selector.length; index < len; index++) {\n    character = selector[index];\n    isRelation = !isEscaped && RELATION_PATTERN.test(character);\n    isQuoted = level == Level.DOUBLE_QUOTE || level == Level.SINGLE_QUOTE;\n\n    if (isEscaped) {\n      buffer.push(character);\n    } else if (character == Marker.DOUBLE_QUOTE && level == Level.ROOT) {\n      buffer.push(character);\n      level = Level.DOUBLE_QUOTE;\n    } else if (character == Marker.DOUBLE_QUOTE && level == Level.DOUBLE_QUOTE) {\n      buffer.push(character);\n      level = Level.ROOT;\n    } else if (character == Marker.SINGLE_QUOTE && level == Level.ROOT) {\n      buffer.push(character);\n      level = Level.SINGLE_QUOTE;\n    } else if (character == Marker.SINGLE_QUOTE && level == Level.SINGLE_QUOTE) {\n      buffer.push(character);\n      level = Level.ROOT;\n    } else if (isQuoted) {\n      buffer.push(character);\n    } else if (character == Marker.OPEN_ROUND_BRACKET) {\n      buffer.push(character);\n      roundBracketLevel++;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET && roundBracketLevel == 1 && isPseudo) {\n      buffer.push(character);\n      list.push(buffer.join(''));\n      roundBracketLevel--;\n      buffer = [];\n      isPseudo = false;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET) {\n      buffer.push(character);\n      roundBracketLevel--;\n    } else if (character == Marker.COLON && roundBracketLevel === 0 && isPseudo && !wasColon) {\n      list.push(buffer.join(''));\n      buffer = [];\n      buffer.push(character);\n    } else if (character == Marker.COLON && roundBracketLevel === 0 && !wasColon) {\n      buffer = [];\n      buffer.push(character);\n      isPseudo = true;\n    } else if (character == Marker.SPACE && roundBracketLevel === 0 && isPseudo) {\n      list.push(buffer.join(''));\n      buffer = [];\n      isPseudo = false;\n    } else if (isRelation && roundBracketLevel === 0 && isPseudo) {\n      list.push(buffer.join(''));\n      buffer = [];\n      isPseudo = false;\n    } else {\n      buffer.push(character);\n    }\n\n    isEscaped = character == Marker.BACK_SLASH;\n    wasColon = character == Marker.COLON;\n  }\n\n  if (buffer.length > 0 && isPseudo) {\n    list.push(buffer.join(''));\n  }\n\n  return list;\n}\n\nfunction areMergeable(selector, matches, mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging) {\n  return areAllowed(matches, mergeablePseudoClasses, mergeablePseudoElements) && needArguments(matches) && (matches.length < 2 || !someIncorrectlyChained(selector, matches)) && (matches.length < 2 || multiplePseudoMerging && allMixable(matches));\n}\n\nfunction areAllowed(matches, mergeablePseudoClasses, mergeablePseudoElements) {\n  var match;\n  var name;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n    name = match.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ? match.substring(0, match.indexOf(Marker.OPEN_ROUND_BRACKET)) : match;\n\n    if (mergeablePseudoClasses.indexOf(name) === -1 && mergeablePseudoElements.indexOf(name) === -1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction needArguments(matches) {\n  var match;\n  var name;\n  var bracketOpensAt;\n  var hasArguments;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n    bracketOpensAt = match.indexOf(Marker.OPEN_ROUND_BRACKET);\n    hasArguments = bracketOpensAt > -1;\n    name = hasArguments ? match.substring(0, bracketOpensAt) : match;\n\n    if (hasArguments && PSEUDO_CLASSES_WITH_ARGUMENTS.indexOf(name) == -1) {\n      return false;\n    }\n\n    if (!hasArguments && PSEUDO_CLASSES_WITH_ARGUMENTS.indexOf(name) > -1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction someIncorrectlyChained(selector, matches) {\n  var positionInSelector = 0;\n  var match;\n  var matchAt;\n  var nextMatch;\n  var nextMatchAt;\n  var name;\n  var nextName;\n  var areChained;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n    nextMatch = matches[i + 1];\n\n    if (!nextMatch) {\n      break;\n    }\n\n    matchAt = selector.indexOf(match, positionInSelector);\n    nextMatchAt = selector.indexOf(match, matchAt + 1);\n    positionInSelector = nextMatchAt;\n    areChained = matchAt + match.length == nextMatchAt;\n\n    if (areChained) {\n      name = match.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ? match.substring(0, match.indexOf(Marker.OPEN_ROUND_BRACKET)) : match;\n      nextName = nextMatch.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ? nextMatch.substring(0, nextMatch.indexOf(Marker.OPEN_ROUND_BRACKET)) : nextMatch;\n\n      if (name != NOT_PSEUDO || nextName != NOT_PSEUDO) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction allMixable(matches) {\n  var unmixableMatches = 0;\n  var match;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n\n    if (isPseudoElement(match)) {\n      unmixableMatches += UNMIXABLE_PSEUDO_ELEMENTS.indexOf(match) > -1 ? 1 : 0;\n    } else {\n      unmixableMatches += UNMIXABLE_PSEUDO_CLASSES.indexOf(match) > -1 ? 1 : 0;\n    }\n\n    if (unmixableMatches > 1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isPseudoElement(pseudo) {\n  return DOUBLE_COLON_PATTERN.test(pseudo);\n}\n\nmodule.exports = isMergeable;","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/clean-css/lib/optimizer/level-2/is-mergeable.js"],"names":["Marker","require","split","DEEP_SELECTOR_PATTERN","DOUBLE_COLON_PATTERN","NOT_PSEUDO","PSEUDO_CLASSES_WITH_ARGUMENTS","RELATION_PATTERN","UNMIXABLE_PSEUDO_CLASSES","UNMIXABLE_PSEUDO_ELEMENTS","Level","DOUBLE_QUOTE","SINGLE_QUOTE","ROOT","isMergeable","selector","mergeablePseudoClasses","mergeablePseudoElements","multiplePseudoMerging","singleSelectors","COMMA","singleSelector","i","l","length","isDeepSelector","indexOf","COLON","areMergeable","extractPseudoFrom","test","list","character","buffer","level","roundBracketLevel","isQuoted","isEscaped","isPseudo","isRelation","wasColon","index","len","push","OPEN_ROUND_BRACKET","CLOSE_ROUND_BRACKET","join","SPACE","BACK_SLASH","matches","areAllowed","needArguments","someIncorrectlyChained","allMixable","match","name","substring","bracketOpensAt","hasArguments","positionInSelector","matchAt","nextMatch","nextMatchAt","nextName","areChained","unmixableMatches","isPseudoElement","pseudo","module","exports"],"mappings":"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","sourcesContent":["var Marker = require('../../tokenizer/marker');\nvar split = require('../../utils/split');\n\nvar DEEP_SELECTOR_PATTERN = /\\/deep\\//;\nvar DOUBLE_COLON_PATTERN = /^::/;\nvar NOT_PSEUDO = ':not';\nvar PSEUDO_CLASSES_WITH_ARGUMENTS = [\n  ':dir',\n  ':lang',\n  ':not',\n  ':nth-child',\n  ':nth-last-child',\n  ':nth-last-of-type',\n  ':nth-of-type'\n];\nvar RELATION_PATTERN = /[>\\+~]/;\nvar UNMIXABLE_PSEUDO_CLASSES = [\n  ':after',\n  ':before',\n  ':first-letter',\n  ':first-line',\n  ':lang'\n];\nvar UNMIXABLE_PSEUDO_ELEMENTS = [\n  '::after',\n  '::before',\n  '::first-letter',\n  '::first-line'\n];\n\nvar Level = {\n  DOUBLE_QUOTE: 'double-quote',\n  SINGLE_QUOTE: 'single-quote',\n  ROOT: 'root'\n};\n\nfunction isMergeable(selector, mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging) {\n  var singleSelectors = split(selector, Marker.COMMA);\n  var singleSelector;\n  var i, l;\n\n  for (i = 0, l = singleSelectors.length; i < l; i++) {\n    singleSelector = singleSelectors[i];\n\n    if (singleSelector.length === 0 ||\n        isDeepSelector(singleSelector) ||\n        (singleSelector.indexOf(Marker.COLON) > -1 && !areMergeable(singleSelector, extractPseudoFrom(singleSelector), mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging))) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isDeepSelector(selector) {\n  return DEEP_SELECTOR_PATTERN.test(selector);\n}\n\nfunction extractPseudoFrom(selector) {\n  var list = [];\n  var character;\n  var buffer = [];\n  var level = Level.ROOT;\n  var roundBracketLevel = 0;\n  var isQuoted;\n  var isEscaped;\n  var isPseudo = false;\n  var isRelation;\n  var wasColon = false;\n  var index;\n  var len;\n\n  for (index = 0, len = selector.length; index < len; index++) {\n    character = selector[index];\n\n    isRelation = !isEscaped && RELATION_PATTERN.test(character);\n    isQuoted = level == Level.DOUBLE_QUOTE || level == Level.SINGLE_QUOTE;\n\n    if (isEscaped) {\n      buffer.push(character);\n    } else if (character == Marker.DOUBLE_QUOTE && level == Level.ROOT) {\n      buffer.push(character);\n      level = Level.DOUBLE_QUOTE;\n    } else if (character == Marker.DOUBLE_QUOTE && level == Level.DOUBLE_QUOTE) {\n      buffer.push(character);\n      level = Level.ROOT;\n    } else if (character == Marker.SINGLE_QUOTE && level == Level.ROOT) {\n      buffer.push(character);\n      level = Level.SINGLE_QUOTE;\n    } else if (character == Marker.SINGLE_QUOTE && level == Level.SINGLE_QUOTE) {\n      buffer.push(character);\n      level = Level.ROOT;\n    } else if (isQuoted) {\n      buffer.push(character);\n    } else if (character == Marker.OPEN_ROUND_BRACKET) {\n      buffer.push(character);\n      roundBracketLevel++;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET && roundBracketLevel == 1 && isPseudo) {\n      buffer.push(character);\n      list.push(buffer.join(''));\n      roundBracketLevel--;\n      buffer = [];\n      isPseudo = false;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET) {\n      buffer.push(character);\n      roundBracketLevel--;\n    } else if (character == Marker.COLON && roundBracketLevel === 0 && isPseudo && !wasColon) {\n      list.push(buffer.join(''));\n      buffer = [];\n      buffer.push(character);\n    } else if (character == Marker.COLON && roundBracketLevel === 0 && !wasColon) {\n      buffer = [];\n      buffer.push(character);\n      isPseudo = true;\n    } else if (character == Marker.SPACE && roundBracketLevel === 0 && isPseudo) {\n      list.push(buffer.join(''));\n      buffer = [];\n      isPseudo = false;\n    } else if (isRelation && roundBracketLevel === 0 && isPseudo) {\n      list.push(buffer.join(''));\n      buffer = [];\n      isPseudo = false;\n    } else {\n      buffer.push(character);\n    }\n\n    isEscaped = character == Marker.BACK_SLASH;\n    wasColon = character == Marker.COLON;\n  }\n\n  if (buffer.length > 0 && isPseudo) {\n    list.push(buffer.join(''));\n  }\n\n  return list;\n}\n\nfunction areMergeable(selector, matches, mergeablePseudoClasses, mergeablePseudoElements, multiplePseudoMerging) {\n  return areAllowed(matches, mergeablePseudoClasses, mergeablePseudoElements) &&\n    needArguments(matches) &&\n    (matches.length < 2 || !someIncorrectlyChained(selector, matches)) &&\n    (matches.length < 2 || multiplePseudoMerging && allMixable(matches));\n}\n\nfunction areAllowed(matches, mergeablePseudoClasses, mergeablePseudoElements) {\n  var match;\n  var name;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n    name = match.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ?\n      match.substring(0, match.indexOf(Marker.OPEN_ROUND_BRACKET)) :\n      match;\n\n    if (mergeablePseudoClasses.indexOf(name) === -1 && mergeablePseudoElements.indexOf(name) === -1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction needArguments(matches) {\n  var match;\n  var name;\n  var bracketOpensAt;\n  var hasArguments;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n\n    bracketOpensAt = match.indexOf(Marker.OPEN_ROUND_BRACKET);\n    hasArguments = bracketOpensAt > -1;\n    name = hasArguments ?\n      match.substring(0, bracketOpensAt) :\n      match;\n\n    if (hasArguments && PSEUDO_CLASSES_WITH_ARGUMENTS.indexOf(name) == -1) {\n      return false;\n    }\n\n    if (!hasArguments && PSEUDO_CLASSES_WITH_ARGUMENTS.indexOf(name) > -1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction someIncorrectlyChained(selector, matches) {\n  var positionInSelector = 0;\n  var match;\n  var matchAt;\n  var nextMatch;\n  var nextMatchAt;\n  var name;\n  var nextName;\n  var areChained;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n    nextMatch = matches[i + 1];\n\n    if (!nextMatch) {\n      break;\n    }\n\n    matchAt = selector.indexOf(match, positionInSelector);\n    nextMatchAt = selector.indexOf(match, matchAt + 1);\n    positionInSelector = nextMatchAt;\n    areChained = matchAt + match.length == nextMatchAt;\n\n    if (areChained) {\n      name = match.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ?\n        match.substring(0, match.indexOf(Marker.OPEN_ROUND_BRACKET)) :\n        match;\n      nextName = nextMatch.indexOf(Marker.OPEN_ROUND_BRACKET) > -1 ?\n        nextMatch.substring(0, nextMatch.indexOf(Marker.OPEN_ROUND_BRACKET)) :\n        nextMatch;\n\n      if (name != NOT_PSEUDO || nextName != NOT_PSEUDO) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction allMixable(matches) {\n  var unmixableMatches = 0;\n  var match;\n  var i, l;\n\n  for (i = 0, l = matches.length; i < l; i++) {\n    match = matches[i];\n\n    if (isPseudoElement(match)) {\n      unmixableMatches += UNMIXABLE_PSEUDO_ELEMENTS.indexOf(match) > -1 ? 1 : 0;\n    } else {\n      unmixableMatches += UNMIXABLE_PSEUDO_CLASSES.indexOf(match) > -1 ? 1 : 0;\n    }\n\n    if (unmixableMatches > 1) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isPseudoElement(pseudo) {\n  return DOUBLE_COLON_PATTERN.test(pseudo);\n}\n\nmodule.exports = isMergeable;\n"]},"metadata":{},"sourceType":"script"}