{"ast":null,"code":"var shallowClone = require('./clone').shallow;\n\nvar Token = require('../../tokenizer/token');\n\nvar Marker = require('../../tokenizer/marker');\n\nfunction isInheritOnly(values) {\n  for (var i = 0, l = values.length; i < l; i++) {\n    var value = values[i][1];\n    if (value != 'inherit' && value != Marker.COMMA && value != Marker.FORWARD_SLASH) return false;\n  }\n\n  return true;\n}\n\nfunction background(property, compactable, lastInMultiplex) {\n  var components = property.components;\n  var restored = [];\n  var needsOne, needsBoth;\n\n  function restoreValue(component) {\n    Array.prototype.unshift.apply(restored, component.value);\n  }\n\n  function isDefaultValue(component) {\n    var descriptor = compactable[component.name];\n\n    if (descriptor.doubleValues && descriptor.defaultValue.length == 1) {\n      return component.value[0][1] == descriptor.defaultValue[0] && (component.value[1] ? component.value[1][1] == descriptor.defaultValue[0] : true);\n    } else if (descriptor.doubleValues && descriptor.defaultValue.length != 1) {\n      return component.value[0][1] == descriptor.defaultValue[0] && (component.value[1] ? component.value[1][1] : component.value[0][1]) == descriptor.defaultValue[1];\n    } else {\n      return component.value[0][1] == descriptor.defaultValue;\n    }\n  }\n\n  for (var i = components.length - 1; i >= 0; i--) {\n    var component = components[i];\n    var isDefault = isDefaultValue(component);\n\n    if (component.name == 'background-clip') {\n      var originComponent = components[i - 1];\n      var isOriginDefault = isDefaultValue(originComponent);\n      needsOne = component.value[0][1] == originComponent.value[0][1];\n      needsBoth = !needsOne && (isOriginDefault && !isDefault || !isOriginDefault && !isDefault || !isOriginDefault && isDefault && component.value[0][1] != originComponent.value[0][1]);\n\n      if (needsOne) {\n        restoreValue(originComponent);\n      } else if (needsBoth) {\n        restoreValue(component);\n        restoreValue(originComponent);\n      }\n\n      i--;\n    } else if (component.name == 'background-size') {\n      var positionComponent = components[i - 1];\n      var isPositionDefault = isDefaultValue(positionComponent);\n      needsOne = !isPositionDefault && isDefault;\n      needsBoth = !needsOne && (isPositionDefault && !isDefault || !isPositionDefault && !isDefault);\n\n      if (needsOne) {\n        restoreValue(positionComponent);\n      } else if (needsBoth) {\n        restoreValue(component);\n        restored.unshift([Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]);\n        restoreValue(positionComponent);\n      } else if (positionComponent.value.length == 1) {\n        restoreValue(positionComponent);\n      }\n\n      i--;\n    } else {\n      if (isDefault || compactable[component.name].multiplexLastOnly && !lastInMultiplex) continue;\n      restoreValue(component);\n    }\n  }\n\n  if (restored.length === 0 && property.value.length == 1 && property.value[0][1] == '0') restored.push(property.value[0]);\n  if (restored.length === 0) restored.push([Token.PROPERTY_VALUE, compactable[property.name].defaultValue]);\n  if (isInheritOnly(restored)) return [restored[0]];\n  return restored;\n}\n\nfunction borderRadius(property, compactable) {\n  if (property.multiplex) {\n    var horizontal = shallowClone(property);\n    var vertical = shallowClone(property);\n\n    for (var i = 0; i < 4; i++) {\n      var component = property.components[i];\n      var horizontalComponent = shallowClone(property);\n      horizontalComponent.value = [component.value[0]];\n      horizontal.components.push(horizontalComponent);\n      var verticalComponent = shallowClone(property); // FIXME: only shorthand compactor (see breakup#borderRadius) knows that border radius\n      // longhands have two values, whereas tokenizer does not care about populating 2nd value\n      // if it's missing, hence this fallback\n\n      verticalComponent.value = [component.value[1] || component.value[0]];\n      vertical.components.push(verticalComponent);\n    }\n\n    var horizontalValues = fourValues(horizontal, compactable);\n    var verticalValues = fourValues(vertical, compactable);\n\n    if (horizontalValues.length == verticalValues.length && horizontalValues[0][1] == verticalValues[0][1] && (horizontalValues.length > 1 ? horizontalValues[1][1] == verticalValues[1][1] : true) && (horizontalValues.length > 2 ? horizontalValues[2][1] == verticalValues[2][1] : true) && (horizontalValues.length > 3 ? horizontalValues[3][1] == verticalValues[3][1] : true)) {\n      return horizontalValues;\n    } else {\n      return horizontalValues.concat([[Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]]).concat(verticalValues);\n    }\n  } else {\n    return fourValues(property, compactable);\n  }\n}\n\nfunction font(property, compactable) {\n  var components = property.components;\n  var restored = [];\n  var component;\n  var componentIndex = 0;\n  var fontFamilyIndex = 0;\n\n  if (property.value[0][1].indexOf(Marker.INTERNAL) === 0) {\n    property.value[0][1] = property.value[0][1].substring(Marker.INTERNAL.length);\n    return property.value;\n  } // first four components are optional\n\n\n  while (componentIndex < 4) {\n    component = components[componentIndex];\n\n    if (component.value[0][1] != compactable[component.name].defaultValue) {\n      Array.prototype.push.apply(restored, component.value);\n    }\n\n    componentIndex++;\n  } // then comes font-size\n\n\n  Array.prototype.push.apply(restored, components[componentIndex].value);\n  componentIndex++; // then may come line-height\n\n  if (components[componentIndex].value[0][1] != compactable[components[componentIndex].name].defaultValue) {\n    Array.prototype.push.apply(restored, [[Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]]);\n    Array.prototype.push.apply(restored, components[componentIndex].value);\n  }\n\n  componentIndex++; // then comes font-family\n\n  while (components[componentIndex].value[fontFamilyIndex]) {\n    restored.push(components[componentIndex].value[fontFamilyIndex]);\n\n    if (components[componentIndex].value[fontFamilyIndex + 1]) {\n      restored.push([Token.PROPERTY_VALUE, Marker.COMMA]);\n    }\n\n    fontFamilyIndex++;\n  }\n\n  if (isInheritOnly(restored)) {\n    return [restored[0]];\n  }\n\n  return restored;\n}\n\nfunction fourValues(property) {\n  var components = property.components;\n  var value1 = components[0].value[0];\n  var value2 = components[1].value[0];\n  var value3 = components[2].value[0];\n  var value4 = components[3].value[0];\n\n  if (value1[1] == value2[1] && value1[1] == value3[1] && value1[1] == value4[1]) {\n    return [value1];\n  } else if (value1[1] == value3[1] && value2[1] == value4[1]) {\n    return [value1, value2];\n  } else if (value2[1] == value4[1]) {\n    return [value1, value2, value3];\n  } else {\n    return [value1, value2, value3, value4];\n  }\n}\n\nfunction multiplex(restoreWith) {\n  return function (property, compactable) {\n    if (!property.multiplex) return restoreWith(property, compactable, true);\n    var multiplexSize = 0;\n    var restored = [];\n    var componentMultiplexSoFar = {};\n    var i, l; // At this point we don't know what's the multiplex size, e.g. how many background layers are there\n\n    for (i = 0, l = property.components[0].value.length; i < l; i++) {\n      if (property.components[0].value[i][1] == Marker.COMMA) multiplexSize++;\n    }\n\n    for (i = 0; i <= multiplexSize; i++) {\n      var _property = shallowClone(property); // We split multiplex into parts and restore them one by one\n\n\n      for (var j = 0, m = property.components.length; j < m; j++) {\n        var componentToClone = property.components[j];\n\n        var _component = shallowClone(componentToClone);\n\n        _property.components.push(_component); // The trick is some properties has more than one value, so we iterate over values looking for\n        // a multiplex separator - a comma\n\n\n        for (var k = componentMultiplexSoFar[_component.name] || 0, n = componentToClone.value.length; k < n; k++) {\n          if (componentToClone.value[k][1] == Marker.COMMA) {\n            componentMultiplexSoFar[_component.name] = k + 1;\n            break;\n          }\n\n          _component.value.push(componentToClone.value[k]);\n        }\n      } // No we can restore shorthand value\n\n\n      var lastInMultiplex = i == multiplexSize;\n\n      var _restored = restoreWith(_property, compactable, lastInMultiplex);\n\n      Array.prototype.push.apply(restored, _restored);\n      if (i < multiplexSize) restored.push([Token.PROPERTY_VALUE, Marker.COMMA]);\n    }\n\n    return restored;\n  };\n}\n\nfunction withoutDefaults(property, compactable) {\n  var components = property.components;\n  var restored = [];\n\n  for (var i = components.length - 1; i >= 0; i--) {\n    var component = components[i];\n    var descriptor = compactable[component.name];\n\n    if (component.value[0][1] != descriptor.defaultValue || 'keepUnlessDefault' in descriptor && !isDefault(components, compactable, descriptor.keepUnlessDefault)) {\n      restored.unshift(component.value[0]);\n    }\n  }\n\n  if (restored.length === 0) restored.push([Token.PROPERTY_VALUE, compactable[property.name].defaultValue]);\n  if (isInheritOnly(restored)) return [restored[0]];\n  return restored;\n}\n\nfunction isDefault(components, compactable, propertyName) {\n  var component;\n  var i, l;\n\n  for (i = 0, l = components.length; i < l; i++) {\n    component = components[i];\n\n    if (component.name == propertyName && component.value[0][1] == compactable[propertyName].defaultValue) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nmodule.exports = {\n  background: background,\n  borderRadius: borderRadius,\n  font: font,\n  fourValues: fourValues,\n  multiplex: multiplex,\n  withoutDefaults: withoutDefaults\n};","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/clean-css/lib/optimizer/level-2/restore.js"],"names":["shallowClone","require","shallow","Token","Marker","isInheritOnly","values","i","l","length","value","COMMA","FORWARD_SLASH","background","property","compactable","lastInMultiplex","components","restored","needsOne","needsBoth","restoreValue","component","Array","prototype","unshift","apply","isDefaultValue","descriptor","name","doubleValues","defaultValue","isDefault","originComponent","isOriginDefault","positionComponent","isPositionDefault","PROPERTY_VALUE","multiplexLastOnly","push","borderRadius","multiplex","horizontal","vertical","horizontalComponent","verticalComponent","horizontalValues","fourValues","verticalValues","concat","font","componentIndex","fontFamilyIndex","indexOf","INTERNAL","substring","value1","value2","value3","value4","restoreWith","multiplexSize","componentMultiplexSoFar","_property","j","m","componentToClone","_component","k","n","_restored","withoutDefaults","keepUnlessDefault","propertyName","module","exports"],"mappings":"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","sourcesContent":["var shallowClone = require('./clone').shallow;\n\nvar Token = require('../../tokenizer/token');\nvar Marker = require('../../tokenizer/marker');\n\nfunction isInheritOnly(values) {\n  for (var i = 0, l = values.length; i < l; i++) {\n    var value = values[i][1];\n\n    if (value != 'inherit' && value != Marker.COMMA && value != Marker.FORWARD_SLASH)\n      return false;\n  }\n\n  return true;\n}\n\nfunction background(property, compactable, lastInMultiplex) {\n  var components = property.components;\n  var restored = [];\n  var needsOne, needsBoth;\n\n  function restoreValue(component) {\n    Array.prototype.unshift.apply(restored, component.value);\n  }\n\n  function isDefaultValue(component) {\n    var descriptor = compactable[component.name];\n\n    if (descriptor.doubleValues && descriptor.defaultValue.length == 1) {\n      return component.value[0][1] == descriptor.defaultValue[0] && (component.value[1] ? component.value[1][1] == descriptor.defaultValue[0] : true);\n    } else if (descriptor.doubleValues && descriptor.defaultValue.length != 1) {\n      return component.value[0][1] == descriptor.defaultValue[0] && (component.value[1] ? component.value[1][1] : component.value[0][1]) == descriptor.defaultValue[1];\n    } else {\n      return component.value[0][1] == descriptor.defaultValue;\n    }\n  }\n\n  for (var i = components.length - 1; i >= 0; i--) {\n    var component = components[i];\n    var isDefault = isDefaultValue(component);\n\n    if (component.name == 'background-clip') {\n      var originComponent = components[i - 1];\n      var isOriginDefault = isDefaultValue(originComponent);\n\n      needsOne = component.value[0][1] == originComponent.value[0][1];\n\n      needsBoth = !needsOne && (\n        (isOriginDefault && !isDefault) ||\n        (!isOriginDefault && !isDefault) ||\n        (!isOriginDefault && isDefault && component.value[0][1] != originComponent.value[0][1]));\n\n      if (needsOne) {\n        restoreValue(originComponent);\n      } else if (needsBoth) {\n        restoreValue(component);\n        restoreValue(originComponent);\n      }\n\n      i--;\n    } else if (component.name == 'background-size') {\n      var positionComponent = components[i - 1];\n      var isPositionDefault = isDefaultValue(positionComponent);\n\n      needsOne = !isPositionDefault && isDefault;\n\n      needsBoth = !needsOne &&\n        (isPositionDefault && !isDefault || !isPositionDefault && !isDefault);\n\n      if (needsOne) {\n        restoreValue(positionComponent);\n      } else if (needsBoth) {\n        restoreValue(component);\n        restored.unshift([Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]);\n        restoreValue(positionComponent);\n      } else if (positionComponent.value.length == 1) {\n        restoreValue(positionComponent);\n      }\n\n      i--;\n    } else {\n      if (isDefault || compactable[component.name].multiplexLastOnly && !lastInMultiplex)\n        continue;\n\n      restoreValue(component);\n    }\n  }\n\n  if (restored.length === 0 && property.value.length == 1 && property.value[0][1] == '0')\n    restored.push(property.value[0]);\n\n  if (restored.length === 0)\n    restored.push([Token.PROPERTY_VALUE, compactable[property.name].defaultValue]);\n\n  if (isInheritOnly(restored))\n    return [restored[0]];\n\n  return restored;\n}\n\nfunction borderRadius(property, compactable) {\n  if (property.multiplex) {\n    var horizontal = shallowClone(property);\n    var vertical = shallowClone(property);\n\n    for (var i = 0; i < 4; i++) {\n      var component = property.components[i];\n\n      var horizontalComponent = shallowClone(property);\n      horizontalComponent.value = [component.value[0]];\n      horizontal.components.push(horizontalComponent);\n\n      var verticalComponent = shallowClone(property);\n      // FIXME: only shorthand compactor (see breakup#borderRadius) knows that border radius\n      // longhands have two values, whereas tokenizer does not care about populating 2nd value\n      // if it's missing, hence this fallback\n      verticalComponent.value = [component.value[1] || component.value[0]];\n      vertical.components.push(verticalComponent);\n    }\n\n    var horizontalValues = fourValues(horizontal, compactable);\n    var verticalValues = fourValues(vertical, compactable);\n\n    if (horizontalValues.length == verticalValues.length &&\n        horizontalValues[0][1] == verticalValues[0][1] &&\n        (horizontalValues.length > 1 ? horizontalValues[1][1] == verticalValues[1][1] : true) &&\n        (horizontalValues.length > 2 ? horizontalValues[2][1] == verticalValues[2][1] : true) &&\n        (horizontalValues.length > 3 ? horizontalValues[3][1] == verticalValues[3][1] : true)) {\n      return horizontalValues;\n    } else {\n      return horizontalValues.concat([[Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]]).concat(verticalValues);\n    }\n  } else {\n    return fourValues(property, compactable);\n  }\n}\n\nfunction font(property, compactable) {\n  var components = property.components;\n  var restored = [];\n  var component;\n  var componentIndex = 0;\n  var fontFamilyIndex = 0;\n\n  if (property.value[0][1].indexOf(Marker.INTERNAL) === 0) {\n    property.value[0][1] = property.value[0][1].substring(Marker.INTERNAL.length);\n    return property.value;\n  }\n\n  // first four components are optional\n  while (componentIndex < 4) {\n    component = components[componentIndex];\n\n    if (component.value[0][1] != compactable[component.name].defaultValue) {\n      Array.prototype.push.apply(restored, component.value);\n    }\n\n    componentIndex++;\n  }\n\n  // then comes font-size\n  Array.prototype.push.apply(restored, components[componentIndex].value);\n  componentIndex++;\n\n  // then may come line-height\n  if (components[componentIndex].value[0][1] != compactable[components[componentIndex].name].defaultValue) {\n    Array.prototype.push.apply(restored, [[Token.PROPERTY_VALUE, Marker.FORWARD_SLASH]]);\n    Array.prototype.push.apply(restored, components[componentIndex].value);\n  }\n\n  componentIndex++;\n\n  // then comes font-family\n  while (components[componentIndex].value[fontFamilyIndex]) {\n    restored.push(components[componentIndex].value[fontFamilyIndex]);\n\n    if (components[componentIndex].value[fontFamilyIndex + 1]) {\n      restored.push([Token.PROPERTY_VALUE, Marker.COMMA]);\n    }\n\n    fontFamilyIndex++;\n  }\n\n  if (isInheritOnly(restored)) {\n    return [restored[0]];\n  }\n\n  return restored;\n}\n\nfunction fourValues(property) {\n  var components = property.components;\n  var value1 = components[0].value[0];\n  var value2 = components[1].value[0];\n  var value3 = components[2].value[0];\n  var value4 = components[3].value[0];\n\n  if (value1[1] == value2[1] && value1[1] == value3[1] && value1[1] == value4[1]) {\n    return [value1];\n  } else if (value1[1] == value3[1] && value2[1] == value4[1]) {\n    return [value1, value2];\n  } else if (value2[1] == value4[1]) {\n    return [value1, value2, value3];\n  } else {\n    return [value1, value2, value3, value4];\n  }\n}\n\nfunction multiplex(restoreWith) {\n  return function (property, compactable) {\n    if (!property.multiplex)\n      return restoreWith(property, compactable, true);\n\n    var multiplexSize = 0;\n    var restored = [];\n    var componentMultiplexSoFar = {};\n    var i, l;\n\n    // At this point we don't know what's the multiplex size, e.g. how many background layers are there\n    for (i = 0, l = property.components[0].value.length; i < l; i++) {\n      if (property.components[0].value[i][1] == Marker.COMMA)\n        multiplexSize++;\n    }\n\n    for (i = 0; i <= multiplexSize; i++) {\n      var _property = shallowClone(property);\n\n      // We split multiplex into parts and restore them one by one\n      for (var j = 0, m = property.components.length; j < m; j++) {\n        var componentToClone = property.components[j];\n        var _component = shallowClone(componentToClone);\n        _property.components.push(_component);\n\n        // The trick is some properties has more than one value, so we iterate over values looking for\n        // a multiplex separator - a comma\n        for (var k = componentMultiplexSoFar[_component.name] || 0, n = componentToClone.value.length; k < n; k++) {\n          if (componentToClone.value[k][1] == Marker.COMMA) {\n            componentMultiplexSoFar[_component.name] = k + 1;\n            break;\n          }\n\n          _component.value.push(componentToClone.value[k]);\n        }\n      }\n\n      // No we can restore shorthand value\n      var lastInMultiplex = i == multiplexSize;\n      var _restored = restoreWith(_property, compactable, lastInMultiplex);\n      Array.prototype.push.apply(restored, _restored);\n\n      if (i < multiplexSize)\n        restored.push([Token.PROPERTY_VALUE, Marker.COMMA]);\n    }\n\n    return restored;\n  };\n}\n\nfunction withoutDefaults(property, compactable) {\n  var components = property.components;\n  var restored = [];\n\n  for (var i = components.length - 1; i >= 0; i--) {\n    var component = components[i];\n    var descriptor = compactable[component.name];\n\n    if (component.value[0][1] != descriptor.defaultValue || ('keepUnlessDefault' in descriptor) && !isDefault(components, compactable, descriptor.keepUnlessDefault)) {\n      restored.unshift(component.value[0]);\n    }\n  }\n\n  if (restored.length === 0)\n    restored.push([Token.PROPERTY_VALUE, compactable[property.name].defaultValue]);\n\n  if (isInheritOnly(restored))\n    return [restored[0]];\n\n  return restored;\n}\n\nfunction isDefault(components, compactable, propertyName) {\n  var component;\n  var i, l;\n\n  for (i = 0, l = components.length; i < l; i++) {\n    component = components[i];\n\n    if (component.name == propertyName && component.value[0][1] == compactable[propertyName].defaultValue) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nmodule.exports = {\n  background: background,\n  borderRadius: borderRadius,\n  font: font,\n  fourValues: fourValues,\n  multiplex: multiplex,\n  withoutDefaults: withoutDefaults\n};\n"]},"metadata":{},"sourceType":"script"}