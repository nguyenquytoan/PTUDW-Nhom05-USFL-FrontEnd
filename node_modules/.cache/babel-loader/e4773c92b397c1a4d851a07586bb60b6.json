{"ast":null,"code":"var resolveProperty = require('css-tree').property;\n\nvar resolveKeyword = require('css-tree').keyword;\n\nvar walk = require('css-tree').walk;\n\nvar generate = require('css-tree').generate;\n\nvar fingerprintId = 1;\nvar dontRestructure = {\n  'src': 1 // https://github.com/afelix/csso/issues/50\n\n};\nvar DONT_MIX_VALUE = {\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/display#Browser_compatibility\n  'display': /table|ruby|flex|-(flex)?box$|grid|contents|run-in/i,\n  // https://developer.mozilla.org/en/docs/Web/CSS/text-align\n  'text-align': /^(start|end|match-parent|justify-all)$/i\n};\nvar CURSOR_SAFE_VALUE = ['auto', 'crosshair', 'default', 'move', 'text', 'wait', 'help', 'n-resize', 'e-resize', 's-resize', 'w-resize', 'ne-resize', 'nw-resize', 'se-resize', 'sw-resize', 'pointer', 'progress', 'not-allowed', 'no-drop', 'vertical-text', 'all-scroll', 'col-resize', 'row-resize'];\nvar POSITION_SAFE_VALUE = ['static', 'relative', 'absolute', 'fixed'];\nvar NEEDLESS_TABLE = {\n  'border-width': ['border'],\n  'border-style': ['border'],\n  'border-color': ['border'],\n  'border-top': ['border'],\n  'border-right': ['border'],\n  'border-bottom': ['border'],\n  'border-left': ['border'],\n  'border-top-width': ['border-top', 'border-width', 'border'],\n  'border-right-width': ['border-right', 'border-width', 'border'],\n  'border-bottom-width': ['border-bottom', 'border-width', 'border'],\n  'border-left-width': ['border-left', 'border-width', 'border'],\n  'border-top-style': ['border-top', 'border-style', 'border'],\n  'border-right-style': ['border-right', 'border-style', 'border'],\n  'border-bottom-style': ['border-bottom', 'border-style', 'border'],\n  'border-left-style': ['border-left', 'border-style', 'border'],\n  'border-top-color': ['border-top', 'border-color', 'border'],\n  'border-right-color': ['border-right', 'border-color', 'border'],\n  'border-bottom-color': ['border-bottom', 'border-color', 'border'],\n  'border-left-color': ['border-left', 'border-color', 'border'],\n  'margin-top': ['margin'],\n  'margin-right': ['margin'],\n  'margin-bottom': ['margin'],\n  'margin-left': ['margin'],\n  'padding-top': ['padding'],\n  'padding-right': ['padding'],\n  'padding-bottom': ['padding'],\n  'padding-left': ['padding'],\n  'font-style': ['font'],\n  'font-variant': ['font'],\n  'font-weight': ['font'],\n  'font-size': ['font'],\n  'font-family': ['font'],\n  'list-style-type': ['list-style'],\n  'list-style-position': ['list-style'],\n  'list-style-image': ['list-style']\n};\n\nfunction getPropertyFingerprint(propertyName, declaration, fingerprints) {\n  var realName = resolveProperty(propertyName).basename;\n\n  if (realName === 'background') {\n    return propertyName + ':' + generate(declaration.value);\n  }\n\n  var declarationId = declaration.id;\n  var fingerprint = fingerprints[declarationId];\n\n  if (!fingerprint) {\n    switch (declaration.value.type) {\n      case 'Value':\n        var vendorId = '';\n        var iehack = '';\n        var special = {};\n        var raw = false;\n        declaration.value.children.each(function walk(node) {\n          switch (node.type) {\n            case 'Value':\n            case 'Brackets':\n            case 'Parentheses':\n              node.children.each(walk);\n              break;\n\n            case 'Raw':\n              raw = true;\n              break;\n\n            case 'Identifier':\n              var name = node.name;\n\n              if (!vendorId) {\n                vendorId = resolveKeyword(name).vendor;\n              }\n\n              if (/\\\\[09]/.test(name)) {\n                iehack = RegExp.lastMatch;\n              }\n\n              if (realName === 'cursor') {\n                if (CURSOR_SAFE_VALUE.indexOf(name) === -1) {\n                  special[name] = true;\n                }\n              } else if (realName === 'position') {\n                if (POSITION_SAFE_VALUE.indexOf(name) === -1) {\n                  special[name] = true;\n                }\n              } else if (DONT_MIX_VALUE.hasOwnProperty(realName)) {\n                if (DONT_MIX_VALUE[realName].test(name)) {\n                  special[name] = true;\n                }\n              }\n\n              break;\n\n            case 'Function':\n              var name = node.name;\n\n              if (!vendorId) {\n                vendorId = resolveKeyword(name).vendor;\n              }\n\n              if (name === 'rect') {\n                // there are 2 forms of rect:\n                //   rect(<top>, <right>, <bottom>, <left>) - standart\n                //   rect(<top> <right> <bottom> <left>) – backwards compatible syntax\n                // only the same form values can be merged\n                var hasComma = node.children.some(function (node) {\n                  return node.type === 'Operator' && node.value === ',';\n                });\n\n                if (!hasComma) {\n                  name = 'rect-backward';\n                }\n              }\n\n              special[name + '()'] = true; // check nested tokens too\n\n              node.children.each(walk);\n              break;\n\n            case 'Dimension':\n              var unit = node.unit;\n\n              if (/\\\\[09]/.test(unit)) {\n                iehack = RegExp.lastMatch;\n              }\n\n              switch (unit) {\n                // is not supported until IE11\n                case 'rem': // v* units is too buggy across browsers and better\n                // don't merge values with those units\n\n                case 'vw':\n                case 'vh':\n                case 'vmin':\n                case 'vmax':\n                case 'vm':\n                  // IE9 supporting \"vm\" instead of \"vmin\".\n                  special[unit] = true;\n                  break;\n              }\n\n              break;\n          }\n        });\n        fingerprint = raw ? '!' + fingerprintId++ : '!' + Object.keys(special).sort() + '|' + iehack + vendorId;\n        break;\n\n      case 'Raw':\n        fingerprint = '!' + declaration.value.value;\n        break;\n\n      default:\n        fingerprint = generate(declaration.value);\n    }\n\n    fingerprints[declarationId] = fingerprint;\n  }\n\n  return propertyName + fingerprint;\n}\n\nfunction needless(props, declaration, fingerprints) {\n  var property = resolveProperty(declaration.property);\n\n  if (NEEDLESS_TABLE.hasOwnProperty(property.basename)) {\n    var table = NEEDLESS_TABLE[property.basename];\n\n    for (var i = 0; i < table.length; i++) {\n      var ppre = getPropertyFingerprint(property.prefix + table[i], declaration, fingerprints);\n      var prev = props.hasOwnProperty(ppre) ? props[ppre] : null;\n\n      if (prev && (!declaration.important || prev.item.data.important)) {\n        return prev;\n      }\n    }\n  }\n}\n\nfunction processRule(rule, item, list, props, fingerprints) {\n  var declarations = rule.block.children;\n  declarations.eachRight(function (declaration, declarationItem) {\n    var property = declaration.property;\n    var fingerprint = getPropertyFingerprint(property, declaration, fingerprints);\n    var prev = props[fingerprint];\n\n    if (prev && !dontRestructure.hasOwnProperty(property)) {\n      if (declaration.important && !prev.item.data.important) {\n        props[fingerprint] = {\n          block: declarations,\n          item: declarationItem\n        };\n        prev.block.remove(prev.item); // TODO: use it when we can refer to several points in source\n        // declaration.loc = {\n        //     primary: declaration.loc,\n        //     merged: prev.item.data.loc\n        // };\n      } else {\n        declarations.remove(declarationItem); // TODO: use it when we can refer to several points in source\n        // prev.item.data.loc = {\n        //     primary: prev.item.data.loc,\n        //     merged: declaration.loc\n        // };\n      }\n    } else {\n      var prev = needless(props, declaration, fingerprints);\n\n      if (prev) {\n        declarations.remove(declarationItem); // TODO: use it when we can refer to several points in source\n        // prev.item.data.loc = {\n        //     primary: prev.item.data.loc,\n        //     merged: declaration.loc\n        // };\n      } else {\n        declaration.fingerprint = fingerprint;\n        props[fingerprint] = {\n          block: declarations,\n          item: declarationItem\n        };\n      }\n    }\n  });\n\n  if (declarations.isEmpty()) {\n    list.remove(item);\n  }\n}\n\nmodule.exports = function restructBlock(ast) {\n  var stylesheetMap = {};\n  var fingerprints = Object.create(null);\n  walk(ast, {\n    visit: 'Rule',\n    reverse: true,\n    enter: function (node, item, list) {\n      var stylesheet = this.block || this.stylesheet;\n      var ruleId = (node.pseudoSignature || '') + '|' + node.prelude.children.first().id;\n      var ruleMap;\n      var props;\n\n      if (!stylesheetMap.hasOwnProperty(stylesheet.id)) {\n        ruleMap = {};\n        stylesheetMap[stylesheet.id] = ruleMap;\n      } else {\n        ruleMap = stylesheetMap[stylesheet.id];\n      }\n\n      if (ruleMap.hasOwnProperty(ruleId)) {\n        props = ruleMap[ruleId];\n      } else {\n        props = {};\n        ruleMap[ruleId] = props;\n      }\n\n      processRule.call(this, node, item, list, props, fingerprints);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/csso/lib/restructure/6-restructBlock.js"],"names":["resolveProperty","require","property","resolveKeyword","keyword","walk","generate","fingerprintId","dontRestructure","DONT_MIX_VALUE","CURSOR_SAFE_VALUE","POSITION_SAFE_VALUE","NEEDLESS_TABLE","getPropertyFingerprint","propertyName","declaration","fingerprints","realName","basename","value","declarationId","id","fingerprint","type","vendorId","iehack","special","raw","children","each","node","name","vendor","test","RegExp","lastMatch","indexOf","hasOwnProperty","hasComma","some","unit","Object","keys","sort","needless","props","table","i","length","ppre","prefix","prev","important","item","data","processRule","rule","list","declarations","block","eachRight","declarationItem","remove","isEmpty","module","exports","restructBlock","ast","stylesheetMap","create","visit","reverse","enter","stylesheet","ruleId","pseudoSignature","prelude","first","ruleMap","call"],"mappings":"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","sourcesContent":["var resolveProperty = require('css-tree').property;\nvar resolveKeyword = require('css-tree').keyword;\nvar walk = require('css-tree').walk;\nvar generate = require('css-tree').generate;\nvar fingerprintId = 1;\nvar dontRestructure = {\n    'src': 1 // https://github.com/afelix/csso/issues/50\n};\n\nvar DONT_MIX_VALUE = {\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/display#Browser_compatibility\n    'display': /table|ruby|flex|-(flex)?box$|grid|contents|run-in/i,\n    // https://developer.mozilla.org/en/docs/Web/CSS/text-align\n    'text-align': /^(start|end|match-parent|justify-all)$/i\n};\n\nvar CURSOR_SAFE_VALUE = [\n    'auto', 'crosshair', 'default', 'move', 'text', 'wait', 'help',\n    'n-resize', 'e-resize', 's-resize', 'w-resize',\n    'ne-resize', 'nw-resize', 'se-resize', 'sw-resize',\n    'pointer', 'progress', 'not-allowed', 'no-drop', 'vertical-text', 'all-scroll',\n    'col-resize', 'row-resize'\n];\n\nvar POSITION_SAFE_VALUE = [\n    'static', 'relative', 'absolute', 'fixed'\n];\n\nvar NEEDLESS_TABLE = {\n    'border-width': ['border'],\n    'border-style': ['border'],\n    'border-color': ['border'],\n    'border-top': ['border'],\n    'border-right': ['border'],\n    'border-bottom': ['border'],\n    'border-left': ['border'],\n    'border-top-width': ['border-top', 'border-width', 'border'],\n    'border-right-width': ['border-right', 'border-width', 'border'],\n    'border-bottom-width': ['border-bottom', 'border-width', 'border'],\n    'border-left-width': ['border-left', 'border-width', 'border'],\n    'border-top-style': ['border-top', 'border-style', 'border'],\n    'border-right-style': ['border-right', 'border-style', 'border'],\n    'border-bottom-style': ['border-bottom', 'border-style', 'border'],\n    'border-left-style': ['border-left', 'border-style', 'border'],\n    'border-top-color': ['border-top', 'border-color', 'border'],\n    'border-right-color': ['border-right', 'border-color', 'border'],\n    'border-bottom-color': ['border-bottom', 'border-color', 'border'],\n    'border-left-color': ['border-left', 'border-color', 'border'],\n    'margin-top': ['margin'],\n    'margin-right': ['margin'],\n    'margin-bottom': ['margin'],\n    'margin-left': ['margin'],\n    'padding-top': ['padding'],\n    'padding-right': ['padding'],\n    'padding-bottom': ['padding'],\n    'padding-left': ['padding'],\n    'font-style': ['font'],\n    'font-variant': ['font'],\n    'font-weight': ['font'],\n    'font-size': ['font'],\n    'font-family': ['font'],\n    'list-style-type': ['list-style'],\n    'list-style-position': ['list-style'],\n    'list-style-image': ['list-style']\n};\n\nfunction getPropertyFingerprint(propertyName, declaration, fingerprints) {\n    var realName = resolveProperty(propertyName).basename;\n\n    if (realName === 'background') {\n        return propertyName + ':' + generate(declaration.value);\n    }\n\n    var declarationId = declaration.id;\n    var fingerprint = fingerprints[declarationId];\n\n    if (!fingerprint) {\n        switch (declaration.value.type) {\n            case 'Value':\n                var vendorId = '';\n                var iehack = '';\n                var special = {};\n                var raw = false;\n\n                declaration.value.children.each(function walk(node) {\n                    switch (node.type) {\n                        case 'Value':\n                        case 'Brackets':\n                        case 'Parentheses':\n                            node.children.each(walk);\n                            break;\n\n                        case 'Raw':\n                            raw = true;\n                            break;\n\n                        case 'Identifier':\n                            var name = node.name;\n\n                            if (!vendorId) {\n                                vendorId = resolveKeyword(name).vendor;\n                            }\n\n                            if (/\\\\[09]/.test(name)) {\n                                iehack = RegExp.lastMatch;\n                            }\n\n                            if (realName === 'cursor') {\n                                if (CURSOR_SAFE_VALUE.indexOf(name) === -1) {\n                                    special[name] = true;\n                                }\n                            } else if (realName === 'position') {\n                                if (POSITION_SAFE_VALUE.indexOf(name) === -1) {\n                                    special[name] = true;\n                                }\n                            } else if (DONT_MIX_VALUE.hasOwnProperty(realName)) {\n                                if (DONT_MIX_VALUE[realName].test(name)) {\n                                    special[name] = true;\n                                }\n                            }\n\n                            break;\n\n                        case 'Function':\n                            var name = node.name;\n\n                            if (!vendorId) {\n                                vendorId = resolveKeyword(name).vendor;\n                            }\n\n                            if (name === 'rect') {\n                                // there are 2 forms of rect:\n                                //   rect(<top>, <right>, <bottom>, <left>) - standart\n                                //   rect(<top> <right> <bottom> <left>) – backwards compatible syntax\n                                // only the same form values can be merged\n                                var hasComma = node.children.some(function(node) {\n                                    return node.type === 'Operator' && node.value === ',';\n                                });\n                                if (!hasComma) {\n                                    name = 'rect-backward';\n                                }\n                            }\n\n                            special[name + '()'] = true;\n\n                            // check nested tokens too\n                            node.children.each(walk);\n\n                            break;\n\n                        case 'Dimension':\n                            var unit = node.unit;\n\n                            if (/\\\\[09]/.test(unit)) {\n                                iehack = RegExp.lastMatch;\n                            }\n\n                            switch (unit) {\n                                // is not supported until IE11\n                                case 'rem':\n\n                                // v* units is too buggy across browsers and better\n                                // don't merge values with those units\n                                case 'vw':\n                                case 'vh':\n                                case 'vmin':\n                                case 'vmax':\n                                case 'vm': // IE9 supporting \"vm\" instead of \"vmin\".\n                                    special[unit] = true;\n                                    break;\n                            }\n                            break;\n                    }\n                });\n\n                fingerprint = raw\n                    ? '!' + fingerprintId++\n                    : '!' + Object.keys(special).sort() + '|' + iehack + vendorId;\n                break;\n\n            case 'Raw':\n                fingerprint = '!' + declaration.value.value;\n                break;\n\n            default:\n                fingerprint = generate(declaration.value);\n        }\n\n        fingerprints[declarationId] = fingerprint;\n    }\n\n    return propertyName + fingerprint;\n}\n\nfunction needless(props, declaration, fingerprints) {\n    var property = resolveProperty(declaration.property);\n\n    if (NEEDLESS_TABLE.hasOwnProperty(property.basename)) {\n        var table = NEEDLESS_TABLE[property.basename];\n\n        for (var i = 0; i < table.length; i++) {\n            var ppre = getPropertyFingerprint(property.prefix + table[i], declaration, fingerprints);\n            var prev = props.hasOwnProperty(ppre) ? props[ppre] : null;\n\n            if (prev && (!declaration.important || prev.item.data.important)) {\n                return prev;\n            }\n        }\n    }\n}\n\nfunction processRule(rule, item, list, props, fingerprints) {\n    var declarations = rule.block.children;\n\n    declarations.eachRight(function(declaration, declarationItem) {\n        var property = declaration.property;\n        var fingerprint = getPropertyFingerprint(property, declaration, fingerprints);\n        var prev = props[fingerprint];\n\n        if (prev && !dontRestructure.hasOwnProperty(property)) {\n            if (declaration.important && !prev.item.data.important) {\n                props[fingerprint] = {\n                    block: declarations,\n                    item: declarationItem\n                };\n\n                prev.block.remove(prev.item);\n\n                // TODO: use it when we can refer to several points in source\n                // declaration.loc = {\n                //     primary: declaration.loc,\n                //     merged: prev.item.data.loc\n                // };\n            } else {\n                declarations.remove(declarationItem);\n\n                // TODO: use it when we can refer to several points in source\n                // prev.item.data.loc = {\n                //     primary: prev.item.data.loc,\n                //     merged: declaration.loc\n                // };\n            }\n        } else {\n            var prev = needless(props, declaration, fingerprints);\n\n            if (prev) {\n                declarations.remove(declarationItem);\n\n                // TODO: use it when we can refer to several points in source\n                // prev.item.data.loc = {\n                //     primary: prev.item.data.loc,\n                //     merged: declaration.loc\n                // };\n            } else {\n                declaration.fingerprint = fingerprint;\n\n                props[fingerprint] = {\n                    block: declarations,\n                    item: declarationItem\n                };\n            }\n        }\n    });\n\n    if (declarations.isEmpty()) {\n        list.remove(item);\n    }\n}\n\nmodule.exports = function restructBlock(ast) {\n    var stylesheetMap = {};\n    var fingerprints = Object.create(null);\n\n    walk(ast, {\n        visit: 'Rule',\n        reverse: true,\n        enter: function(node, item, list) {\n            var stylesheet = this.block || this.stylesheet;\n            var ruleId = (node.pseudoSignature || '') + '|' + node.prelude.children.first().id;\n            var ruleMap;\n            var props;\n\n            if (!stylesheetMap.hasOwnProperty(stylesheet.id)) {\n                ruleMap = {};\n                stylesheetMap[stylesheet.id] = ruleMap;\n            } else {\n                ruleMap = stylesheetMap[stylesheet.id];\n            }\n\n            if (ruleMap.hasOwnProperty(ruleId)) {\n                props = ruleMap[ruleId];\n            } else {\n                props = {};\n                ruleMap[ruleId] = props;\n            }\n\n            processRule.call(this, node, item, list, props, fingerprints);\n        }\n    });\n};\n"]},"metadata":{},"sourceType":"script"}