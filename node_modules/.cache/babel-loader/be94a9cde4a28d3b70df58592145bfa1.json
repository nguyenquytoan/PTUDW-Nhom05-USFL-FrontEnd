{"ast":null,"code":"var walk = require('css-tree').walk;\n\nvar utils = require('./utils');\n/*\n    At this step all rules has single simple selector. We try to join by equal\n    declaration blocks to first rule, e.g.\n\n    .a { color: red }\n    b { ... }\n    .b { color: red }\n    ->\n    .a, .b { color: red }\n    b { ... }\n*/\n\n\nfunction processRule(node, item, list) {\n  var selectors = node.prelude.children;\n  var declarations = node.block.children;\n  var nodeCompareMarker = selectors.first().compareMarker;\n  var skippedCompareMarkers = {};\n  list.nextUntil(item.next, function (next, nextItem) {\n    // skip non-ruleset node if safe\n    if (next.type !== 'Rule') {\n      return utils.unsafeToSkipNode.call(selectors, next);\n    }\n\n    if (node.pseudoSignature !== next.pseudoSignature) {\n      return true;\n    }\n\n    var nextFirstSelector = next.prelude.children.head;\n    var nextDeclarations = next.block.children;\n    var nextCompareMarker = nextFirstSelector.data.compareMarker; // if next ruleset has same marked as one of skipped then stop joining\n\n    if (nextCompareMarker in skippedCompareMarkers) {\n      return true;\n    } // try to join by selectors\n\n\n    if (selectors.head === selectors.tail) {\n      if (selectors.first().id === nextFirstSelector.data.id) {\n        declarations.appendList(nextDeclarations);\n        list.remove(nextItem);\n        return;\n      }\n    } // try to join by properties\n\n\n    if (utils.isEqualDeclarations(declarations, nextDeclarations)) {\n      var nextStr = nextFirstSelector.data.id;\n      selectors.some(function (data, item) {\n        var curStr = data.id;\n\n        if (nextStr < curStr) {\n          selectors.insert(nextFirstSelector, item);\n          return true;\n        }\n\n        if (!item.next) {\n          selectors.insert(nextFirstSelector);\n          return true;\n        }\n      });\n      list.remove(nextItem);\n      return;\n    } // go to next ruleset if current one can be skipped (has no equal specificity nor element selector)\n\n\n    if (nextCompareMarker === nodeCompareMarker) {\n      return true;\n    }\n\n    skippedCompareMarkers[nextCompareMarker] = true;\n  });\n}\n\nmodule.exports = function mergeRule(ast) {\n  walk(ast, {\n    visit: 'Rule',\n    enter: processRule\n  });\n};","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/csso/lib/restructure/7-mergeRuleset.js"],"names":["walk","require","utils","processRule","node","item","list","selectors","prelude","children","declarations","block","nodeCompareMarker","first","compareMarker","skippedCompareMarkers","nextUntil","next","nextItem","type","unsafeToSkipNode","call","pseudoSignature","nextFirstSelector","head","nextDeclarations","nextCompareMarker","data","tail","id","appendList","remove","isEqualDeclarations","nextStr","some","curStr","insert","module","exports","mergeRule","ast","visit","enter"],"mappings":"AAAA,IAAIA,IAAI,GAAGC,OAAO,CAAC,UAAD,CAAP,CAAoBD,IAA/B;;AACA,IAAIE,KAAK,GAAGD,OAAO,CAAC,SAAD,CAAnB;AAEA;;;;;;;;;;;;;AAYA,SAASE,WAAT,CAAqBC,IAArB,EAA2BC,IAA3B,EAAiCC,IAAjC,EAAuC;AACnC,MAAIC,SAAS,GAAGH,IAAI,CAACI,OAAL,CAAaC,QAA7B;AACA,MAAIC,YAAY,GAAGN,IAAI,CAACO,KAAL,CAAWF,QAA9B;AACA,MAAIG,iBAAiB,GAAGL,SAAS,CAACM,KAAV,GAAkBC,aAA1C;AACA,MAAIC,qBAAqB,GAAG,EAA5B;AAEAT,EAAAA,IAAI,CAACU,SAAL,CAAeX,IAAI,CAACY,IAApB,EAA0B,UAASA,IAAT,EAAeC,QAAf,EAAyB;AAC/C;AACA,QAAID,IAAI,CAACE,IAAL,KAAc,MAAlB,EAA0B;AACtB,aAAOjB,KAAK,CAACkB,gBAAN,CAAuBC,IAAvB,CAA4Bd,SAA5B,EAAuCU,IAAvC,CAAP;AACH;;AAED,QAAIb,IAAI,CAACkB,eAAL,KAAyBL,IAAI,CAACK,eAAlC,EAAmD;AAC/C,aAAO,IAAP;AACH;;AAED,QAAIC,iBAAiB,GAAGN,IAAI,CAACT,OAAL,CAAaC,QAAb,CAAsBe,IAA9C;AACA,QAAIC,gBAAgB,GAAGR,IAAI,CAACN,KAAL,CAAWF,QAAlC;AACA,QAAIiB,iBAAiB,GAAGH,iBAAiB,CAACI,IAAlB,CAAuBb,aAA/C,CAZ+C,CAc/C;;AACA,QAAIY,iBAAiB,IAAIX,qBAAzB,EAAgD;AAC5C,aAAO,IAAP;AACH,KAjB8C,CAmB/C;;;AACA,QAAIR,SAAS,CAACiB,IAAV,KAAmBjB,SAAS,CAACqB,IAAjC,EAAuC;AACnC,UAAIrB,SAAS,CAACM,KAAV,GAAkBgB,EAAlB,KAAyBN,iBAAiB,CAACI,IAAlB,CAAuBE,EAApD,EAAwD;AACpDnB,QAAAA,YAAY,CAACoB,UAAb,CAAwBL,gBAAxB;AACAnB,QAAAA,IAAI,CAACyB,MAAL,CAAYb,QAAZ;AACA;AACH;AACJ,KA1B8C,CA4B/C;;;AACA,QAAIhB,KAAK,CAAC8B,mBAAN,CAA0BtB,YAA1B,EAAwCe,gBAAxC,CAAJ,EAA+D;AAC3D,UAAIQ,OAAO,GAAGV,iBAAiB,CAACI,IAAlB,CAAuBE,EAArC;AAEAtB,MAAAA,SAAS,CAAC2B,IAAV,CAAe,UAASP,IAAT,EAAetB,IAAf,EAAqB;AAChC,YAAI8B,MAAM,GAAGR,IAAI,CAACE,EAAlB;;AAEA,YAAII,OAAO,GAAGE,MAAd,EAAsB;AAClB5B,UAAAA,SAAS,CAAC6B,MAAV,CAAiBb,iBAAjB,EAAoClB,IAApC;AACA,iBAAO,IAAP;AACH;;AAED,YAAI,CAACA,IAAI,CAACY,IAAV,EAAgB;AACZV,UAAAA,SAAS,CAAC6B,MAAV,CAAiBb,iBAAjB;AACA,iBAAO,IAAP;AACH;AACJ,OAZD;AAcAjB,MAAAA,IAAI,CAACyB,MAAL,CAAYb,QAAZ;AACA;AACH,KAhD8C,CAkD/C;;;AACA,QAAIQ,iBAAiB,KAAKd,iBAA1B,EAA6C;AACzC,aAAO,IAAP;AACH;;AAEDG,IAAAA,qBAAqB,CAACW,iBAAD,CAArB,GAA2C,IAA3C;AACH,GAxDD;AAyDH;;AAEDW,MAAM,CAACC,OAAP,GAAiB,SAASC,SAAT,CAAmBC,GAAnB,EAAwB;AACrCxC,EAAAA,IAAI,CAACwC,GAAD,EAAM;AACNC,IAAAA,KAAK,EAAE,MADD;AAENC,IAAAA,KAAK,EAAEvC;AAFD,GAAN,CAAJ;AAIH,CALD","sourcesContent":["var walk = require('css-tree').walk;\nvar utils = require('./utils');\n\n/*\n    At this step all rules has single simple selector. We try to join by equal\n    declaration blocks to first rule, e.g.\n\n    .a { color: red }\n    b { ... }\n    .b { color: red }\n    ->\n    .a, .b { color: red }\n    b { ... }\n*/\n\nfunction processRule(node, item, list) {\n    var selectors = node.prelude.children;\n    var declarations = node.block.children;\n    var nodeCompareMarker = selectors.first().compareMarker;\n    var skippedCompareMarkers = {};\n\n    list.nextUntil(item.next, function(next, nextItem) {\n        // skip non-ruleset node if safe\n        if (next.type !== 'Rule') {\n            return utils.unsafeToSkipNode.call(selectors, next);\n        }\n\n        if (node.pseudoSignature !== next.pseudoSignature) {\n            return true;\n        }\n\n        var nextFirstSelector = next.prelude.children.head;\n        var nextDeclarations = next.block.children;\n        var nextCompareMarker = nextFirstSelector.data.compareMarker;\n\n        // if next ruleset has same marked as one of skipped then stop joining\n        if (nextCompareMarker in skippedCompareMarkers) {\n            return true;\n        }\n\n        // try to join by selectors\n        if (selectors.head === selectors.tail) {\n            if (selectors.first().id === nextFirstSelector.data.id) {\n                declarations.appendList(nextDeclarations);\n                list.remove(nextItem);\n                return;\n            }\n        }\n\n        // try to join by properties\n        if (utils.isEqualDeclarations(declarations, nextDeclarations)) {\n            var nextStr = nextFirstSelector.data.id;\n\n            selectors.some(function(data, item) {\n                var curStr = data.id;\n\n                if (nextStr < curStr) {\n                    selectors.insert(nextFirstSelector, item);\n                    return true;\n                }\n\n                if (!item.next) {\n                    selectors.insert(nextFirstSelector);\n                    return true;\n                }\n            });\n\n            list.remove(nextItem);\n            return;\n        }\n\n        // go to next ruleset if current one can be skipped (has no equal specificity nor element selector)\n        if (nextCompareMarker === nodeCompareMarker) {\n            return true;\n        }\n\n        skippedCompareMarkers[nextCompareMarker] = true;\n    });\n}\n\nmodule.exports = function mergeRule(ast) {\n    walk(ast, {\n        visit: 'Rule',\n        enter: processRule\n    });\n};\n"]},"metadata":{},"sourceType":"script"}