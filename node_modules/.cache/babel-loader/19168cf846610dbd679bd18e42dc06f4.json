{"ast":null,"code":"var stream = require('stream');\n\nvar pump = require('./index');\n\nvar rs = new stream.Readable();\nvar ws = new stream.Writable();\n\nrs._read = function (size) {\n  this.push(Buffer(size).fill('abc'));\n};\n\nws._write = function (chunk, encoding, cb) {\n  setTimeout(function () {\n    cb();\n  }, 100);\n};\n\nvar toHex = function () {\n  var reverse = new (require('stream').Transform)();\n\n  reverse._transform = function (chunk, enc, callback) {\n    reverse.push(chunk.toString('hex'));\n    callback();\n  };\n\n  return reverse;\n};\n\nvar wsClosed = false;\nvar rsClosed = false;\nvar callbackCalled = false;\n\nvar check = function () {\n  if (wsClosed && rsClosed && callbackCalled) {\n    console.log('test-browser.js passes');\n    clearTimeout(timeout);\n  }\n};\n\nws.on('finish', function () {\n  wsClosed = true;\n  check();\n});\nrs.on('end', function () {\n  rsClosed = true;\n  check();\n});\npump(rs, toHex(), toHex(), toHex(), ws, function () {\n  callbackCalled = true;\n  check();\n});\nsetTimeout(function () {\n  rs.push(null);\n  rs.emit('close');\n}, 1000);\nvar timeout = setTimeout(function () {\n  check();\n  throw new Error('timeout');\n}, 5000);","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/pumpify/node_modules/pump/test-browser.js"],"names":["stream","require","pump","rs","Readable","ws","Writable","_read","size","push","Buffer","fill","_write","chunk","encoding","cb","setTimeout","toHex","reverse","Transform","_transform","enc","callback","toString","wsClosed","rsClosed","callbackCalled","check","console","log","clearTimeout","timeout","on","emit","Error"],"mappings":"AAAA,IAAIA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAApB;;AACA,IAAIC,IAAI,GAAGD,OAAO,CAAC,SAAD,CAAlB;;AAEA,IAAIE,EAAE,GAAG,IAAIH,MAAM,CAACI,QAAX,EAAT;AACA,IAAIC,EAAE,GAAG,IAAIL,MAAM,CAACM,QAAX,EAAT;;AAEAH,EAAE,CAACI,KAAH,GAAW,UAAUC,IAAV,EAAgB;AACzB,OAAKC,IAAL,CAAUC,MAAM,CAACF,IAAD,CAAN,CAAaG,IAAb,CAAkB,KAAlB,CAAV;AACD,CAFD;;AAIAN,EAAE,CAACO,MAAH,GAAY,UAAUC,KAAV,EAAiBC,QAAjB,EAA2BC,EAA3B,EAA+B;AACzCC,EAAAA,UAAU,CAAC,YAAY;AACrBD,IAAAA,EAAE;AACH,GAFS,EAEP,GAFO,CAAV;AAGD,CAJD;;AAMA,IAAIE,KAAK,GAAG,YAAY;AACtB,MAAIC,OAAO,GAAG,KAAKjB,OAAO,CAAC,QAAD,CAAP,CAAkBkB,SAAvB,GAAd;;AAEAD,EAAAA,OAAO,CAACE,UAAR,GAAqB,UAAUP,KAAV,EAAiBQ,GAAjB,EAAsBC,QAAtB,EAAgC;AACnDJ,IAAAA,OAAO,CAACT,IAAR,CAAaI,KAAK,CAACU,QAAN,CAAe,KAAf,CAAb;AACAD,IAAAA,QAAQ;AACT,GAHD;;AAKA,SAAOJ,OAAP;AACD,CATD;;AAWA,IAAIM,QAAQ,GAAG,KAAf;AACA,IAAIC,QAAQ,GAAG,KAAf;AACA,IAAIC,cAAc,GAAG,KAArB;;AAEA,IAAIC,KAAK,GAAG,YAAY;AACtB,MAAIH,QAAQ,IAAIC,QAAZ,IAAwBC,cAA5B,EAA4C;AAC1CE,IAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AACAC,IAAAA,YAAY,CAACC,OAAD,CAAZ;AACD;AACF,CALD;;AAOA1B,EAAE,CAAC2B,EAAH,CAAM,QAAN,EAAgB,YAAY;AAC1BR,EAAAA,QAAQ,GAAG,IAAX;AACAG,EAAAA,KAAK;AACN,CAHD;AAKAxB,EAAE,CAAC6B,EAAH,CAAM,KAAN,EAAa,YAAY;AACvBP,EAAAA,QAAQ,GAAG,IAAX;AACAE,EAAAA,KAAK;AACN,CAHD;AAKAzB,IAAI,CAACC,EAAD,EAAKc,KAAK,EAAV,EAAcA,KAAK,EAAnB,EAAuBA,KAAK,EAA5B,EAAgCZ,EAAhC,EAAoC,YAAY;AAClDqB,EAAAA,cAAc,GAAG,IAAjB;AACAC,EAAAA,KAAK;AACN,CAHG,CAAJ;AAKAX,UAAU,CAAC,YAAY;AACrBb,EAAAA,EAAE,CAACM,IAAH,CAAQ,IAAR;AACAN,EAAAA,EAAE,CAAC8B,IAAH,CAAQ,OAAR;AACD,CAHS,EAGP,IAHO,CAAV;AAKA,IAAIF,OAAO,GAAGf,UAAU,CAAC,YAAY;AACnCW,EAAAA,KAAK;AACL,QAAM,IAAIO,KAAJ,CAAU,SAAV,CAAN;AACD,CAHuB,EAGrB,IAHqB,CAAxB","sourcesContent":["var stream = require('stream')\nvar pump = require('./index')\n\nvar rs = new stream.Readable()\nvar ws = new stream.Writable()\n\nrs._read = function (size) {\n  this.push(Buffer(size).fill('abc'))\n}\n\nws._write = function (chunk, encoding, cb) {\n  setTimeout(function () {\n    cb()\n  }, 100)\n}\n\nvar toHex = function () {\n  var reverse = new (require('stream').Transform)()\n\n  reverse._transform = function (chunk, enc, callback) {\n    reverse.push(chunk.toString('hex'))\n    callback()\n  }\n\n  return reverse\n}\n\nvar wsClosed = false\nvar rsClosed = false\nvar callbackCalled = false\n\nvar check = function () {\n  if (wsClosed && rsClosed && callbackCalled) {\n    console.log('test-browser.js passes')\n    clearTimeout(timeout)\n  }\n}\n\nws.on('finish', function () {\n  wsClosed = true\n  check()\n})\n\nrs.on('end', function () {\n  rsClosed = true\n  check()\n})\n\npump(rs, toHex(), toHex(), toHex(), ws, function () {\n  callbackCalled = true\n  check()\n})\n\nsetTimeout(function () {\n  rs.push(null)\n  rs.emit('close')\n}, 1000)\n\nvar timeout = setTimeout(function () {\n  check()\n  throw new Error('timeout')\n}, 5000)\n"]},"metadata":{},"sourceType":"script"}