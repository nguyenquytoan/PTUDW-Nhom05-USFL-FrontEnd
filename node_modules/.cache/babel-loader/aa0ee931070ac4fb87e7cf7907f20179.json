{"ast":null,"code":"var Sinon = require(\"sinon\");\n\nvar stringify = require(\"..\");\n\nfunction jsonify(obj) {\n  return JSON.stringify(obj, null, 2);\n}\n\ndescribe(\"Stringify\", function () {\n  it(\"must stringify circular objects\", function () {\n    var obj = {\n      name: \"Alice\"\n    };\n    obj.self = obj;\n    var json = stringify(obj, null, 2);\n    json.must.eql(jsonify({\n      name: \"Alice\",\n      self: \"[Circular ~]\"\n    }));\n  });\n  it(\"must stringify circular objects with intermediaries\", function () {\n    var obj = {\n      name: \"Alice\"\n    };\n    obj.identity = {\n      self: obj\n    };\n    var json = stringify(obj, null, 2);\n    json.must.eql(jsonify({\n      name: \"Alice\",\n      identity: {\n        self: \"[Circular ~]\"\n      }\n    }));\n  });\n  it(\"must stringify circular objects deeper\", function () {\n    var obj = {\n      name: \"Alice\",\n      child: {\n        name: \"Bob\"\n      }\n    };\n    obj.child.self = obj.child;\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {\n        name: \"Bob\",\n        self: \"[Circular ~.child]\"\n      }\n    }));\n  });\n  it(\"must stringify circular objects deeper with intermediaries\", function () {\n    var obj = {\n      name: \"Alice\",\n      child: {\n        name: \"Bob\"\n      }\n    };\n    obj.child.identity = {\n      self: obj.child\n    };\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {\n        name: \"Bob\",\n        identity: {\n          self: \"[Circular ~.child]\"\n        }\n      }\n    }));\n  });\n  it(\"must stringify circular objects in an array\", function () {\n    var obj = {\n      name: \"Alice\"\n    };\n    obj.self = [obj, obj];\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      self: [\"[Circular ~]\", \"[Circular ~]\"]\n    }));\n  });\n  it(\"must stringify circular objects deeper in an array\", function () {\n    var obj = {\n      name: \"Alice\",\n      children: [{\n        name: \"Bob\"\n      }, {\n        name: \"Eve\"\n      }]\n    };\n    obj.children[0].self = obj.children[0];\n    obj.children[1].self = obj.children[1];\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      children: [{\n        name: \"Bob\",\n        self: \"[Circular ~.children.0]\"\n      }, {\n        name: \"Eve\",\n        self: \"[Circular ~.children.1]\"\n      }]\n    }));\n  });\n  it(\"must stringify circular arrays\", function () {\n    var obj = [];\n    obj.push(obj);\n    obj.push(obj);\n    var json = stringify(obj, null, 2);\n    json.must.eql(jsonify([\"[Circular ~]\", \"[Circular ~]\"]));\n  });\n  it(\"must stringify circular arrays with intermediaries\", function () {\n    var obj = [];\n    obj.push({\n      name: \"Alice\",\n      self: obj\n    });\n    obj.push({\n      name: \"Bob\",\n      self: obj\n    });\n    stringify(obj, null, 2).must.eql(jsonify([{\n      name: \"Alice\",\n      self: \"[Circular ~]\"\n    }, {\n      name: \"Bob\",\n      self: \"[Circular ~]\"\n    }]));\n  });\n  it(\"must stringify repeated objects in objects\", function () {\n    var obj = {};\n    var alice = {\n      name: \"Alice\"\n    };\n    obj.alice1 = alice;\n    obj.alice2 = alice;\n    stringify(obj, null, 2).must.eql(jsonify({\n      alice1: {\n        name: \"Alice\"\n      },\n      alice2: {\n        name: \"Alice\"\n      }\n    }));\n  });\n  it(\"must stringify repeated objects in arrays\", function () {\n    var alice = {\n      name: \"Alice\"\n    };\n    var obj = [alice, alice];\n    var json = stringify(obj, null, 2);\n    json.must.eql(jsonify([{\n      name: \"Alice\"\n    }, {\n      name: \"Alice\"\n    }]));\n  });\n  it(\"must call given decycler and use its output\", function () {\n    var obj = {};\n    obj.a = obj;\n    obj.b = obj;\n    var decycle = Sinon.spy(function () {\n      return decycle.callCount;\n    });\n    var json = stringify(obj, null, 2, decycle);\n    json.must.eql(jsonify({\n      a: 1,\n      b: 2\n    }, null, 2));\n    decycle.callCount.must.equal(2);\n    decycle.thisValues[0].must.equal(obj);\n    decycle.args[0][0].must.equal(\"a\");\n    decycle.args[0][1].must.equal(obj);\n    decycle.thisValues[1].must.equal(obj);\n    decycle.args[1][0].must.equal(\"b\");\n    decycle.args[1][1].must.equal(obj);\n  });\n  it(\"must call replacer and use its output\", function () {\n    var obj = {\n      name: \"Alice\",\n      child: {\n        name: \"Bob\"\n      }\n    };\n    var replacer = Sinon.spy(bangString);\n    var json = stringify(obj, replacer, 2);\n    json.must.eql(jsonify({\n      name: \"Alice!\",\n      child: {\n        name: \"Bob!\"\n      }\n    }));\n    replacer.callCount.must.equal(4);\n    replacer.args[0][0].must.equal(\"\");\n    replacer.args[0][1].must.equal(obj);\n    replacer.thisValues[1].must.equal(obj);\n    replacer.args[1][0].must.equal(\"name\");\n    replacer.args[1][1].must.equal(\"Alice\");\n    replacer.thisValues[2].must.equal(obj);\n    replacer.args[2][0].must.equal(\"child\");\n    replacer.args[2][1].must.equal(obj.child);\n    replacer.thisValues[3].must.equal(obj.child);\n    replacer.args[3][0].must.equal(\"name\");\n    replacer.args[3][1].must.equal(\"Bob\");\n  });\n  it(\"must call replacer after describing circular references\", function () {\n    var obj = {\n      name: \"Alice\"\n    };\n    obj.self = obj;\n    var replacer = Sinon.spy(bangString);\n    var json = stringify(obj, replacer, 2);\n    json.must.eql(jsonify({\n      name: \"Alice!\",\n      self: \"[Circular ~]!\"\n    }));\n    replacer.callCount.must.equal(3);\n    replacer.args[0][0].must.equal(\"\");\n    replacer.args[0][1].must.equal(obj);\n    replacer.thisValues[1].must.equal(obj);\n    replacer.args[1][0].must.equal(\"name\");\n    replacer.args[1][1].must.equal(\"Alice\");\n    replacer.thisValues[2].must.equal(obj);\n    replacer.args[2][0].must.equal(\"self\");\n    replacer.args[2][1].must.equal(\"[Circular ~]\");\n  });\n  it(\"must call given decycler and use its output for nested objects\", function () {\n    var obj = {};\n    obj.a = obj;\n    obj.b = {\n      self: obj\n    };\n    var decycle = Sinon.spy(function () {\n      return decycle.callCount;\n    });\n    var json = stringify(obj, null, 2, decycle);\n    json.must.eql(jsonify({\n      a: 1,\n      b: {\n        self: 2\n      }\n    }));\n    decycle.callCount.must.equal(2);\n    decycle.args[0][0].must.equal(\"a\");\n    decycle.args[0][1].must.equal(obj);\n    decycle.args[1][0].must.equal(\"self\");\n    decycle.args[1][1].must.equal(obj);\n  });\n  it(\"must use decycler's output when it returned null\", function () {\n    var obj = {\n      a: \"b\"\n    };\n    obj.self = obj;\n    obj.selves = [obj, obj];\n\n    function decycle() {\n      return null;\n    }\n\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      self: null,\n      selves: [null, null]\n    }));\n  });\n  it(\"must use decycler's output when it returned undefined\", function () {\n    var obj = {\n      a: \"b\"\n    };\n    obj.self = obj;\n    obj.selves = [obj, obj];\n\n    function decycle() {}\n\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      selves: [null, null]\n    }));\n  });\n  it(\"must throw given a decycler that returns a cycle\", function () {\n    var obj = {};\n    obj.self = obj;\n    var err;\n\n    function identity(key, value) {\n      return value;\n    }\n\n    try {\n      stringify(obj, null, 2, identity);\n    } catch (ex) {\n      err = ex;\n    }\n\n    err.must.be.an.instanceof(TypeError);\n  });\n  describe(\".getSerialize\", function () {\n    it(\"must stringify circular objects\", function () {\n      var obj = {\n        a: \"b\"\n      };\n      obj.circularRef = obj;\n      obj.list = [obj, obj];\n      var json = JSON.stringify(obj, stringify.getSerialize(), 2);\n      json.must.eql(jsonify({\n        \"a\": \"b\",\n        \"circularRef\": \"[Circular ~]\",\n        \"list\": [\"[Circular ~]\", \"[Circular ~]\"]\n      }));\n    }); // This is the behavior as of Mar 3, 2015.\n    // The serializer function keeps state inside the returned function and\n    // so far I'm not sure how to not do that. JSON.stringify's replacer is not\n    // called _after_ serialization.\n\n    xit(\"must return a function that could be called twice\", function () {\n      var obj = {\n        name: \"Alice\"\n      };\n      obj.self = obj;\n      var json;\n      var serializer = stringify.getSerialize();\n      json = JSON.stringify(obj, serializer, 2);\n      json.must.eql(jsonify({\n        name: \"Alice\",\n        self: \"[Circular ~]\"\n      }));\n      json = JSON.stringify(obj, serializer, 2);\n      json.must.eql(jsonify({\n        name: \"Alice\",\n        self: \"[Circular ~]\"\n      }));\n    });\n  });\n});\n\nfunction bangString(key, value) {\n  return typeof value == \"string\" ? value + \"!\" : value;\n}","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/json-stringify-safe/test/stringify_test.js"],"names":["Sinon","require","stringify","jsonify","obj","JSON","describe","it","name","self","json","must","eql","identity","child","children","push","alice","alice1","alice2","a","b","decycle","spy","callCount","equal","thisValues","args","replacer","bangString","selves","err","key","value","ex","be","an","instanceof","TypeError","circularRef","list","getSerialize","xit","serializer"],"mappings":"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","sourcesContent":["var Sinon = require(\"sinon\")\nvar stringify = require(\"..\")\nfunction jsonify(obj) { return JSON.stringify(obj, null, 2) }\n\ndescribe(\"Stringify\", function() {\n  it(\"must stringify circular objects\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = obj\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n  })\n\n  it(\"must stringify circular objects with intermediaries\", function() {\n    var obj = {name: \"Alice\"}\n    obj.identity = {self: obj}\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify({name: \"Alice\", identity: {self: \"[Circular ~]\"}}))\n  })\n\n  it(\"must stringify circular objects deeper\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n    obj.child.self = obj.child\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {name: \"Bob\", self: \"[Circular ~.child]\"}\n    }))\n  })\n\n  it(\"must stringify circular objects deeper with intermediaries\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n    obj.child.identity = {self: obj.child}\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {name: \"Bob\", identity: {self: \"[Circular ~.child]\"}}\n    }))\n  })\n\n  it(\"must stringify circular objects in an array\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = [obj, obj]\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\", self: [\"[Circular ~]\", \"[Circular ~]\"]\n    }))\n  })\n\n  it(\"must stringify circular objects deeper in an array\", function() {\n    var obj = {name: \"Alice\", children: [{name: \"Bob\"}, {name: \"Eve\"}]}\n    obj.children[0].self = obj.children[0]\n    obj.children[1].self = obj.children[1]\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      children: [\n        {name: \"Bob\", self: \"[Circular ~.children.0]\"},\n        {name: \"Eve\", self: \"[Circular ~.children.1]\"}\n      ]\n    }))\n  })\n\n  it(\"must stringify circular arrays\", function() {\n    var obj = []\n    obj.push(obj)\n    obj.push(obj)\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify([\"[Circular ~]\", \"[Circular ~]\"]))\n  })\n\n  it(\"must stringify circular arrays with intermediaries\", function() {\n    var obj = []\n    obj.push({name: \"Alice\", self: obj})\n    obj.push({name: \"Bob\", self: obj})\n\n    stringify(obj, null, 2).must.eql(jsonify([\n      {name: \"Alice\", self: \"[Circular ~]\"},\n      {name: \"Bob\", self: \"[Circular ~]\"}\n    ]))\n  })\n\n  it(\"must stringify repeated objects in objects\", function() {\n    var obj = {}\n    var alice = {name: \"Alice\"}\n    obj.alice1 = alice\n    obj.alice2 = alice\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      alice1: {name: \"Alice\"},\n      alice2: {name: \"Alice\"}\n    }))\n  })\n\n  it(\"must stringify repeated objects in arrays\", function() {\n    var alice = {name: \"Alice\"}\n    var obj = [alice, alice]\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify([{name: \"Alice\"}, {name: \"Alice\"}]))\n  })\n\n  it(\"must call given decycler and use its output\", function() {\n    var obj = {}\n    obj.a = obj\n    obj.b = obj\n\n    var decycle = Sinon.spy(function() { return decycle.callCount })\n    var json = stringify(obj, null, 2, decycle)\n    json.must.eql(jsonify({a: 1, b: 2}, null, 2))\n\n    decycle.callCount.must.equal(2)\n    decycle.thisValues[0].must.equal(obj)\n    decycle.args[0][0].must.equal(\"a\")\n    decycle.args[0][1].must.equal(obj)\n    decycle.thisValues[1].must.equal(obj)\n    decycle.args[1][0].must.equal(\"b\")\n    decycle.args[1][1].must.equal(obj)\n  })\n\n  it(\"must call replacer and use its output\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n\n    var replacer = Sinon.spy(bangString)\n    var json = stringify(obj, replacer, 2)\n    json.must.eql(jsonify({name: \"Alice!\", child: {name: \"Bob!\"}}))\n\n    replacer.callCount.must.equal(4)\n    replacer.args[0][0].must.equal(\"\")\n    replacer.args[0][1].must.equal(obj)\n    replacer.thisValues[1].must.equal(obj)\n    replacer.args[1][0].must.equal(\"name\")\n    replacer.args[1][1].must.equal(\"Alice\")\n    replacer.thisValues[2].must.equal(obj)\n    replacer.args[2][0].must.equal(\"child\")\n    replacer.args[2][1].must.equal(obj.child)\n    replacer.thisValues[3].must.equal(obj.child)\n    replacer.args[3][0].must.equal(\"name\")\n    replacer.args[3][1].must.equal(\"Bob\")\n  })\n\n  it(\"must call replacer after describing circular references\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = obj\n\n    var replacer = Sinon.spy(bangString)\n    var json = stringify(obj, replacer, 2)\n    json.must.eql(jsonify({name: \"Alice!\", self: \"[Circular ~]!\"}))\n\n    replacer.callCount.must.equal(3)\n    replacer.args[0][0].must.equal(\"\")\n    replacer.args[0][1].must.equal(obj)\n    replacer.thisValues[1].must.equal(obj)\n    replacer.args[1][0].must.equal(\"name\")\n    replacer.args[1][1].must.equal(\"Alice\")\n    replacer.thisValues[2].must.equal(obj)\n    replacer.args[2][0].must.equal(\"self\")\n    replacer.args[2][1].must.equal(\"[Circular ~]\")\n  })\n\n  it(\"must call given decycler and use its output for nested objects\",\n    function() {\n    var obj = {}\n    obj.a = obj\n    obj.b = {self: obj}\n\n    var decycle = Sinon.spy(function() { return decycle.callCount })\n    var json = stringify(obj, null, 2, decycle)\n    json.must.eql(jsonify({a: 1, b: {self: 2}}))\n\n    decycle.callCount.must.equal(2)\n    decycle.args[0][0].must.equal(\"a\")\n    decycle.args[0][1].must.equal(obj)\n    decycle.args[1][0].must.equal(\"self\")\n    decycle.args[1][1].must.equal(obj)\n  })\n\n  it(\"must use decycler's output when it returned null\", function() {\n    var obj = {a: \"b\"}\n    obj.self = obj\n    obj.selves = [obj, obj]\n\n    function decycle() { return null }\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      self: null,\n      selves: [null, null]\n    }))\n  })\n\n  it(\"must use decycler's output when it returned undefined\", function() {\n    var obj = {a: \"b\"}\n    obj.self = obj\n    obj.selves = [obj, obj]\n\n    function decycle() {}\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      selves: [null, null]\n    }))\n  })\n\n  it(\"must throw given a decycler that returns a cycle\", function() {\n    var obj = {}\n    obj.self = obj\n    var err\n    function identity(key, value) { return value }\n    try { stringify(obj, null, 2, identity) } catch (ex) { err = ex }\n    err.must.be.an.instanceof(TypeError)\n  })\n\n  describe(\".getSerialize\", function() {\n    it(\"must stringify circular objects\", function() {\n      var obj = {a: \"b\"}\n      obj.circularRef = obj\n      obj.list = [obj, obj]\n\n      var json = JSON.stringify(obj, stringify.getSerialize(), 2)\n      json.must.eql(jsonify({\n        \"a\": \"b\",\n        \"circularRef\": \"[Circular ~]\",\n        \"list\": [\"[Circular ~]\", \"[Circular ~]\"]\n      }))\n    })\n\n    // This is the behavior as of Mar 3, 2015.\n    // The serializer function keeps state inside the returned function and\n    // so far I'm not sure how to not do that. JSON.stringify's replacer is not\n    // called _after_ serialization.\n    xit(\"must return a function that could be called twice\", function() {\n      var obj = {name: \"Alice\"}\n      obj.self = obj\n\n      var json\n      var serializer = stringify.getSerialize()\n\n      json = JSON.stringify(obj, serializer, 2)\n      json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n\n      json = JSON.stringify(obj, serializer, 2)\n      json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n    })\n  })\n})\n\nfunction bangString(key, value) {\n  return typeof value == \"string\" ? value + \"!\" : value\n}\n"]},"metadata":{},"sourceType":"script"}