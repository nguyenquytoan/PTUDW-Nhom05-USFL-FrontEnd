{"ast":null,"code":"var path = require('path');\n\nvar test = require('tape');\n\nvar resolve = require('../');\n\ntest('mock', function (t) {\n  t.plan(8);\n  var files = {};\n  files[path.resolve('/foo/bar/baz.js')] = 'beep';\n  var dirs = {};\n  dirs[path.resolve('/foo/bar')] = true;\n\n  function opts(basedir) {\n    return {\n      basedir: path.resolve(basedir),\n      isFile: function (file, cb) {\n        cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n      },\n      isDirectory: function (dir, cb) {\n        cb(null, !!dirs[path.resolve(dir)]);\n      },\n      readFile: function (file, cb) {\n        cb(null, files[path.resolve(file)]);\n      }\n    };\n  }\n\n  resolve('./baz', opts('/foo/bar'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/bar/baz.js'));\n    t.equal(pkg, undefined);\n  });\n  resolve('./baz.js', opts('/foo/bar'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/bar/baz.js'));\n    t.equal(pkg, undefined);\n  });\n  resolve('baz', opts('/foo/bar'), function (err, res) {\n    t.equal(err.message, \"Cannot find module 'baz' from '\" + path.resolve('/foo/bar') + \"'\");\n    t.equal(err.code, 'MODULE_NOT_FOUND');\n  });\n  resolve('../baz', opts('/foo/bar'), function (err, res) {\n    t.equal(err.message, \"Cannot find module '../baz' from '\" + path.resolve('/foo/bar') + \"'\");\n    t.equal(err.code, 'MODULE_NOT_FOUND');\n  });\n});\ntest('mock from package', function (t) {\n  t.plan(8);\n  var files = {};\n  files[path.resolve('/foo/bar/baz.js')] = 'beep';\n  var dirs = {};\n  dirs[path.resolve('/foo/bar')] = true;\n\n  function opts(basedir) {\n    return {\n      basedir: path.resolve(basedir),\n      isFile: function (file, cb) {\n        cb(null, Object.prototype.hasOwnProperty.call(files, file));\n      },\n      isDirectory: function (dir, cb) {\n        cb(null, !!dirs[path.resolve(dir)]);\n      },\n      'package': {\n        main: 'bar'\n      },\n      readFile: function (file, cb) {\n        cb(null, files[file]);\n      }\n    };\n  }\n\n  resolve('./baz', opts('/foo/bar'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/bar/baz.js'));\n    t.equal(pkg && pkg.main, 'bar');\n  });\n  resolve('./baz.js', opts('/foo/bar'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/bar/baz.js'));\n    t.equal(pkg && pkg.main, 'bar');\n  });\n  resolve('baz', opts('/foo/bar'), function (err, res) {\n    t.equal(err.message, \"Cannot find module 'baz' from '\" + path.resolve('/foo/bar') + \"'\");\n    t.equal(err.code, 'MODULE_NOT_FOUND');\n  });\n  resolve('../baz', opts('/foo/bar'), function (err, res) {\n    t.equal(err.message, \"Cannot find module '../baz' from '\" + path.resolve('/foo/bar') + \"'\");\n    t.equal(err.code, 'MODULE_NOT_FOUND');\n  });\n});\ntest('mock package', function (t) {\n  t.plan(2);\n  var files = {};\n  files[path.resolve('/foo/node_modules/bar/baz.js')] = 'beep';\n  files[path.resolve('/foo/node_modules/bar/package.json')] = JSON.stringify({\n    main: './baz.js'\n  });\n  var dirs = {};\n  dirs[path.resolve('/foo')] = true;\n  dirs[path.resolve('/foo/node_modules')] = true;\n\n  function opts(basedir) {\n    return {\n      basedir: path.resolve(basedir),\n      isFile: function (file, cb) {\n        cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n      },\n      isDirectory: function (dir, cb) {\n        cb(null, !!dirs[path.resolve(dir)]);\n      },\n      readFile: function (file, cb) {\n        cb(null, files[path.resolve(file)]);\n      }\n    };\n  }\n\n  resolve('bar', opts('/foo'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/node_modules/bar/baz.js'));\n    t.equal(pkg && pkg.main, './baz.js');\n  });\n});\ntest('mock package from package', function (t) {\n  t.plan(2);\n  var files = {};\n  files[path.resolve('/foo/node_modules/bar/baz.js')] = 'beep';\n  files[path.resolve('/foo/node_modules/bar/package.json')] = JSON.stringify({\n    main: './baz.js'\n  });\n  var dirs = {};\n  dirs[path.resolve('/foo')] = true;\n  dirs[path.resolve('/foo/node_modules')] = true;\n\n  function opts(basedir) {\n    return {\n      basedir: path.resolve(basedir),\n      isFile: function (file, cb) {\n        cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n      },\n      isDirectory: function (dir, cb) {\n        cb(null, !!dirs[path.resolve(dir)]);\n      },\n      'package': {\n        main: 'bar'\n      },\n      readFile: function (file, cb) {\n        cb(null, files[path.resolve(file)]);\n      }\n    };\n  }\n\n  resolve('bar', opts('/foo'), function (err, res, pkg) {\n    if (err) return t.fail(err);\n    t.equal(res, path.resolve('/foo/node_modules/bar/baz.js'));\n    t.equal(pkg && pkg.main, './baz.js');\n  });\n});","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/resolve/test/mock.js"],"names":["path","require","test","resolve","t","plan","files","dirs","opts","basedir","isFile","file","cb","Object","prototype","hasOwnProperty","call","isDirectory","dir","readFile","err","res","pkg","fail","equal","undefined","message","code","main","JSON","stringify"],"mappings":"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","sourcesContent":["var path = require('path');\nvar test = require('tape');\nvar resolve = require('../');\n\ntest('mock', function (t) {\n    t.plan(8);\n\n    var files = {};\n    files[path.resolve('/foo/bar/baz.js')] = 'beep';\n\n    var dirs = {};\n    dirs[path.resolve('/foo/bar')] = true;\n\n    function opts(basedir) {\n        return {\n            basedir: path.resolve(basedir),\n            isFile: function (file, cb) {\n                cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n            },\n            isDirectory: function (dir, cb) {\n                cb(null, !!dirs[path.resolve(dir)]);\n            },\n            readFile: function (file, cb) {\n                cb(null, files[path.resolve(file)]);\n            }\n        };\n    }\n\n    resolve('./baz', opts('/foo/bar'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/bar/baz.js'));\n        t.equal(pkg, undefined);\n    });\n\n    resolve('./baz.js', opts('/foo/bar'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/bar/baz.js'));\n        t.equal(pkg, undefined);\n    });\n\n    resolve('baz', opts('/foo/bar'), function (err, res) {\n        t.equal(err.message, \"Cannot find module 'baz' from '\" + path.resolve('/foo/bar') + \"'\");\n        t.equal(err.code, 'MODULE_NOT_FOUND');\n    });\n\n    resolve('../baz', opts('/foo/bar'), function (err, res) {\n        t.equal(err.message, \"Cannot find module '../baz' from '\" + path.resolve('/foo/bar') + \"'\");\n        t.equal(err.code, 'MODULE_NOT_FOUND');\n    });\n});\n\ntest('mock from package', function (t) {\n    t.plan(8);\n\n    var files = {};\n    files[path.resolve('/foo/bar/baz.js')] = 'beep';\n\n    var dirs = {};\n    dirs[path.resolve('/foo/bar')] = true;\n\n    function opts(basedir) {\n        return {\n            basedir: path.resolve(basedir),\n            isFile: function (file, cb) {\n                cb(null, Object.prototype.hasOwnProperty.call(files, file));\n            },\n            isDirectory: function (dir, cb) {\n                cb(null, !!dirs[path.resolve(dir)]);\n            },\n            'package': { main: 'bar' },\n            readFile: function (file, cb) {\n                cb(null, files[file]);\n            }\n        };\n    }\n\n    resolve('./baz', opts('/foo/bar'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/bar/baz.js'));\n        t.equal(pkg && pkg.main, 'bar');\n    });\n\n    resolve('./baz.js', opts('/foo/bar'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/bar/baz.js'));\n        t.equal(pkg && pkg.main, 'bar');\n    });\n\n    resolve('baz', opts('/foo/bar'), function (err, res) {\n        t.equal(err.message, \"Cannot find module 'baz' from '\" + path.resolve('/foo/bar') + \"'\");\n        t.equal(err.code, 'MODULE_NOT_FOUND');\n    });\n\n    resolve('../baz', opts('/foo/bar'), function (err, res) {\n        t.equal(err.message, \"Cannot find module '../baz' from '\" + path.resolve('/foo/bar') + \"'\");\n        t.equal(err.code, 'MODULE_NOT_FOUND');\n    });\n});\n\ntest('mock package', function (t) {\n    t.plan(2);\n\n    var files = {};\n    files[path.resolve('/foo/node_modules/bar/baz.js')] = 'beep';\n    files[path.resolve('/foo/node_modules/bar/package.json')] = JSON.stringify({\n        main: './baz.js'\n    });\n\n    var dirs = {};\n    dirs[path.resolve('/foo')] = true;\n    dirs[path.resolve('/foo/node_modules')] = true;\n\n    function opts(basedir) {\n        return {\n            basedir: path.resolve(basedir),\n            isFile: function (file, cb) {\n                cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n            },\n            isDirectory: function (dir, cb) {\n                cb(null, !!dirs[path.resolve(dir)]);\n            },\n            readFile: function (file, cb) {\n                cb(null, files[path.resolve(file)]);\n            }\n        };\n    }\n\n    resolve('bar', opts('/foo'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/node_modules/bar/baz.js'));\n        t.equal(pkg && pkg.main, './baz.js');\n    });\n});\n\ntest('mock package from package', function (t) {\n    t.plan(2);\n\n    var files = {};\n    files[path.resolve('/foo/node_modules/bar/baz.js')] = 'beep';\n    files[path.resolve('/foo/node_modules/bar/package.json')] = JSON.stringify({\n        main: './baz.js'\n    });\n\n    var dirs = {};\n    dirs[path.resolve('/foo')] = true;\n    dirs[path.resolve('/foo/node_modules')] = true;\n\n    function opts(basedir) {\n        return {\n            basedir: path.resolve(basedir),\n            isFile: function (file, cb) {\n                cb(null, Object.prototype.hasOwnProperty.call(files, path.resolve(file)));\n            },\n            isDirectory: function (dir, cb) {\n                cb(null, !!dirs[path.resolve(dir)]);\n            },\n            'package': { main: 'bar' },\n            readFile: function (file, cb) {\n                cb(null, files[path.resolve(file)]);\n            }\n        };\n    }\n\n    resolve('bar', opts('/foo'), function (err, res, pkg) {\n        if (err) return t.fail(err);\n        t.equal(res, path.resolve('/foo/node_modules/bar/baz.js'));\n        t.equal(pkg && pkg.main, './baz.js');\n    });\n});\n"]},"metadata":{},"sourceType":"script"}