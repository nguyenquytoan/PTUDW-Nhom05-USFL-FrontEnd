{"ast":null,"code":"var List = require('css-tree').List;\n\nvar generate = require('css-tree').generate;\n\nvar walk = require('css-tree').walk;\n\nvar REPLACE = 1;\nvar REMOVE = 2;\nvar TOP = 0;\nvar RIGHT = 1;\nvar BOTTOM = 2;\nvar LEFT = 3;\nvar SIDES = ['top', 'right', 'bottom', 'left'];\nvar SIDE = {\n  'margin-top': 'top',\n  'margin-right': 'right',\n  'margin-bottom': 'bottom',\n  'margin-left': 'left',\n  'padding-top': 'top',\n  'padding-right': 'right',\n  'padding-bottom': 'bottom',\n  'padding-left': 'left',\n  'border-top-color': 'top',\n  'border-right-color': 'right',\n  'border-bottom-color': 'bottom',\n  'border-left-color': 'left',\n  'border-top-width': 'top',\n  'border-right-width': 'right',\n  'border-bottom-width': 'bottom',\n  'border-left-width': 'left',\n  'border-top-style': 'top',\n  'border-right-style': 'right',\n  'border-bottom-style': 'bottom',\n  'border-left-style': 'left'\n};\nvar MAIN_PROPERTY = {\n  'margin': 'margin',\n  'margin-top': 'margin',\n  'margin-right': 'margin',\n  'margin-bottom': 'margin',\n  'margin-left': 'margin',\n  'padding': 'padding',\n  'padding-top': 'padding',\n  'padding-right': 'padding',\n  'padding-bottom': 'padding',\n  'padding-left': 'padding',\n  'border-color': 'border-color',\n  'border-top-color': 'border-color',\n  'border-right-color': 'border-color',\n  'border-bottom-color': 'border-color',\n  'border-left-color': 'border-color',\n  'border-width': 'border-width',\n  'border-top-width': 'border-width',\n  'border-right-width': 'border-width',\n  'border-bottom-width': 'border-width',\n  'border-left-width': 'border-width',\n  'border-style': 'border-style',\n  'border-top-style': 'border-style',\n  'border-right-style': 'border-style',\n  'border-bottom-style': 'border-style',\n  'border-left-style': 'border-style'\n};\n\nfunction TRBL(name) {\n  this.name = name;\n  this.loc = null;\n  this.iehack = undefined;\n  this.sides = {\n    'top': null,\n    'right': null,\n    'bottom': null,\n    'left': null\n  };\n}\n\nTRBL.prototype.getValueSequence = function (declaration, count) {\n  var values = [];\n  var iehack = '';\n  var hasBadValues = declaration.value.children.some(function (child) {\n    var special = false;\n\n    switch (child.type) {\n      case 'Identifier':\n        switch (child.name) {\n          case '\\\\0':\n          case '\\\\9':\n            iehack = child.name;\n            return;\n\n          case 'inherit':\n          case 'initial':\n          case 'unset':\n          case 'revert':\n            special = child.name;\n            break;\n        }\n\n        break;\n\n      case 'Dimension':\n        switch (child.unit) {\n          // is not supported until IE11\n          case 'rem': // v* units is too buggy across browsers and better\n          // don't merge values with those units\n\n          case 'vw':\n          case 'vh':\n          case 'vmin':\n          case 'vmax':\n          case 'vm':\n            // IE9 supporting \"vm\" instead of \"vmin\".\n            special = child.unit;\n            break;\n        }\n\n        break;\n\n      case 'HexColor': // color\n\n      case 'Number':\n      case 'Percentage':\n        break;\n\n      case 'Function':\n        special = child.name;\n        break;\n\n      case 'WhiteSpace':\n        return false;\n      // ignore space\n\n      default:\n        return true;\n      // bad value\n    }\n\n    values.push({\n      node: child,\n      special: special,\n      important: declaration.important\n    });\n  });\n\n  if (hasBadValues || values.length > count) {\n    return false;\n  }\n\n  if (typeof this.iehack === 'string' && this.iehack !== iehack) {\n    return false;\n  }\n\n  this.iehack = iehack; // move outside\n\n  return values;\n};\n\nTRBL.prototype.canOverride = function (side, value) {\n  var currentValue = this.sides[side];\n  return !currentValue || value.important && !currentValue.important;\n};\n\nTRBL.prototype.add = function (name, declaration) {\n  function attemptToAdd() {\n    var sides = this.sides;\n    var side = SIDE[name];\n\n    if (side) {\n      if (side in sides === false) {\n        return false;\n      }\n\n      var values = this.getValueSequence(declaration, 1);\n\n      if (!values || !values.length) {\n        return false;\n      } // can mix only if specials are equal\n\n\n      for (var key in sides) {\n        if (sides[key] !== null && sides[key].special !== values[0].special) {\n          return false;\n        }\n      }\n\n      if (!this.canOverride(side, values[0])) {\n        return true;\n      }\n\n      sides[side] = values[0];\n      return true;\n    } else if (name === this.name) {\n      var values = this.getValueSequence(declaration, 4);\n\n      if (!values || !values.length) {\n        return false;\n      }\n\n      switch (values.length) {\n        case 1:\n          values[RIGHT] = values[TOP];\n          values[BOTTOM] = values[TOP];\n          values[LEFT] = values[TOP];\n          break;\n\n        case 2:\n          values[BOTTOM] = values[TOP];\n          values[LEFT] = values[RIGHT];\n          break;\n\n        case 3:\n          values[LEFT] = values[RIGHT];\n          break;\n      } // can mix only if specials are equal\n\n\n      for (var i = 0; i < 4; i++) {\n        for (var key in sides) {\n          if (sides[key] !== null && sides[key].special !== values[i].special) {\n            return false;\n          }\n        }\n      }\n\n      for (var i = 0; i < 4; i++) {\n        if (this.canOverride(SIDES[i], values[i])) {\n          sides[SIDES[i]] = values[i];\n        }\n      }\n\n      return true;\n    }\n  }\n\n  if (!attemptToAdd.call(this)) {\n    return false;\n  } // TODO: use it when we can refer to several points in source\n  // if (this.loc) {\n  //     this.loc = {\n  //         primary: this.loc,\n  //         merged: declaration.loc\n  //     };\n  // } else {\n  //     this.loc = declaration.loc;\n  // }\n\n\n  if (!this.loc) {\n    this.loc = declaration.loc;\n  }\n\n  return true;\n};\n\nTRBL.prototype.isOkToMinimize = function () {\n  var top = this.sides.top;\n  var right = this.sides.right;\n  var bottom = this.sides.bottom;\n  var left = this.sides.left;\n\n  if (top && right && bottom && left) {\n    var important = top.important + right.important + bottom.important + left.important;\n    return important === 0 || important === 4;\n  }\n\n  return false;\n};\n\nTRBL.prototype.getValue = function () {\n  var result = new List();\n  var sides = this.sides;\n  var values = [sides.top, sides.right, sides.bottom, sides.left];\n  var stringValues = [generate(sides.top.node), generate(sides.right.node), generate(sides.bottom.node), generate(sides.left.node)];\n\n  if (stringValues[LEFT] === stringValues[RIGHT]) {\n    values.pop();\n\n    if (stringValues[BOTTOM] === stringValues[TOP]) {\n      values.pop();\n\n      if (stringValues[RIGHT] === stringValues[TOP]) {\n        values.pop();\n      }\n    }\n  }\n\n  for (var i = 0; i < values.length; i++) {\n    if (i) {\n      result.appendData({\n        type: 'WhiteSpace',\n        value: ' '\n      });\n    }\n\n    result.appendData(values[i].node);\n  }\n\n  if (this.iehack) {\n    result.appendData({\n      type: 'WhiteSpace',\n      value: ' '\n    });\n    result.appendData({\n      type: 'Identifier',\n      loc: null,\n      name: this.iehack\n    });\n  }\n\n  return {\n    type: 'Value',\n    loc: null,\n    children: result\n  };\n};\n\nTRBL.prototype.getDeclaration = function () {\n  return {\n    type: 'Declaration',\n    loc: this.loc,\n    important: this.sides.top.important,\n    property: this.name,\n    value: this.getValue()\n  };\n};\n\nfunction processRule(rule, shorts, shortDeclarations, lastShortSelector) {\n  var declarations = rule.block.children;\n  var selector = rule.prelude.children.first().id;\n  rule.block.children.eachRight(function (declaration, item) {\n    var property = declaration.property;\n\n    if (!MAIN_PROPERTY.hasOwnProperty(property)) {\n      return;\n    }\n\n    var key = MAIN_PROPERTY[property];\n    var shorthand;\n    var operation;\n\n    if (!lastShortSelector || selector === lastShortSelector) {\n      if (key in shorts) {\n        operation = REMOVE;\n        shorthand = shorts[key];\n      }\n    }\n\n    if (!shorthand || !shorthand.add(property, declaration)) {\n      operation = REPLACE;\n      shorthand = new TRBL(key); // if can't parse value ignore it and break shorthand children\n\n      if (!shorthand.add(property, declaration)) {\n        lastShortSelector = null;\n        return;\n      }\n    }\n\n    shorts[key] = shorthand;\n    shortDeclarations.push({\n      operation: operation,\n      block: declarations,\n      item: item,\n      shorthand: shorthand\n    });\n    lastShortSelector = selector;\n  });\n  return lastShortSelector;\n}\n\nfunction processShorthands(shortDeclarations, markDeclaration) {\n  shortDeclarations.forEach(function (item) {\n    var shorthand = item.shorthand;\n\n    if (!shorthand.isOkToMinimize()) {\n      return;\n    }\n\n    if (item.operation === REPLACE) {\n      item.item.data = markDeclaration(shorthand.getDeclaration());\n    } else {\n      item.block.remove(item.item);\n    }\n  });\n}\n\nmodule.exports = function restructBlock(ast, indexer) {\n  var stylesheetMap = {};\n  var shortDeclarations = [];\n  walk(ast, {\n    visit: 'Rule',\n    reverse: true,\n    enter: function (node) {\n      var stylesheet = this.block || this.stylesheet;\n      var ruleId = (node.pseudoSignature || '') + '|' + node.prelude.children.first().id;\n      var ruleMap;\n      var shorts;\n\n      if (!stylesheetMap.hasOwnProperty(stylesheet.id)) {\n        ruleMap = {\n          lastShortSelector: null\n        };\n        stylesheetMap[stylesheet.id] = ruleMap;\n      } else {\n        ruleMap = stylesheetMap[stylesheet.id];\n      }\n\n      if (ruleMap.hasOwnProperty(ruleId)) {\n        shorts = ruleMap[ruleId];\n      } else {\n        shorts = {};\n        ruleMap[ruleId] = shorts;\n      }\n\n      ruleMap.lastShortSelector = processRule.call(this, node, shorts, shortDeclarations, ruleMap.lastShortSelector);\n    }\n  });\n  processShorthands(shortDeclarations, indexer.declaration);\n};","map":{"version":3,"sources":["/Users/nguyenquytoan/Desktop/PTUDW-17TN-Nhom05-USFL/react-usfl/PTUDW-17TN-Nhom05/node_modules/csso/lib/restructure/4-restructShorthand.js"],"names":["List","require","generate","walk","REPLACE","REMOVE","TOP","RIGHT","BOTTOM","LEFT","SIDES","SIDE","MAIN_PROPERTY","TRBL","name","loc","iehack","undefined","sides","prototype","getValueSequence","declaration","count","values","hasBadValues","value","children","some","child","special","type","unit","push","node","important","length","canOverride","side","currentValue","add","attemptToAdd","key","i","call","isOkToMinimize","top","right","bottom","left","getValue","result","stringValues","pop","appendData","getDeclaration","property","processRule","rule","shorts","shortDeclarations","lastShortSelector","declarations","block","selector","prelude","first","id","eachRight","item","hasOwnProperty","shorthand","operation","processShorthands","markDeclaration","forEach","data","remove","module","exports","restructBlock","ast","indexer","stylesheetMap","visit","reverse","enter","stylesheet","ruleId","pseudoSignature","ruleMap"],"mappings":"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","sourcesContent":["var List = require('css-tree').List;\nvar generate = require('css-tree').generate;\nvar walk = require('css-tree').walk;\n\nvar REPLACE = 1;\nvar REMOVE = 2;\nvar TOP = 0;\nvar RIGHT = 1;\nvar BOTTOM = 2;\nvar LEFT = 3;\nvar SIDES = ['top', 'right', 'bottom', 'left'];\nvar SIDE = {\n    'margin-top': 'top',\n    'margin-right': 'right',\n    'margin-bottom': 'bottom',\n    'margin-left': 'left',\n\n    'padding-top': 'top',\n    'padding-right': 'right',\n    'padding-bottom': 'bottom',\n    'padding-left': 'left',\n\n    'border-top-color': 'top',\n    'border-right-color': 'right',\n    'border-bottom-color': 'bottom',\n    'border-left-color': 'left',\n    'border-top-width': 'top',\n    'border-right-width': 'right',\n    'border-bottom-width': 'bottom',\n    'border-left-width': 'left',\n    'border-top-style': 'top',\n    'border-right-style': 'right',\n    'border-bottom-style': 'bottom',\n    'border-left-style': 'left'\n};\nvar MAIN_PROPERTY = {\n    'margin': 'margin',\n    'margin-top': 'margin',\n    'margin-right': 'margin',\n    'margin-bottom': 'margin',\n    'margin-left': 'margin',\n\n    'padding': 'padding',\n    'padding-top': 'padding',\n    'padding-right': 'padding',\n    'padding-bottom': 'padding',\n    'padding-left': 'padding',\n\n    'border-color': 'border-color',\n    'border-top-color': 'border-color',\n    'border-right-color': 'border-color',\n    'border-bottom-color': 'border-color',\n    'border-left-color': 'border-color',\n    'border-width': 'border-width',\n    'border-top-width': 'border-width',\n    'border-right-width': 'border-width',\n    'border-bottom-width': 'border-width',\n    'border-left-width': 'border-width',\n    'border-style': 'border-style',\n    'border-top-style': 'border-style',\n    'border-right-style': 'border-style',\n    'border-bottom-style': 'border-style',\n    'border-left-style': 'border-style'\n};\n\nfunction TRBL(name) {\n    this.name = name;\n    this.loc = null;\n    this.iehack = undefined;\n    this.sides = {\n        'top': null,\n        'right': null,\n        'bottom': null,\n        'left': null\n    };\n}\n\nTRBL.prototype.getValueSequence = function(declaration, count) {\n    var values = [];\n    var iehack = '';\n    var hasBadValues = declaration.value.children.some(function(child) {\n        var special = false;\n\n        switch (child.type) {\n            case 'Identifier':\n                switch (child.name) {\n                    case '\\\\0':\n                    case '\\\\9':\n                        iehack = child.name;\n                        return;\n\n                    case 'inherit':\n                    case 'initial':\n                    case 'unset':\n                    case 'revert':\n                        special = child.name;\n                        break;\n                }\n                break;\n\n            case 'Dimension':\n                switch (child.unit) {\n                    // is not supported until IE11\n                    case 'rem':\n\n                    // v* units is too buggy across browsers and better\n                    // don't merge values with those units\n                    case 'vw':\n                    case 'vh':\n                    case 'vmin':\n                    case 'vmax':\n                    case 'vm': // IE9 supporting \"vm\" instead of \"vmin\".\n                        special = child.unit;\n                        break;\n                }\n                break;\n\n            case 'HexColor': // color\n            case 'Number':\n            case 'Percentage':\n                break;\n\n            case 'Function':\n                special = child.name;\n                break;\n\n            case 'WhiteSpace':\n                return false; // ignore space\n\n            default:\n                return true;  // bad value\n        }\n\n        values.push({\n            node: child,\n            special: special,\n            important: declaration.important\n        });\n    });\n\n    if (hasBadValues || values.length > count) {\n        return false;\n    }\n\n    if (typeof this.iehack === 'string' && this.iehack !== iehack) {\n        return false;\n    }\n\n    this.iehack = iehack; // move outside\n\n    return values;\n};\n\nTRBL.prototype.canOverride = function(side, value) {\n    var currentValue = this.sides[side];\n\n    return !currentValue || (value.important && !currentValue.important);\n};\n\nTRBL.prototype.add = function(name, declaration) {\n    function attemptToAdd() {\n        var sides = this.sides;\n        var side = SIDE[name];\n\n        if (side) {\n            if (side in sides === false) {\n                return false;\n            }\n\n            var values = this.getValueSequence(declaration, 1);\n\n            if (!values || !values.length) {\n                return false;\n            }\n\n            // can mix only if specials are equal\n            for (var key in sides) {\n                if (sides[key] !== null && sides[key].special !== values[0].special) {\n                    return false;\n                }\n            }\n\n            if (!this.canOverride(side, values[0])) {\n                return true;\n            }\n\n            sides[side] = values[0];\n            return true;\n        } else if (name === this.name) {\n            var values = this.getValueSequence(declaration, 4);\n\n            if (!values || !values.length) {\n                return false;\n            }\n\n            switch (values.length) {\n                case 1:\n                    values[RIGHT] = values[TOP];\n                    values[BOTTOM] = values[TOP];\n                    values[LEFT] = values[TOP];\n                    break;\n\n                case 2:\n                    values[BOTTOM] = values[TOP];\n                    values[LEFT] = values[RIGHT];\n                    break;\n\n                case 3:\n                    values[LEFT] = values[RIGHT];\n                    break;\n            }\n\n            // can mix only if specials are equal\n            for (var i = 0; i < 4; i++) {\n                for (var key in sides) {\n                    if (sides[key] !== null && sides[key].special !== values[i].special) {\n                        return false;\n                    }\n                }\n            }\n\n            for (var i = 0; i < 4; i++) {\n                if (this.canOverride(SIDES[i], values[i])) {\n                    sides[SIDES[i]] = values[i];\n                }\n            }\n\n            return true;\n        }\n    }\n\n    if (!attemptToAdd.call(this)) {\n        return false;\n    }\n\n    // TODO: use it when we can refer to several points in source\n    // if (this.loc) {\n    //     this.loc = {\n    //         primary: this.loc,\n    //         merged: declaration.loc\n    //     };\n    // } else {\n    //     this.loc = declaration.loc;\n    // }\n    if (!this.loc) {\n        this.loc = declaration.loc;\n    }\n\n    return true;\n};\n\nTRBL.prototype.isOkToMinimize = function() {\n    var top = this.sides.top;\n    var right = this.sides.right;\n    var bottom = this.sides.bottom;\n    var left = this.sides.left;\n\n    if (top && right && bottom && left) {\n        var important =\n            top.important +\n            right.important +\n            bottom.important +\n            left.important;\n\n        return important === 0 || important === 4;\n    }\n\n    return false;\n};\n\nTRBL.prototype.getValue = function() {\n    var result = new List();\n    var sides = this.sides;\n    var values = [\n        sides.top,\n        sides.right,\n        sides.bottom,\n        sides.left\n    ];\n    var stringValues = [\n        generate(sides.top.node),\n        generate(sides.right.node),\n        generate(sides.bottom.node),\n        generate(sides.left.node)\n    ];\n\n    if (stringValues[LEFT] === stringValues[RIGHT]) {\n        values.pop();\n        if (stringValues[BOTTOM] === stringValues[TOP]) {\n            values.pop();\n            if (stringValues[RIGHT] === stringValues[TOP]) {\n                values.pop();\n            }\n        }\n    }\n\n    for (var i = 0; i < values.length; i++) {\n        if (i) {\n            result.appendData({ type: 'WhiteSpace', value: ' ' });\n        }\n\n        result.appendData(values[i].node);\n    }\n\n    if (this.iehack) {\n        result.appendData({ type: 'WhiteSpace', value: ' ' });\n        result.appendData({\n            type: 'Identifier',\n            loc: null,\n            name: this.iehack\n        });\n    }\n\n    return {\n        type: 'Value',\n        loc: null,\n        children: result\n    };\n};\n\nTRBL.prototype.getDeclaration = function() {\n    return {\n        type: 'Declaration',\n        loc: this.loc,\n        important: this.sides.top.important,\n        property: this.name,\n        value: this.getValue()\n    };\n};\n\nfunction processRule(rule, shorts, shortDeclarations, lastShortSelector) {\n    var declarations = rule.block.children;\n    var selector = rule.prelude.children.first().id;\n\n    rule.block.children.eachRight(function(declaration, item) {\n        var property = declaration.property;\n\n        if (!MAIN_PROPERTY.hasOwnProperty(property)) {\n            return;\n        }\n\n        var key = MAIN_PROPERTY[property];\n        var shorthand;\n        var operation;\n\n        if (!lastShortSelector || selector === lastShortSelector) {\n            if (key in shorts) {\n                operation = REMOVE;\n                shorthand = shorts[key];\n            }\n        }\n\n        if (!shorthand || !shorthand.add(property, declaration)) {\n            operation = REPLACE;\n            shorthand = new TRBL(key);\n\n            // if can't parse value ignore it and break shorthand children\n            if (!shorthand.add(property, declaration)) {\n                lastShortSelector = null;\n                return;\n            }\n        }\n\n        shorts[key] = shorthand;\n        shortDeclarations.push({\n            operation: operation,\n            block: declarations,\n            item: item,\n            shorthand: shorthand\n        });\n\n        lastShortSelector = selector;\n    });\n\n    return lastShortSelector;\n}\n\nfunction processShorthands(shortDeclarations, markDeclaration) {\n    shortDeclarations.forEach(function(item) {\n        var shorthand = item.shorthand;\n\n        if (!shorthand.isOkToMinimize()) {\n            return;\n        }\n\n        if (item.operation === REPLACE) {\n            item.item.data = markDeclaration(shorthand.getDeclaration());\n        } else {\n            item.block.remove(item.item);\n        }\n    });\n}\n\nmodule.exports = function restructBlock(ast, indexer) {\n    var stylesheetMap = {};\n    var shortDeclarations = [];\n\n    walk(ast, {\n        visit: 'Rule',\n        reverse: true,\n        enter: function(node) {\n            var stylesheet = this.block || this.stylesheet;\n            var ruleId = (node.pseudoSignature || '') + '|' + node.prelude.children.first().id;\n            var ruleMap;\n            var shorts;\n\n            if (!stylesheetMap.hasOwnProperty(stylesheet.id)) {\n                ruleMap = {\n                    lastShortSelector: null\n                };\n                stylesheetMap[stylesheet.id] = ruleMap;\n            } else {\n                ruleMap = stylesheetMap[stylesheet.id];\n            }\n\n            if (ruleMap.hasOwnProperty(ruleId)) {\n                shorts = ruleMap[ruleId];\n            } else {\n                shorts = {};\n                ruleMap[ruleId] = shorts;\n            }\n\n            ruleMap.lastShortSelector = processRule.call(this, node, shorts, shortDeclarations, ruleMap.lastShortSelector);\n        }\n    });\n\n    processShorthands(shortDeclarations, indexer.declaration);\n};\n"]},"metadata":{},"sourceType":"script"}